/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

/*
	This is an optimized version of Dojo, built for deployment and not for
	development. To get sources and documentation, please visit:

		http://dojotoolkit.org
*/

(function(){var u=null;if((u||typeof djConfig!="undefined"&&djConfig.scopeMap)&&typeof window!="undefined"){for(var S="",M="",P="",Q={},T={},u=u||djConfig.scopeMap,H=0;H<u.length;H++){var x=u[H];S+="var "+x[0]+" = {}; "+x[1]+" = "+x[0]+";"+x[1]+"._scopeName = '"+x[1]+"';";M+=(H==0?"":",")+x[0];P+=(H==0?"":",")+x[1];Q[x[0]]=x[1];T[x[1]]=x[0]}eval(S+"dojo._scopeArgs = ["+P+"];");dojo._scopePrefixArgs=M;dojo._scopePrefix="(function("+M+"){";dojo._scopeSuffix="})("+P+")";dojo._scopeMap=Q;dojo._scopeMapRev=
T}(function(){if(typeof this.loadFirebugConsole=="function")this.loadFirebugConsole();else{this.console=this.console||{};for(var a=["assert","count","debug","dir","dirxml","error","group","groupEnd","info","profile","profileEnd","time","timeEnd","trace","warn","log"],b=0,c;c=a[b++];)console[c]||function(){var a=c+"";console[a]="log"in console?function(){var b=Array.apply({},arguments);b.unshift(a+":");console.log(b.join(" "))}:function(){};console[a]._fake=!0}()}typeof dojo=="undefined"&&(dojo={_scopeName:"dojo",
_scopePrefix:"",_scopePrefixArgs:"",_scopeSuffix:"",_scopeMap:{},_scopeMapRev:{}});var d=dojo;typeof dijit=="undefined"&&(dijit={_scopeName:"dijit"});typeof dojox=="undefined"&&(dojox={_scopeName:"dojox"});if(!d._scopeArgs)d._scopeArgs=[dojo,dijit,dojox];d.global=this;d.config={isDebug:!1,debugAtAllCosts:!1};if(a=typeof djConfig!="undefined"?djConfig:typeof dojoConfig!="undefined"?dojoConfig:null)for(var e in a)d.config[e]=a[e];dojo.locale=d.config.locale;e="$Rev: 23917 $".match(/\d+/);dojo.version=
{major:1,minor:6,patch:0,flag:"",revision:e?+e[0]:NaN,toString:function(){with(d.version)return major+"."+minor+"."+patch+flag+" ("+revision+")"}};typeof OpenAjax!="undefined"&&OpenAjax.hub.registerLibrary(dojo._scopeName,"http://dojotoolkit.org",d.version.toString());var f,g,h={};for(b in{toString:1}){f=[];break}dojo._extraNames=f=f||["hasOwnProperty","valueOf","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","constructor"];g=f.length;dojo._mixin=function(a,b){var c,d,e;for(c in b)if(d=
b[c],!(c in a)||a[c]!==d&&(!(c in h)||h[c]!==d))a[c]=d;if(g&&b)for(e=0;e<g;++e)if(c=f[e],d=b[c],!(c in a)||a[c]!==d&&(!(c in h)||h[c]!==d))a[c]=d;return a};dojo.mixin=function(a){a||(a={});for(var b=1,c=arguments.length;b<c;b++)d._mixin(a,arguments[b]);return a};dojo._getProp=function(a,b,c){for(var c=c||d.global,e=0,f;c&&(f=a[e]);e++)e==0&&d._scopeMap[f]&&(f=d._scopeMap[f]),c=f in c?c[f]:b?c[f]={}:void 0;return c};dojo.setObject=function(a,b,c){var e=a.split("."),a=e.pop();return(c=d._getProp(e,
!0,c))&&a?c[a]=b:void 0};dojo.getObject=function(a,b,c){return d._getProp(a.split("."),b,c)};dojo.exists=function(a,b){return d.getObject(a,!1,b)!==void 0};dojo.eval=function(a){return d.global.eval?d.global.eval(a):eval(a)};d.deprecated=d.experimental=function(){}})();(function(){var a=dojo;a.mixin(a,{_loadedModules:{},_inFlightCount:0,_hasResource:{},_modulePrefixes:{dojo:{name:"dojo",value:"."},doh:{name:"doh",value:"../util/doh"},tests:{name:"tests",value:"tests"}},_moduleHasPrefix:function(b){var c=
a._modulePrefixes;return!(!c[b]||!c[b].value)},_getModulePrefix:function(b){var c=a._modulePrefixes;if(a._moduleHasPrefix(b))return c[b].value;return b},_loadedUrls:[],_postLoad:!1,_loaders:[],_unloaders:[],_loadNotifying:!1});dojo._loadUriAndCheck=function(b,c,d){var h=!1;try{h=a._loadUri(b,d)}catch(i){console.error("failed loading "+b+" with error: "+i)}return!(!h||!a._loadedModules[c])};dojo.loaded=function(){a._loadNotifying=!0;a._postLoad=!0;var b=a._loaders;a._loaders=[];for(var c=0;c<b.length;c++)b[c]();
a._loadNotifying=!1;a._postLoad&&a._inFlightCount==0&&b.length&&a._callLoaded()};dojo.unloaded=function(){for(var b=a._unloaders;b.length;)b.pop()()};a._onto=function(a,b,c){if(c){if(c){var d=typeof c=="string"?b[c]:c;a.push(function(){d.call(b)})}}else a.push(b)};dojo.ready=dojo.addOnLoad=function(b,c){a._onto(a._loaders,b,c);a._postLoad&&a._inFlightCount==0&&!a._loadNotifying&&a._callLoaded()};var b=a.config.addOnLoad;if(b)a.addOnLoad[b instanceof Array?"apply":"call"](a,b);dojo._modulesLoaded=
function(){a._postLoad||a._inFlightCount>0||a._callLoaded()};dojo._callLoaded=function(){typeof setTimeout=="object"||a.config.useXDomain&&a.isOpera?setTimeout(a.isAIR?function(){a.loaded()}:a._scopeName+".loaded();",0):a.loaded()};dojo._getModuleSymbols=function(b){for(var b=b.split("."),c=b.length;c>0;c--){var d=b.slice(0,c).join(".");if(c==1&&!a._moduleHasPrefix(d))b[0]="../"+b[0];else{var h=a._getModulePrefix(d);if(h!=d){b.splice(0,c,h);break}}}return b};dojo._global_omit_module_check=!1;dojo.loadInit=
function(a){a()};dojo._loadModule=dojo.require=function(b,c){var c=a._global_omit_module_check||c,d=a._loadedModules[b];if(d)return d;var h=a._getModuleSymbols(b).join("/")+".js";if(!a._loadPath(h,!c?b:null)&&!c)throw Error("Could not load '"+b+"'; last tried '"+h+"'");if(!c&&!a._isXDomain&&(d=a._loadedModules[b],!d))throw Error("symbol '"+b+"' is not defined after loading '"+h+"'");return d};dojo.provide=function(b){b+="";return a._loadedModules[b]=a.getObject(b,!0)};dojo.platformRequire=function(b){for(var b=
(b.common||[]).concat(b[a._name]||b["default"]||[]),c=0;c<b.length;c++){var d=b[c];d.constructor==Array?a._loadModule.apply(a,d):a._loadModule(d)}};dojo.requireIf=function(b){if(b===!0){for(var c=[],d=1;d<arguments.length;d++)c.push(arguments[d]);a.require.apply(a,c)}};dojo.requireAfterIf=a.requireIf;dojo.registerModulePath=function(b,c){a._modulePrefixes[b]={name:b,value:c}};dojo.requireLocalization=function(){a.require("dojo.i18n");a.i18n._requireLocalization.apply(a.hostenv,arguments)};var c=/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/,
d=/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/;dojo._Url=function(){for(var b=arguments,f=[b[0]],g=1;g<b.length;g++)if(b[g]){var h=new a._Url(b[g]+""),f=new a._Url(f[0]+"");if(h.path==""&&!h.scheme&&!h.authority&&!h.query){if(h.fragment!=null)f.fragment=h.fragment;h=f}else if(!h.scheme&&(h.scheme=f.scheme,!h.authority&&(h.authority=f.authority,h.path.charAt(0)!="/"))){for(var f=(f.path.substring(0,f.path.lastIndexOf("/")+1)+h.path).split("/"),i=0;i<f.length;i++)f[i]=="."?i==f.length-
1?f[i]="":(f.splice(i,1),i--):i>0&&!(i==1&&f[0]=="")&&f[i]==".."&&f[i-1]!=".."&&(i==f.length-1?(f.splice(i,1),f[i-1]=""):(f.splice(i-1,2),i-=2));h.path=f.join("/")}f=[];h.scheme&&f.push(h.scheme,":");h.authority&&f.push("//",h.authority);f.push(h.path);h.query&&f.push("?",h.query);h.fragment&&f.push("#",h.fragment)}this.uri=f.join("");b=this.uri.match(c);this.scheme=b[2]||(b[1]?"":null);this.authority=b[4]||(b[3]?"":null);this.path=b[5];this.query=b[7]||(b[6]?"":null);this.fragment=b[9]||(b[8]?"":
null);if(this.authority!=null)b=this.authority.match(d),this.user=b[3]||null,this.password=b[4]||null,this.host=b[6]||b[7],this.port=b[9]||null};dojo._Url.prototype.toString=function(){return this.uri};dojo.moduleUrl=function(b,c){var d=a._getModuleSymbols(b).join("/");if(!d)return null;d.lastIndexOf("/")!=d.length-1&&(d+="/");var h=d.indexOf(":");if(d.charAt(0)!="/"&&(h==-1||h>d.indexOf("/")))d=a.baseUrl+d;return new a._Url(d,c)}})();dojo.provide("dojo._base._loader.loader_xd");dojo._xdReset=function(){dojo._isXDomain=
dojo.config.useXDomain||!1;dojo._xdClearInterval();dojo._xdInFlight={};dojo._xdOrderedReqs=[];dojo._xdDepMap={};dojo._xdContents=[];dojo._xdDefList=[]};dojo._xdClearInterval=function(){if(dojo._xdTimer)clearInterval(dojo._xdTimer),dojo._xdTimer=0};dojo._xdReset();dojo._xdCreateResource=function(a,b,c){for(var d=a.replace(/(\/\*([\s\S]*?)\*\/|\/\/(.*)$)/mg,""),e=[],f=/dojo.(require|requireIf|provide|requireAfterIf|platformRequire|requireLocalization)\s*\(([\w\W]*?)\)/mg,g;(g=f.exec(d))!=null;)g[1]==
"requireLocalization"?eval(g[0]):e.push('"'+g[1]+'", '+g[2]);d=[];d.push(dojo._scopeName+"._xdResourceLoaded(function("+dojo._scopePrefixArgs+"){\n");if(f=dojo._xdExtractLoadInits(a)){a=f[0];for(g=1;g<f.length;g++)d.push(f[g]+";\n")}d.push("return {");if(e.length>0){d.push("depends: [");for(g=0;g<e.length;g++)g>0&&d.push(",\n"),d.push("["+e[g]+"]");d.push("],")}d.push("\ndefineResource: function("+dojo._scopePrefixArgs+"){");(!dojo.config.debugAtAllCosts||b=="dojo._base._loader.loader_debug")&&d.push(a);
d.push("\n}, resourceName: '"+b+"', resourcePath: '"+c+"'};});");return d.join("")};dojo._xdExtractLoadInits=function(a){var b=/dojo.loadInit\s*\(/g;b.lastIndex=0;var c=/[\(\)]/g;c.lastIndex=0;for(var d=[],e;e=b.exec(a);){c.lastIndex=b.lastIndex;for(var f=1,g;g=c.exec(a);)if(g[0]==")"?f-=1:f+=1,f==0)break;if(f!=0)throw"unmatched paren around character "+c.lastIndex+" in: "+a;e=b.lastIndex-e[0].length;d.push(a.substring(e,c.lastIndex));f=c.lastIndex-e;a=a.substring(0,e)+a.substring(c.lastIndex,a.length);
b.lastIndex=c.lastIndex-f;b.lastIndex=c.lastIndex}d.length>0&&d.unshift(a);return d.length?d:null};dojo._xdIsXDomainPath=function(a){var b=a.indexOf(":"),c=a.indexOf("/");if(b>0&&b<c||a.indexOf("//")===0)return!0;else if(a=dojo.baseUrl,b=a.indexOf(":"),c=a.indexOf("/"),a.indexOf("//")===0||b>0&&b<c&&(!location.host||a.indexOf("http://"+location.host)!=0))return!0;return!1};dojo._loadPath=function(a,b,c){var d=dojo._xdIsXDomainPath(a);dojo._isXDomain|=d;a=(a.charAt(0)=="/"||a.match(/^\w+:/)?"":dojo.baseUrl)+
a;try{return!b||dojo._isXDomain?dojo._loadUri(a,c,d,b):dojo._loadUriAndCheck(a,b,c)}catch(e){return console.error(e),!1}};dojo._xdCharSet="utf-8";dojo._loadUri=function(a,b,c,d){if(dojo._loadedUrls[a])return 1;if(dojo._isXDomain&&d&&d!="dojo.i18n"){dojo._xdOrderedReqs.push(d);if(c||a.indexOf("/nls/")==-1)dojo._xdInFlight[d]=!0,dojo._inFlightCount++;if(!dojo._xdTimer)dojo._xdTimer=dojo.isAIR?setInterval(function(){dojo._xdWatchInFlight()},100):setInterval(dojo._scopeName+"._xdWatchInFlight();",100);
dojo._xdStartTime=(new Date).getTime()}if(c){d=a.lastIndexOf(".");d<=0&&(d=a.length-1);b=a.substring(0,d)+".xd";d!=a.length-1&&(b+=a.substring(d,a.length));dojo.isAIR&&(b=b.replace("app:/","/"));d=document.createElement("script");d.type="text/javascript";if(dojo._xdCharSet)d.charset=dojo._xdCharSet;d.src=b;if(!dojo.headElement&&(dojo._headElement=document.getElementsByTagName("head")[0],!dojo._headElement))dojo._headElement=document.getElementsByTagName("html")[0];dojo._headElement.appendChild(d)}else{c=
dojo._getText(a,null,!0);if(c==null)return 0;dojo._isXDomain&&a.indexOf("/nls/")==-1&&d!="dojo.i18n"?(b=dojo._xdCreateResource(c,d,a),dojo.eval(b)):(c=b?"("+c+")":dojo._scopePrefix+c+dojo._scopeSuffix,d=dojo.eval(c+"\r\n//@ sourceURL="+a),b&&b(d))}dojo._loadedUrls[a]=!0;dojo._loadedUrls.push(a);return!0};dojo._xdResourceLoaded=function(a){var a=a.apply(dojo.global,dojo._scopeArgs),b=a.depends,c=null,d=null,e=[];if(b&&b.length>0){for(var f=null,g=0;g<b.length;g++){f=b[g];if(f[0]=="provide")e.push(f[1]);
else{c||(c=[]);d||(d=[]);var h=dojo._xdUnpackDependency(f);h.requires&&(c=c.concat(h.requires));h.requiresAfter&&(d=d.concat(h.requiresAfter))}var h=f[0],i=h.split(".");i.length==2?dojo[i[0]][i[1]].apply(dojo[i[0]],f.slice(1)):dojo[h].apply(dojo,f.slice(1))}if(e.length==1&&e[0]=="dojo._base._loader.loader_debug")a.defineResource(dojo);else{a=dojo._xdContents.push({content:a.defineResource,resourceName:a.resourceName,resourcePath:a.resourcePath,isDefined:!1})-1;for(g=0;g<e.length;g++)dojo._xdDepMap[e[g]]=
{requires:c,requiresAfter:d,contentIndex:a}}for(g=0;g<e.length;g++)dojo._xdInFlight[e[g]]=!1}};dojo._xdLoadFlattenedBundle=function(a,b,c,d){var e=dojo.i18n.normalizeLocale(c||"root").replace("-","_"),c=[a,"nls",b].join("."),c=dojo.provide(c);c[e]=d;a=[a,e,b].join(".");if(a=dojo._xdBundleMap[a])for(var f in a)c[f]=d};dojo._xdInitExtraLocales=function(){var a=dojo.config.extraLocale;if(a)!a instanceof Array&&(a=[a]),dojo._xdReqLoc=dojo.xdRequireLocalization,dojo.xdRequireLocalization=function(b,c,
d,e){dojo._xdReqLoc(b,c,d,e);if(!d)for(d=0;d<a.length;d++)dojo._xdReqLoc(b,c,a[d],e)}};dojo._xdBundleMap={};dojo.xdRequireLocalization=function(a,b,c,d){if(dojo._xdInitExtraLocales)dojo._xdInitExtraLocales(),dojo._xdInitExtraLocales=null,dojo.xdRequireLocalization.apply(dojo,arguments);else{for(var e=d.split(","),f=dojo.i18n.normalizeLocale(c),g="",h=0;h<e.length;h++)f.indexOf(e[h])==0&&e[h].length>g.length&&(g=e[h]);e=g.replace("-","_");h=dojo.getObject([a,"nls",b].join("."));if(!h||!h[e])e=[a,e||
"root",b].join("."),(h=dojo._xdBundleMap[e])||(h=dojo._xdBundleMap[e]={}),h[f.replace("-","_")]=!0,dojo.require(a+".nls"+(g?"."+g:"")+"."+b)}};dojo._xdRealRequireLocalization=dojo.requireLocalization;dojo.requireLocalization=function(a){var b=dojo.moduleUrl(a).toString();return dojo._xdIsXDomainPath(b)?dojo.xdRequireLocalization.apply(dojo,arguments):dojo._xdRealRequireLocalization.apply(dojo,arguments)};dojo._xdUnpackDependency=function(a){var b=null,c=null;switch(a[0]){case "requireIf":case "requireAfterIf":a[1]===
!0&&(b=[{name:a[2],content:null}]);break;case "platformRequire":var b=a[1],d=b.common||[];if(b=b[dojo.hostenv.name_]?d.concat(b[dojo.hostenv.name_]||[]):d.concat(b["default"]||[]))for(d=0;d<b.length;d++)b[d]=b[d]instanceof Array?{name:b[d][0],content:null}:{name:b[d],content:null};break;case "require":b=[{name:a[1],content:null}];break;case "i18n._preloadLocalizations":dojo.i18n._preloadLocalizations.apply(dojo.i18n._preloadLocalizations,a.slice(1))}if(a[0]=="requireAfterIf"||a[0]=="requireIf")c=
b,b=null;return{requires:b,requiresAfter:c}};dojo._xdWalkReqs=function(){for(var a=null,b,c=0;c<dojo._xdOrderedReqs.length;c++)b=dojo._xdOrderedReqs[c],dojo._xdDepMap[b]&&(a=[b],a[b]=!0,dojo._xdEvalReqs(a))};dojo._xdEvalReqs=function(a){for(;a.length>0;){var b=a[a.length-1],c=dojo._xdDepMap[b],d,e,f;if(c){if((e=c.requires)&&e.length>0)for(d=0;d<e.length;d++)if((f=e[d].name)&&!a[f])a.push(f),a[f]=!0,dojo._xdEvalReqs(a);d=dojo._xdContents[c.contentIndex];if(!d.isDefined)e=d.content,e.resourceName=d.resourceName,
e.resourcePath=d.resourcePath,dojo._xdDefList.push(e),d.isDefined=!0;dojo._xdDepMap[b]=null;if((e=c.requiresAfter)&&e.length>0)for(d=0;d<e.length;d++)if((f=e[d].name)&&!a[f])a.push(f),a[f]=!0,dojo._xdEvalReqs(a)}a.pop()}};dojo._xdWatchInFlight=function(){var a="",b=dojo._xdStartTime+(dojo.config.xdWaitSeconds||15)*1E3<(new Date).getTime(),c;for(c in dojo._xdInFlight)if(dojo._xdInFlight[c]===!0)if(b)a+=c+" ";else return;dojo._xdClearInterval();if(b)throw"Could not load cross-domain resources: "+a;
dojo._xdWalkReqs();b=dojo._xdDefList.length;for(a=0;a<b;a++)if(c=dojo._xdDefList[a],dojo.config.debugAtAllCosts&&c.resourceName){if(!dojo._xdDebugQueue)dojo._xdDebugQueue=[];dojo._xdDebugQueue.push({resourceName:c.resourceName,resourcePath:c.resourcePath})}else c.apply(dojo.global,dojo._scopeArgs);for(a=0;a<dojo._xdContents.length;a++)b=dojo._xdContents[a],b.content&&!b.isDefined&&b.content.apply(dojo.global,dojo._scopeArgs);dojo._xdReset();dojo._xdDebugQueue&&dojo._xdDebugQueue.length>0?dojo._xdDebugFileLoaded():
dojo._xdNotifyLoaded()};dojo._xdNotifyLoaded=function(){for(var a in dojo._xdInFlight)if(typeof dojo._xdInFlight[a]=="boolean")return;dojo._inFlightCount=0;dojo._initFired&&!dojo._loadNotifying&&dojo._callLoaded()};if(typeof window!="undefined"){dojo.isBrowser=!0;dojo._name="browser";(function(){var a=dojo;if(document&&document.getElementsByTagName)for(var b=document.getElementsByTagName("script"),c=/dojo(\.xd)?\.js(\W|$)/i,d=0;d<b.length;d++){var e=b[d].getAttribute("src");if(e){var f=e.match(c);
if(f){if(!a.config.baseUrl)a.config.baseUrl=e.substring(0,f.index);if(b=b[d].getAttribute("djConfig")||b[d].getAttribute("data-dojo-config")){var b=eval("({ "+b+" })"),g;for(g in b)dojo.config[g]=b[g]}break}}}a.baseUrl=a.config.baseUrl;g=navigator;b=g.userAgent;c=g.appVersion;d=parseFloat(c);if(b.indexOf("Opera")>=0)a.isOpera=d;if(b.indexOf("AdobeAIR")>=0)a.isAIR=1;a.isKhtml=c.indexOf("Konqueror")>=0?d:0;a.isWebKit=parseFloat(b.split("WebKit/")[1])||void 0;a.isChrome=parseFloat(b.split("Chrome/")[1])||
void 0;a.isMac=c.indexOf("Macintosh")>=0;if((e=Math.max(c.indexOf("WebKit"),c.indexOf("Safari"),0))&&!dojo.isChrome)if(a.isSafari=parseFloat(c.split("Version/")[1]),!a.isSafari||parseFloat(c.substr(e+7))<=419.3)a.isSafari=2;if(b.indexOf("Gecko")>=0&&!a.isKhtml&&!a.isWebKit)a.isMozilla=a.isMoz=d;if(a.isMoz)a.isFF=parseFloat(b.split("Firefox/")[1]||b.split("Minefield/")[1])||void 0;if(document.all&&!a.isOpera&&(a.isIE=parseFloat(c.split("MSIE ")[1])||void 0,(b=document.documentMode)&&b!=5&&Math.floor(a.isIE)!=
b))a.isIE=b;if(dojo.isIE&&window.location.protocol==="file:")dojo.config.ieForceActiveXXhr=!0;a.isQuirks=document.compatMode=="BackCompat";a.locale=dojo.config.locale||(a.isIE?g.userLanguage:g.language).toLowerCase();a._XMLHTTP_PROGIDS=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"];a._xhrObj=function(){var b,c;if(!dojo.isIE||!dojo.config.ieForceActiveXXhr)try{b=new XMLHttpRequest}catch(d){}if(!b)for(var e=0;e<3;++e){var h=a._XMLHTTP_PROGIDS[e];try{b=new ActiveXObject(h)}catch(f){c=f}if(b){a._XMLHTTP_PROGIDS=
[h];break}}if(!b)throw Error("XMLHTTP not available: "+c);return b};a._isDocumentOk=function(a){a=a.status||0;return a>=200&&a<300||a==304||a==1223||!a};var h=window.location+"",i=(g=document.getElementsByTagName("base"))&&g.length>0;a._getText=function(b,c){var d=a._xhrObj();!i&&dojo._Url&&(b=(new dojo._Url(h,b)).toString());a.config.cacheBust&&(b+="",b+=(b.indexOf("?")==-1?"?":"&")+String(a.config.cacheBust).replace(/\W+/g,""));d.open("GET",b,!1);try{if(d.send(null),!a._isDocumentOk(d)){var e=Error("Unable to load "+
b+" status:"+d.status);e.status=d.status;e.responseText=d.responseText;throw e;}}catch(f){if(c)return null;throw f;}return d.responseText};var j=window,k=function(a,b){var c=j.attachEvent||j.addEventListener,a=j.attachEvent?a:a.substring(2);c(a,function(){b.apply(j,arguments)},!1)};a._windowUnloaders=[];a.windowUnloaded=function(){for(var b=a._windowUnloaders;b.length;)b.pop()();a=null};var n=0;a.addOnWindowUnload=function(b,c){a._onto(a._windowUnloaders,b,c);n||(n=1,k("onunload",a.windowUnloaded))};
var m=0;a.addOnUnload=function(b,c){a._onto(a._unloaders,b,c);m||(m=1,k("onbeforeunload",dojo.unloaded))}})();dojo._initFired=!1;dojo._loadInit=function(){if(dojo._scrollIntervalId)clearInterval(dojo._scrollIntervalId),dojo._scrollIntervalId=0;if(!dojo._initFired)dojo._initFired=!0,!dojo.config.afterOnLoad&&window.detachEvent&&window.detachEvent("onload",dojo._loadInit),dojo._inFlightCount==0&&dojo._modulesLoaded()};if(!dojo.config.afterOnLoad)if(document.addEventListener)document.addEventListener("DOMContentLoaded",
dojo._loadInit,!1),window.addEventListener("load",dojo._loadInit,!1);else if(window.attachEvent&&(window.attachEvent("onload",dojo._loadInit),!dojo.config.skipIeDomLoaded&&self===self.top))dojo._scrollIntervalId=setInterval(function(){try{document.body&&(document.documentElement.doScroll("left"),dojo._loadInit())}catch(a){}},30);if(dojo.isIE)try{(function(){document.namespaces.add("v","urn:schemas-microsoft-com:vml");var a=["*","group","roundrect","oval","shape","rect","imagedata","path","textpath",
"text"],b=0,c=1,d=document.createStyleSheet();if(dojo.isIE>=8)b=1,c=a.length;for(;b<c;++b)d.addRule("v\\:"+a[b],"behavior:url(#default#VML); display:inline-block")})()}catch(W){}}(function(){var a=dojo.config.modulePaths;if(a)for(var b in a)dojo.registerModulePath(b,a[b])})();dojo.config.isDebug&&dojo.require("dojo._firebug.firebug");dojo.config.debugAtAllCosts&&dojo.require("dojo._base._loader.loader_debug");dojo._hasResource["dojo._base.lang"]||(dojo._hasResource["dojo._base.lang"]=!0,dojo.provide("dojo._base.lang"),
function(){var a=dojo,b=Object.prototype.toString;dojo.isString=function(a){return typeof a=="string"||a instanceof String};dojo.isArray=function(a){return a&&(a instanceof Array||typeof a=="array")};dojo.isFunction=function(a){return b.call(a)==="[object Function]"};dojo.isObject=function(b){return b!==void 0&&(b===null||typeof b=="object"||a.isArray(b)||a.isFunction(b))};dojo.isArrayLike=function(b){return b&&b!==void 0&&!a.isString(b)&&!a.isFunction(b)&&!(b.tagName&&b.tagName.toLowerCase()=="form")&&
(a.isArray(b)||isFinite(b.length))};dojo.isAlien=function(b){return b&&!a.isFunction(b)&&/\{\s*\[native code\]\s*\}/.test(String(b))};dojo.extend=function(b){for(var c=1,d=arguments.length;c<d;c++)a._mixin(b.prototype,arguments[c]);return b};dojo._hitchArgs=function(b,c){var d=a._toArray(arguments,2),e=a.isString(c);return function(){var h=a._toArray(arguments),f=e?(b||a.global)[c]:c;return f&&f.apply(b||this,d.concat(h))}};dojo.hitch=function(b,c){if(arguments.length>2)return a._hitchArgs.apply(a,
arguments);c||(c=b,b=null);if(a.isString(c)){b=b||a.global;if(!b[c])throw['dojo.hitch: scope["',c,'"] is null (scope="',b,'")'].join("");return function(){return b[c].apply(b,arguments||[])}}return!b?c:function(){return c.apply(b,arguments||[])}};dojo.delegate=dojo._delegate=function(){function b(){}return function(c,d){b.prototype=c;var e=new b;b.prototype=null;d&&a._mixin(e,d);return e}}();var c=function(a,b,c){return(c||[]).concat(Array.prototype.slice.call(a,b||0))},d=function(a,b,c){c=c||[];
for(b=b||0;b<a.length;b++)c.push(a[b]);return c};dojo._toArray=a.isIE?function(a){return(a.item?d:c).apply(this,arguments)}:c;dojo.partial=function(){return a.hitch.apply(a,[null].concat(a._toArray(arguments)))};var e=a._extraNames,f=e.length,g={};dojo.clone=function(b){if(!b||typeof b!="object"||a.isFunction(b))return b;if(b.nodeType&&"cloneNode"in b)return b.cloneNode(!0);if(b instanceof Date)return new Date(b.getTime());if(b instanceof RegExp)return RegExp(b);var c,d,h,m;if(a.isArray(b)){c=[];
d=0;for(h=b.length;d<h;++d)d in b&&c.push(a.clone(b[d]))}else c=b.constructor?new b.constructor:{};for(m in b)if(h=b[m],!(m in c)||c[m]!==h&&(!(m in g)||g[m]!==h))c[m]=a.clone(h);if(f)for(d=0;d<f;++d)if(m=e[d],h=b[m],!(m in c)||c[m]!==h&&(!(m in g)||g[m]!==h))c[m]=h;return c};dojo.trim=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")};var h=/\{([^\}]+)\}/g;dojo.replace=function(b,c,d){return b.replace(d||h,a.isFunction(c)?c:function(b,
d){return a.getObject(d,!1,c)})}}());dojo._hasResource["dojo._base.array"]||(dojo._hasResource["dojo._base.array"]=!0,dojo.provide("dojo._base.array"),function(){var a=function(a,b,e){return[typeof a=="string"?a.split(""):a,b||dojo.global,typeof e=="string"?new Function("item","index","array",e):e]},b=function(b,d,e,f){for(var e=a(d,f,e),d=e[0],f=0,g=d.length;f<g;++f){var h=!!e[2].call(e[1],d[f],f,d);if(b^h)return h}return b};dojo.mixin(dojo,{indexOf:function(a,b,e,f){var g=1,h=a.length||0,i=0;f&&
(i=h-1,g=h=-1);e!=void 0&&(i=e);if(f&&i>h||i<h)for(;i!=h;i+=g)if(a[i]==b)return i;return-1},lastIndexOf:function(a,b,e){return dojo.indexOf(a,b,e,!0)},forEach:function(b,d,e){if(b&&b.length)for(var d=a(b,e,d),b=d[0],e=0,f=b.length;e<f;++e)d[2].call(d[1],b[e],e,b)},every:function(a,d,e){return b(!0,a,d,e)},some:function(a,d,e){return b(!1,a,d,e)},map:function(b,d,e,f){for(var d=a(b,e,d),b=d[0],f=f?new f:[],e=0,g=b.length;e<g;++e)f.push(d[2].call(d[1],b[e],e,b));return f},filter:function(b,d,e){for(var d=
a(b,e,d),b=d[0],e=[],f=0,g=b.length;f<g;++f)d[2].call(d[1],b[f],f,b)&&e.push(b[f]);return e}})}());dojo._hasResource["dojo._base.declare"]||(dojo._hasResource["dojo._base.declare"]=!0,dojo.provide("dojo._base.declare"),function(){function a(a,b){throw Error("declare"+(b?" "+b:"")+": "+a);}function b(b,c,d){var e,h,f,g,i,o,j,l=this._inherited=this._inherited||{};typeof b=="string"&&(e=b,b=c,c=d);d=0;g=b.callee;(e=e||g.nom)||a("can't deduce a name to call inherited()",this.declaredClass);i=this.constructor._meta;
f=i.bases;j=l.p;if(e!=s){if(l.c!==g&&(j=0,o=f[0],i=o._meta,i.hidden[e]!==g)){(h=i.chains)&&typeof h[e]=="string"&&a("calling chained method with inherited: "+e,this.declaredClass);do if(i=o._meta,h=o.prototype,i&&(h[e]===g&&h.hasOwnProperty(e)||i.hidden[e]===g))break;while(o=f[++j]);j=o?j:-1}if(o=f[++j])if(h=o.prototype,o._meta&&h.hasOwnProperty(e))d=h[e];else{g=t[e];do if(h=o.prototype,(d=h[e])&&(o._meta?h.hasOwnProperty(e):d!==g))break;while(o=f[++j])}d=o&&d||t[e]}else{if(l.c!==g&&(j=0,(i=f[0]._meta)&&
i.ctor!==g)){h=i.chains;for((!h||h.constructor!=="manual")&&a("calling chained constructor with inherited",this.declaredClass);o=f[++j];)if((i=o._meta)&&i.ctor===g)break;j=o?j:-1}for(;o=f[++j];)if(d=(i=o._meta)?i.ctor:o)break;d=o&&d}l.c=d;l.p=j;if(d)return c===!0?d:d.apply(this,c||b)}function c(a,b){if(typeof a=="string")return this.inherited(a,b,!0);return this.inherited(a,!0)}function d(a){for(var b=this.constructor._meta.bases,c=0,d=b.length;c<d;++c)if(b[c]===a)return!0;return this instanceof a}
function e(a,b){var c,d=0,e=l._extraNames.length;for(c in b)c!=s&&b.hasOwnProperty(c)&&(a[c]=b[c]);for(;d<e;++d)c=l._extraNames[d],c!=s&&b.hasOwnProperty(c)&&(a[c]=b[c])}function f(a,b){var c,d,e=0,h=l._extraNames.length;for(c in b)if(d=b[c],(d!==t[c]||!(c in t))&&c!=s){if(r.call(d)=="[object Function]")d.nom=c;a[c]=d}for(;e<h;++e)if(c=l._extraNames[e],d=b[c],(d!==t[c]||!(c in t))&&c!=s){if(r.call(d)=="[object Function]")d.nom=c;a[c]=d}return a}function g(a){f(this.prototype,a);return this}function h(a,
b){return function(){var q;var c=arguments,d=c,e=c[0],h,f;f=a.length;var g;if(!(this instanceof c.callee))return m(c);if(b&&(e&&e.preamble||this.preamble)){g=Array(a.length);g[0]=c;for(h=0;;){if(e=c[0])(e=e.preamble)&&(c=e.apply(this,c)||c);e=a[h].prototype;(e=e.hasOwnProperty("preamble")&&e.preamble)&&(c=e.apply(this,c)||c);if(++h==f)break;g[h]=c}}for(h=f-1;h>=0;--h)e=a[h],(q=(f=e._meta)?f.ctor:e,e=q)&&e.apply(this,g?g[h]:c);(e=this.postscript)&&e.apply(this,d)}}function i(a,b){return function(){var c=
arguments,d=c,e=c[0];if(!(this instanceof c.callee))return m(c);if(b){if(e)(e=e.preamble)&&(d=e.apply(this,d)||d);(e=this.preamble)&&e.apply(this,d)}a&&a.apply(this,c);(e=this.postscript)&&e.apply(this,c)}}function j(a){return function(){var q;var b=arguments,c=0,d,e;if(!(this instanceof b.callee))return m(b);for(;d=a[c];++c)if(q=(e=d._meta)?e.ctor:d,d=q){d.apply(this,b);break}(d=this.postscript)&&d.apply(this,b)}}function k(a,b,c){return function(){var d,e,h=0,f=1;c&&(h=b.length-1,f=-1);for(;d=b[h];h+=
f)e=d._meta,(d=(e?e.hidden:d.prototype)[a])&&d.apply(this,arguments)}}function n(a){p.prototype=a.prototype;a=new p;p.prototype=null;return a}function m(a){var b=a.callee,c=n(b);b.apply(c,a);return c}var l=dojo,o=l._mixin,t=Object.prototype,r=t.toString,p=new Function,B=0,s="constructor";l.declare=function(m,p,C){typeof m!="string"&&(C=p,p=m,m="");var C=C||{},v,D,q,z,I,w,E,J=1,u=p;if(r.call(p)=="[object Array]"){J=m;q=[];z=[{cls:0,refs:[]}];w={};for(var x=1,N=p.length,G=0,A,K,y,F;G<N;++G){(A=p[G])?
r.call(A)!="[object Function]"&&a("mixin #"+G+" is not a callable constructor.",J):a("mixin #"+G+" is unknown. Did you use dojo.require to pull it in?",J);K=A._meta?A._meta.bases:[A];y=0;for(A=K.length-1;A>=0;--A){F=K[A].prototype;if(!F.hasOwnProperty("declaredClass"))F.declaredClass="uniqName_"+B++;F=F.declaredClass;w.hasOwnProperty(F)||(w[F]={count:0,refs:[],cls:K[A]},++x);F=w[F];y&&y!==F&&(F.refs.push(y),++y.count);y=F}++y.count;z[0].refs.push(y)}for(;z.length;){y=z.pop();q.push(y.cls);for(--x;D=
y.refs,D.length==1;){y=D[0];if(!y||--y.count){y=0;break}q.push(y.cls);--x}if(y){G=0;for(N=D.length;G<N;++G)y=D[G],--y.count||z.push(y)}}x&&a("can't build consistent linearization",J);A=p[0];q[0]=A?A._meta&&A===q[q.length-A._meta.bases.length]?A._meta.bases.length:1:0;w=q;q=w[0];J=w.length-q;p=w[J]}else w=[0],p?r.call(p)=="[object Function]"?(q=p._meta,w=w.concat(q?q.bases:p)):a("base class is not a callable constructor.",m):p!==null&&a("unknown base class. Did you use dojo.require to pull it in?",
m);if(p)for(D=J-1;;--D){v=n(p);if(!D)break;q=w[D];(q._meta?e:o)(v,q.prototype);z=new Function;z.superclass=p;z.prototype=v;p=v.constructor=z}else v={};f(v,C);q=C.constructor;if(q!==t.constructor)q.nom=s,v.constructor=q;for(D=J-1;D;--D)(q=w[D]._meta)&&q.chains&&(E=o(E||{},q.chains));v["-chains-"]&&(E=o(E||{},v["-chains-"]));q=!E||!E.hasOwnProperty(s);w[0]=z=E&&E.constructor==="manual"?j(w):w.length==1?i(C.constructor,q):h(w,q);z._meta={bases:w,hidden:C,chains:E,parents:u,ctor:C.constructor};z.superclass=
p&&p.prototype;z.extend=g;z.prototype=v;v.constructor=z;v.getInherited=c;v.inherited=b;v.isInstanceOf=d;if(m)v.declaredClass=m,l.setObject(m,z);if(E)for(I in E)if(v[I]&&typeof E[I]=="string"&&I!=s)q=v[I]=k(I,w,E[I]==="after"),q.nom=I;return z};l.safeMixin=f}());if(!dojo._hasResource["dojo._base.connect"])dojo._hasResource["dojo._base.connect"]=!0,dojo.provide("dojo._base.connect"),dojo._listener={getDispatcher:function(){return function(){var a=Array.prototype,b=arguments.callee,c=b._listeners,b=
(b=b.target)&&b.apply(this,arguments),d,c=[].concat(c);for(d in c)d in a||c[d].apply(this,arguments);return b}},add:function(a,b,c){var a=a||dojo.global,d=a[b];if(!d||!d._listeners){var e=dojo._listener.getDispatcher();e.target=d;e._listeners=[];d=a[b]=e}return d._listeners.push(c)},remove:function(a,b,c){(a=(a||dojo.global)[b])&&a._listeners&&c--&&delete a._listeners[c]}},dojo.connect=function(){var a=arguments,b=[],c=0;b.push(dojo.isString(a[0])?null:a[c++],a[c++]);var d=a[c+1];b.push(dojo.isString(d)||
dojo.isFunction(d)?a[c++]:null,a[c++]);for(d=a.length;c<d;c++)b.push(a[c]);return dojo._connect.apply(this,b)},dojo._connect=function(a,b,c,d){var e=dojo._listener,c=e.add(a,b,dojo.hitch(c,d));return[a,b,c,e]},dojo.disconnect=function(a){a&&a[0]!==void 0&&(dojo._disconnect.apply(this,a),delete a[0])},dojo._disconnect=function(a,b,c,d){d.remove(a,b,c)},dojo._topics={},dojo.subscribe=function(a,b,c){return[a,dojo._listener.add(dojo._topics,a,dojo.hitch(b,c))]},dojo.unsubscribe=function(a){a&&dojo._listener.remove(dojo._topics,
a[0],a[1])},dojo.publish=function(a,b){var c=dojo._topics[a];c&&c.apply(this,b||[])},dojo.connectPublisher=function(a,b,c){var d=function(){dojo.publish(a,arguments)};return c?dojo.connect(b,c,d):dojo.connect(b,d)};if(!dojo._hasResource["dojo._base.Deferred"])dojo._hasResource["dojo._base.Deferred"]=!0,dojo.provide("dojo._base.Deferred"),function(){var a=function(){},b=Object.freeze||function(){};dojo.Deferred=function(c){function d(a){if(g)throw Error("This deferred has already been resolved");f=
a;g=!0;e()}function e(){for(var b;!b&&j;){var c=j;j=j.next;if(b=c.progress==a)g=!1;var d=h?c.error:c.resolved;if(d)try{var e=d(f);e&&typeof e.then==="function"?e.then(dojo.hitch(c.deferred,"resolve"),dojo.hitch(c.deferred,"reject")):(d=b&&e===void 0,b&&!d&&(h=e instanceof Error),c.deferred[d&&h?"reject":"resolve"](d?f:e))}catch(i){c.deferred.reject(i)}else h?c.deferred.reject(f):c.deferred.resolve(f)}}var f,g,h,i,j,k=this.promise={};this.resolve=this.callback=function(a){this.fired=0;this.results=
[a,null];d(a)};this.reject=this.errback=function(a){h=!0;this.fired=1;d(a);this.results=[null,a];if(!a||a.log!==!1)(dojo.config.deferredOnError||function(a){console.error(a)})(a)};this.progress=function(a){for(var b=j;b;){var c=b.progress;c&&c(a);b=b.next}};this.addCallbacks=function(b,c){this.then(b,c,a);return this};this.then=k.then=function(b,c,d){var h=d==a?this:new dojo.Deferred(k.cancel),b={resolved:b,error:c,progress:d,deferred:h};j?i=i.next=b:j=i=b;g&&e();return h.promise};var n=this;this.cancel=
k.cancel=function(){if(!g){var a=c&&c(n);if(!g)a instanceof Error||(a=Error(a)),a.log=!1,n.reject(a)}};b(k)};dojo.extend(dojo.Deferred,{addCallback:function(){return this.addCallbacks(dojo.hitch.apply(dojo,arguments))},addErrback:function(){return this.addCallbacks(null,dojo.hitch.apply(dojo,arguments))},addBoth:function(){var a=dojo.hitch.apply(dojo,arguments);return this.addCallbacks(a,a)},fired:-1})}(),dojo.when=function(a,b,c,d){if(a&&typeof a.then==="function")return a.then(b,c,d);return b(a)};
if(!dojo._hasResource["dojo._base.json"])dojo._hasResource["dojo._base.json"]=!0,dojo.provide("dojo._base.json"),dojo.fromJson=function(a){return eval("("+a+")")},dojo._escapeString=function(a){return('"'+a.replace(/(["\\])/g,"\\$1")+'"').replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")},dojo.toJsonIndentStr="\t",dojo.toJson=function(a,b,c){if(a===void 0)return"undefined";var d=typeof a;if(d=="number"||d=="boolean")return a+"";if(a===
null)return"null";if(dojo.isString(a))return dojo._escapeString(a);var e=arguments.callee,f,c=c||"",g=b?c+dojo.toJsonIndentStr:"";f=a.__json__||a.json;if(dojo.isFunction(f)&&(f=f.call(a),a!==f))return e(f,b,g);if(a.nodeType&&a.cloneNode)throw Error("Can't serialize DOM nodes");f=b?" ":"";var h=b?"\n":"";if(dojo.isArray(a))return"["+dojo.map(a,function(a){a=e(a,b,g);typeof a!="string"&&(a="undefined");return h+g+a}).join(","+f)+h+c+"]";if(d=="function")return null;var d=[],i;for(i in a){var j,k;if(typeof i==
"number")j='"'+i+'"';else if(typeof i=="string")j=dojo._escapeString(i);else continue;k=e(a[i],b,g);typeof k=="string"&&d.push(h+g+j+":"+f+k)}return"{"+d.join(","+f)+h+c+"}"};dojo._hasResource["dojo._base.Color"]||(dojo._hasResource["dojo._base.Color"]=!0,dojo.provide("dojo._base.Color"),function(){var a=dojo;dojo.Color=function(a){a&&this.setColor(a)};dojo.Color.named={black:[0,0,0],silver:[192,192,192],gray:[128,128,128],white:[255,255,255],maroon:[128,0,0],red:[255,0,0],purple:[128,0,128],fuchsia:[255,
0,255],green:[0,128,0],lime:[0,255,0],olive:[128,128,0],yellow:[255,255,0],navy:[0,0,128],blue:[0,0,255],teal:[0,128,128],aqua:[0,255,255],transparent:a.config.transparentColor||[255,255,255]};dojo.extend(dojo.Color,{r:255,g:255,b:255,a:1,_set:function(a,c,d,e){this.r=a;this.g=c;this.b=d;this.a=e},setColor:function(b){a.isString(b)?a.colorFromString(b,this):a.isArray(b)?a.colorFromArray(b,this):(this._set(b.r,b.g,b.b,b.a),b instanceof a.Color||this.sanitize());return this},sanitize:function(){return this},
toRgb:function(){return[this.r,this.g,this.b]},toRgba:function(){return[this.r,this.g,this.b,this.a]},toHex:function(){return"#"+a.map(["r","g","b"],function(a){a=this[a].toString(16);return a.length<2?"0"+a:a},this).join("")},toCss:function(a){var c=this.r+", "+this.g+", "+this.b;return(a?"rgba("+c+", "+this.a:"rgb("+c)+")"},toString:function(){return this.toCss(!0)}});dojo.blendColors=function(b,c,d,e){var f=e||new a.Color;a.forEach(["r","g","b","a"],function(a){f[a]=b[a]+(c[a]-b[a])*d;a!="a"&&
(f[a]=Math.round(f[a]))});return f.sanitize()};dojo.colorFromRgb=function(a,c){var d=a.toLowerCase().match(/^rgba?\(([\s\.,0-9]+)\)/);return d&&dojo.colorFromArray(d[1].split(/\s*,\s*/),c)};dojo.colorFromHex=function(b,c){var d=c||new a.Color,e=b.length==4?4:8,f=(1<<e)-1,b=Number("0x"+b.substr(1));if(isNaN(b))return null;a.forEach(["b","g","r"],function(a){var c=b&f;b>>=e;d[a]=e==4?17*c:c});d.a=1;return d};dojo.colorFromArray=function(b,c){var d=c||new a.Color;d._set(Number(b[0]),Number(b[1]),Number(b[2]),
Number(b[3]));if(isNaN(d.a))d.a=1;return d.sanitize()};dojo.colorFromString=function(b,c){var d=a.Color.named[b];return d&&a.colorFromArray(d,c)||a.colorFromRgb(b,c)||a.colorFromHex(b,c)}}());if(!dojo._hasResource["dojo._base.window"])dojo._hasResource["dojo._base.window"]=!0,dojo.provide("dojo._base.window"),dojo.doc=window.document||null,dojo.body=function(){return dojo.doc.body||dojo.doc.getElementsByTagName("body")[0]},dojo.setContext=function(a,b){dojo.global=a;dojo.doc=b},dojo.withGlobal=function(a,
b,c,d){var e=dojo.global;try{return dojo.global=a,dojo.withDoc.call(null,a.document,b,c,d)}finally{dojo.global=e}},dojo.withDoc=function(a,b,c,d){var e=dojo.doc,f=dojo._bodyLtr,g=dojo.isQuirks;try{return dojo.doc=a,delete dojo._bodyLtr,dojo.isQuirks=dojo.doc.compatMode=="BackCompat",c&&typeof b=="string"&&(b=c[b]),b.apply(c,d||[])}finally{dojo.doc=e;delete dojo._bodyLtr;if(f!==void 0)dojo._bodyLtr=f;dojo.isQuirks=g}};if(!dojo._hasResource["dojo._base.event"]&&(dojo._hasResource["dojo._base.event"]=
!0,dojo.provide("dojo._base.event"),function(){var a=dojo._event_listener={add:function(b,c,d){if(b){c=a._normalizeEventName(c);d=a._fixCallback(c,d);if(!dojo.isIE&&(c=="mouseenter"||c=="mouseleave"))var e=d,c=c=="mouseenter"?"mouseover":"mouseout",d=function(a){if(!dojo.isDescendant(a.relatedTarget,b))return e.call(this,a)};b.addEventListener(c,d,!1);return d}},remove:function(b,c,d){if(b){c=a._normalizeEventName(c);if(!dojo.isIE&&(c=="mouseenter"||c=="mouseleave"))c=c=="mouseenter"?"mouseover":
"mouseout";b.removeEventListener(c,d,!1)}},_normalizeEventName:function(a){return a.slice(0,2)=="on"?a.slice(2):a},_fixCallback:function(b,c){return b!="keypress"?c:function(b){return c.call(this,a._fixEvent(b,this))}},_fixEvent:function(b){switch(b.type){case "keypress":a._setKeyChar(b)}return b},_setKeyChar:function(a){a.keyChar=a.charCode?String.fromCharCode(a.charCode):"";a.charOrCode=a.keyChar||a.keyCode},_punctMap:{106:42,111:47,186:59,187:43,188:44,189:45,190:46,191:47,192:96,219:91,220:92,
221:93,222:39}};dojo.fixEvent=function(b,c){return a._fixEvent(b,c)};dojo.stopEvent=function(a){a.preventDefault();a.stopPropagation()};var b=dojo._listener;dojo._connect=function(c,d,e,f,g){g=c&&(c.nodeType||c.attachEvent||c.addEventListener)?g?2:1:0;e=[dojo._listener,a,b][g].add(c,d,dojo.hitch(e,f));return[c,d,e,g]};dojo._disconnect=function(c,d,e,f){[dojo._listener,a,b][f].remove(c,d,e)};dojo.keys={BACKSPACE:8,TAB:9,CLEAR:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,META:dojo.isSafari?91:224,PAUSE:19,CAPS_LOCK:20,
ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,HELP:47,LEFT_WINDOW:91,RIGHT_WINDOW:92,SELECT:93,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,NUMPAD_MULTIPLY:106,NUMPAD_PLUS:107,NUMPAD_ENTER:108,NUMPAD_MINUS:109,NUMPAD_PERIOD:110,NUMPAD_DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,
F13:124,F14:125,F15:126,NUM_LOCK:144,SCROLL_LOCK:145,copyKey:dojo.isMac&&!dojo.isAIR?dojo.isSafari?91:224:17};var c=dojo.isMac?"metaKey":"ctrlKey";dojo.isCopyKey=function(a){return a[c]};dojo.mouseButtons=dojo.isIE<9||dojo.isIE&&dojo.isQuirks?{LEFT:1,MIDDLE:4,RIGHT:2,isButton:function(a,b){return a.button&b},isLeft:function(a){return a.button&1},isMiddle:function(a){return a.button&4},isRight:function(a){return a.button&2}}:{LEFT:0,MIDDLE:1,RIGHT:2,isButton:function(a,b){return a.button==b},isLeft:function(a){return a.button==
0},isMiddle:function(a){return a.button==1},isRight:function(a){return a.button==2}};if(dojo.isIE){var d=function(a,b){try{return a.keyCode=b}catch(c){return 0}},e=dojo._listener,f=dojo._ieListenersName="_"+dojo._scopeName+"_listeners";if(!dojo.config._allow_leaks)var b=e=dojo._ie_listener={handlers:[],add:function(a,b,c){var a=a||dojo.global,d=a[b];if(!d||!d[f]){var e=dojo._getIeDispatcher();e.target=d&&g.push(d)-1;e[f]=[];d=a[b]=e}return d[f].push(g.push(c)-1)},remove:function(a,b,c){var h;h=(a=
(a||dojo.global)[b])&&a[f],b=h;a&&b&&c--&&(delete g[b[c]],delete b[c])}},g=e.handlers;dojo.mixin(a,{add:function(b,c,d){if(b){c=a._normalizeEventName(c);if(c=="onkeypress"){var g=b.onkeydown;if(!g||!g[f]||!g._stealthKeydownHandle){var n=a.add(b,"onkeydown",a._stealthKeyDown),g=b.onkeydown;g._stealthKeydownHandle=n;g._stealthKeydownRefs=1}else g._stealthKeydownRefs++}return e.add(b,c,a._fixCallback(d))}},remove:function(b,c,d){c=a._normalizeEventName(c);e.remove(b,c,d);if(c=="onkeypress")c=b.onkeydown,
--c._stealthKeydownRefs<=0&&(e.remove(b,"onkeydown",c._stealthKeydownHandle),delete c._stealthKeydownHandle)},_normalizeEventName:function(a){return a.slice(0,2)!="on"?"on"+a:a},_nop:function(){},_fixEvent:function(b,c){if(!b)b=(c&&(c.ownerDocument||c.document||c).parentWindow||window).event;if(!b)return b;b.target=b.srcElement;b.currentTarget=c||b.srcElement;b.layerX=b.offsetX;b.layerY=b.offsetY;var d=b.srcElement,d=d&&d.ownerDocument||document,d=dojo.isIE<6||d.compatMode=="BackCompat"?d.body:d.documentElement,
e=dojo._getIeDocumentElementOffset();b.pageX=b.clientX+dojo._fixIeBiDiScrollLeft(d.scrollLeft||0)-e.x;b.pageY=b.clientY+(d.scrollTop||0)-e.y;if(b.type=="mouseover")b.relatedTarget=b.fromElement;if(b.type=="mouseout")b.relatedTarget=b.toElement;if(dojo.isIE<9||dojo.isQuirks)b.stopPropagation=a._stopPropagation,b.preventDefault=a._preventDefault;return a._fixKeys(b)},_fixKeys:function(b){switch(b.type){case "keypress":var c="charCode"in b?b.charCode:b.keyCode;c==10?(c=0,b.keyCode=13):c==13||c==27?c=
0:c==3&&(c=99);b.charCode=c;a._setKeyChar(b)}return b},_stealthKeyDown:function(b){var c=b.currentTarget.onkeypress;if(c&&c[f]){var e=b.keyCode,g=e!=13&&e!=32&&e!=27&&(e<48||e>90)&&(e<96||e>111)&&(e<186||e>192)&&(e<219||e>222);if(g||b.ctrlKey){g=g?0:e;if(b.ctrlKey)if(e==3||e==13)return;else g>95&&g<106?g-=48:!b.shiftKey&&g>=65&&g<=90?g+=32:g=a._punctMap[g]||g;e=a._synthesizeEvent(b,{type:"keypress",faux:!0,charCode:g});c.call(b.currentTarget,e);b.cancelBubble=e.cancelBubble;b.returnValue=e.returnValue;
d(b,e.keyCode)}}},_stopPropagation:function(){this.cancelBubble=!0},_preventDefault:function(){this.bubbledKeyCode=this.keyCode;this.ctrlKey&&d(this,0);this.returnValue=!1}});dojo.stopEvent=dojo.isIE<9||dojo.isQuirks?function(b){b=b||window.event;a._stopPropagation.call(b);a._preventDefault.call(b)}:dojo.stopEvent}a._synthesizeEvent=function(b,c){var d=dojo.mixin({},b,c);a._setKeyChar(d);d.preventDefault=function(){b.preventDefault()};d.stopPropagation=function(){b.stopPropagation()};return d};dojo.isOpera&&
dojo.mixin(a,{_fixEvent:function(b){switch(b.type){case "keypress":var c=b.which;c==3&&(c=99);c=c<41&&!b.shiftKey?0:c;b.ctrlKey&&!b.shiftKey&&c>=65&&c<=90&&(c+=32);return a._synthesizeEvent(b,{charCode:c})}return b}});if(dojo.isWebKit)a._add=a.add,a._remove=a.remove,dojo.mixin(a,{add:function(b,c,d){if(b){var e=a._add(b,c,d);if(a._normalizeEventName(c)=="keypress")e._stealthKeyDownHandle=a._add(b,"keydown",function(b){var c=b.keyCode,e=c!=13&&c!=32&&(c<48||c>90)&&(c<96||c>111)&&(c<186||c>192)&&(c<
219||c>222);if(e||b.ctrlKey){e=e?0:c;if(b.ctrlKey)if(c==3||c==13)return;else e>95&&e<106?e-=48:!b.shiftKey&&e>=65&&e<=90?e+=32:e=a._punctMap[e]||e;c=a._synthesizeEvent(b,{type:"keypress",faux:!0,charCode:e});d.call(b.currentTarget,c)}});return e}},remove:function(b,c,d){b&&(d._stealthKeyDownHandle&&a._remove(b,"keydown",d._stealthKeyDownHandle),a._remove(b,c,d))},_fixEvent:function(b){switch(b.type){case "keypress":if(b.faux)break;var c=b.charCode;return a._synthesizeEvent(b,{charCode:c>=32?c:0,faux:!0})}return b}})}(),
dojo.isIE))dojo._ieDispatcher=function(a,b){var c=Array.prototype,d=dojo._ie_listener.handlers,e=a.callee,f=e[dojo._ieListenersName],e=(e=d[e.target])&&e.apply(b,a),f=[].concat(f),g;for(g in f){var h=d[f[g]];!(g in c)&&h&&h.apply(b,a)}return e},dojo._getIeDispatcher=function(){return new Function(dojo._scopeName+"._ieDispatcher(arguments, this)")},dojo._event_listener._fixCallback=function(a){var b=dojo._event_listener._fixEvent;return function(c){return a.call(this,b(c,this))}};if(!dojo._hasResource["dojo._base.html"]){dojo._hasResource["dojo._base.html"]=
!0;dojo.provide("dojo._base.html");try{document.execCommand("BackgroundImageCache",!1,!0)}catch(X){}dojo.byId=dojo.isIE?function(a,b){if(typeof a!="string")return a;var c=b||dojo.doc,d=c.getElementById(a);if(d&&(d.attributes.id.value==a||d.id==a))return d;else{c=c.all[a];if(!c||c.nodeName)c=[c];for(var e=0;d=c[e++];)if(d.attributes&&d.attributes.id&&d.attributes.id.value==a||d.id==a)return d}}:function(a,b){return(typeof a=="string"?(b||dojo.doc).getElementById(a):a)||null};(function(){var a=dojo,
b=a.byId,c=null,d;a.addOnWindowUnload(function(){c=null});dojo._destroyElement=dojo.destroy=function(a){a=b(a);try{var e=a.ownerDocument;if(!c||d!=e)c=e.createElement("div"),d=e;c.appendChild(a.parentNode?a.parentNode.removeChild(a):a);c.innerHTML=""}catch(f){}};dojo.isDescendant=function(a,c){try{a=b(a);for(c=b(c);a;){if(a==c)return!0;a=a.parentNode}}catch(d){}return!1};dojo.setSelectable=function(c,d){c=b(c);if(a.isMozilla)c.style.MozUserSelect=d?"":"none";else if(a.isKhtml||a.isWebKit)c.style.KhtmlUserSelect=
d?"auto":"none";else if(a.isIE){var e=c.unselectable=d?"":"on";a.query("*",c).forEach("item.unselectable = '"+e+"'")}};var e=function(a,b){var c=b.parentNode;c&&c.insertBefore(a,b)};dojo.place=function(c,d,f){d=b(d);typeof c=="string"&&(c=/^\s*</.test(c)?a._toDom(c,d.ownerDocument):b(c));if(typeof f=="number"){var g=d.childNodes;!g.length||g.length<=f?d.appendChild(c):e(c,g[f<0?0:f])}else switch(f){case "before":e(c,d);break;case "after":f=c;(g=d.parentNode)&&(g.lastChild==d?g.appendChild(f):g.insertBefore(f,
d.nextSibling));break;case "replace":d.parentNode.replaceChild(c,d);break;case "only":a.empty(d);d.appendChild(c);break;case "first":if(d.firstChild){e(c,d.firstChild);break}default:d.appendChild(c)}return c};dojo.boxModel="content-box";if(a.isIE)a.boxModel=document.compatMode=="BackCompat"?"border-box":"content-box";var f;f=a.isWebKit?function(a){var b;if(a.nodeType==1){var c=a.ownerDocument.defaultView;b=c.getComputedStyle(a,null);if(!b&&a.style)a.style.display="",b=c.getComputedStyle(a,null)}return b||
{}}:a.isIE?function(a){return a.nodeType==1?a.currentStyle:{}}:function(a){return a.nodeType==1?a.ownerDocument.defaultView.getComputedStyle(a,null):{}};dojo.getComputedStyle=f;a._toPixelValue=a.isIE?function(a,b){if(!b)return 0;if(b=="medium")return 4;if(b.slice&&b.slice(-2)=="px")return parseFloat(b);with(a){var c=style.left,d=runtimeStyle.left;runtimeStyle.left=currentStyle.left;try{style.left=b,b=style.pixelLeft}catch(e){b=0}style.left=c;runtimeStyle.left=d}return b}:function(a,b){return parseFloat(b)||
0};var g=a._toPixelValue,h=function(a,b){try{return a.filters.item("DXImageTransform.Microsoft.Alpha")}catch(c){return b?{}:null}};dojo._getOpacity=a.isIE?function(a){try{return h(a).Opacity/100}catch(b){return 1}}:function(a){return f(a).opacity};dojo._setOpacity=a.isIE?function(b,c){var d=c*100,e=c==1;b.style.zoom=e?"":1;if(h(b))h(b,1).Opacity=d;else{if(e)return c;b.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(Opacity="+d+")"}h(b,1).Enabled=!e;b.nodeName.toLowerCase()=="tr"&&a.query("> td",
b).forEach(function(b){a._setOpacity(b,c)});return c}:function(a,b){return a.style.opacity=b};var i={left:!0,top:!0},j=/margin|padding|width|height|max|min|offset/,k=function(b,c,d){c=c.toLowerCase();if(a.isIE){if(d=="auto"){if(c=="height")return b.offsetHeight;if(c=="width")return b.offsetWidth}if(c=="fontweight")switch(d){case 700:return"bold";default:return"normal"}}c in i||(i[c]=j.test(c));return i[c]?g(b,d):d},n=a.isIE?"styleFloat":"cssFloat",m={cssFloat:n,styleFloat:n,"float":n};dojo.style=
function(c,d,e){var g=b(c),h=arguments.length,o=d=="opacity",d=m[d]||d;if(h==3)return o?a._setOpacity(g,e):g.style[d]=e;if(h==2&&o)return a._getOpacity(g);o=f(g);if(h==2&&typeof d!="string"){for(var i in d)a.style(c,i,d[i]);return o}return h==1?o:k(g,d,o[d]||g.style[d])};dojo._getPadExtents=function(a,b){var c=b||f(a),d=g(a,c.paddingLeft),e=g(a,c.paddingTop);return{l:d,t:e,w:d+g(a,c.paddingRight),h:e+g(a,c.paddingBottom)}};dojo._getBorderExtents=function(a,b){var c=b||f(a),d=c.borderLeftStyle!="none"?
g(a,c.borderLeftWidth):0,e=c.borderTopStyle!="none"?g(a,c.borderTopWidth):0;return{l:d,t:e,w:d+(c.borderRightStyle!="none"?g(a,c.borderRightWidth):0),h:e+(c.borderBottomStyle!="none"?g(a,c.borderBottomWidth):0)}};dojo._getPadBorderExtents=function(b,c){var d=c||f(b),e=a._getPadExtents(b,d),d=a._getBorderExtents(b,d);return{l:e.l+d.l,t:e.t+d.t,w:e.w+d.w,h:e.h+d.h}};dojo._getMarginExtents=function(b,c){var d=c||f(b),e=g(b,d.marginLeft),h=g(b,d.marginTop),o=g(b,d.marginRight),i=g(b,d.marginBottom);a.isWebKit&&
d.position!="absolute"&&(o=e);return{l:e,t:h,w:e+o,h:h+i}};dojo._getMarginBox=function(b,c){var d=c||f(b),e=a._getMarginExtents(b,d),g=b.offsetLeft-e.l,h=b.offsetTop-e.t,o=b.parentNode;if(a.isMoz){var i=parseFloat(d.left),d=parseFloat(d.top);!isNaN(i)&&!isNaN(d)?(g=i,h=d):o&&o.style&&(i=f(o),i.overflow!="visible"&&(o=a._getBorderExtents(o,i),g+=o.l,h+=o.t))}else if((a.isOpera||a.isIE>7&&!a.isQuirks)&&o)o=a._getBorderExtents(o),g-=o.l,h-=o.t;return{l:g,t:h,w:b.offsetWidth+e.w,h:b.offsetHeight+e.h}};
dojo._getMarginSize=function(c,d){if(c.getBoundingClientRect){var c=b(c),e=a._getMarginExtents(c,d||f(c)),g=c.getBoundingClientRect();return{w:g.right-g.left+e.w,h:g.bottom-g.top+e.h}}else return dojo.marginBox(c)};dojo._getContentBox=function(b,c){var d=c||f(b),e=a._getPadExtents(b,d),d=a._getBorderExtents(b,d),g=b.clientWidth,h;g?(h=b.clientHeight,d.w=d.h=0):(g=b.offsetWidth,h=b.offsetHeight);a.isOpera&&(e.l+=d.l,e.t+=d.t);return{l:e.l,t:e.t,w:g-e.w-d.w,h:h-e.h-d.h}};dojo._getBorderBox=function(b,
c){var d=c||f(b),e=a._getPadExtents(b,d),d=a._getContentBox(b,d);return{l:d.l-e.l,t:d.t-e.t,w:d.w+e.w,h:d.h+e.h}};dojo._setBox=function(a,b,c,d,e,f){f=f||"px";a=a.style;if(!isNaN(b))a.left=b+f;if(!isNaN(c))a.top=c+f;if(d>=0)a.width=d+f;if(e>=0)a.height=e+f};dojo._isButtonTag=function(a){return a.tagName=="BUTTON"||a.tagName=="INPUT"&&(a.getAttribute("type")||"").toUpperCase()=="BUTTON"};dojo._usesBorderBox=function(b){var c=b.tagName;return a.boxModel=="border-box"||c=="TABLE"||a._isButtonTag(b)};
dojo._setContentSize=function(b,c,d,e){a._usesBorderBox(b)&&(e=a._getPadBorderExtents(b,e),c>=0&&(c+=e.w),d>=0&&(d+=e.h));a._setBox(b,NaN,NaN,c,d)};dojo._setMarginBox=function(b,c,d,e,g,h){var o=h||f(b),h=a._usesBorderBox(b)?l:a._getPadBorderExtents(b,o);if(a.isWebKit&&a._isButtonTag(b)){var i=b.style;if(e>=0&&!i.width)i.width="4px";if(g>=0&&!i.height)i.height="4px"}o=a._getMarginExtents(b,o);e>=0&&(e=Math.max(e-h.w-o.w,0));g>=0&&(g=Math.max(g-h.h-o.h,0));a._setBox(b,c,d,e,g)};var l={l:0,t:0,w:0,
h:0};dojo.marginBox=function(c,d){var e=b(c),g=f(e);return!d?a._getMarginBox(e,g):a._setMarginBox(e,d.l,d.t,d.w,d.h,g)};dojo.contentBox=function(c,d){var e=b(c),g=f(e);return!d?a._getContentBox(e,g):a._setContentSize(e,d.w,d.h,g)};var o=function(b,c){if(!(b=(b||0).parentNode))return 0;for(var d,e=0,g=a.body();b&&b.style;){if(f(b).position=="fixed")return 0;if(d=b[c])if(e+=d-0,b==g)break;b=b.parentNode}return e};dojo._docScroll=function(){var b=a.global;return"pageXOffset"in b?{x:b.pageXOffset,y:b.pageYOffset}:
(b=a.isQuirks?a.doc.body:a.doc.documentElement,{x:a._fixIeBiDiScrollLeft(b.scrollLeft||0),y:b.scrollTop||0})};dojo._isBodyLtr=function(){return"_bodyLtr"in a?a._bodyLtr:a._bodyLtr=(a.body().dir||a.doc.documentElement.dir||"ltr").toLowerCase()=="ltr"};dojo._getIeDocumentElementOffset=function(){var b=a.doc.documentElement;if(a.isIE<8){var c=b.getBoundingClientRect(),d=c.left,c=c.top;a.isIE<7&&(d+=b.clientLeft,c+=b.clientTop);return{x:d<0?0:d,y:c<0?0:c}}else return{x:0,y:0}};dojo._fixIeBiDiScrollLeft=
function(b){var c=a.isIE;if(c&&!a._isBodyLtr()){var d=a.isQuirks,e=d?a.doc.body:a.doc.documentElement;c==6&&!d&&a.global.frameElement&&e.scrollHeight>e.clientHeight&&(b+=e.clientLeft);return c<8||d?b+e.clientWidth-e.scrollWidth:-b}return b};dojo._abs=dojo.position=function(c,d){c=b(c);if(c.getBoundingClientRect){var e=a.body(),h=e.parentNode,i=c.getBoundingClientRect(),i={x:i.left,y:i.top,w:i.right-i.left,h:i.bottom-i.top};if(a.isIE)h=a._getIeDocumentElementOffset(),i.x-=h.x+(a.isQuirks?e.clientLeft+
e.offsetLeft:0),i.y-=h.y+(a.isQuirks?e.clientTop+e.offsetTop:0);else if(a.isFF==3){var l=f(h);i.x-=g(h,l.marginLeft)+g(h,l.borderLeftWidth);i.y-=g(h,l.marginTop)+g(h,l.borderTopWidth)}}else if(i={x:0,y:0,w:c.offsetWidth,h:c.offsetHeight},c.offsetParent){i.x-=o(c,"scrollLeft");i.y-=o(c,"scrollTop");e=c;do{var l=e.offsetLeft,t=e.offsetTop;i.x+=isNaN(l)?0:l;i.y+=isNaN(t)?0:t;l=f(e);e!=c&&(a.isMoz?(i.x+=2*g(e,l.borderLeftWidth),i.y+=2*g(e,l.borderTopWidth)):(i.x+=g(e,l.borderLeftWidth),i.y+=g(e,l.borderTopWidth)));
if(a.isMoz&&l.position=="static")for(l=e.parentNode;l!=e.offsetParent;)t=f(l),t.position=="static"&&(i.x+=g(e,t.borderLeftWidth),i.y+=g(e,t.borderTopWidth)),l=l.parentNode;e=e.offsetParent}while(e!=h&&e)}else c.x&&c.y&&(i.x+=isNaN(c.x)?0:c.x,i.y+=isNaN(c.y)?0:c.y);d&&(h=a._docScroll(),i.x+=h.x,i.y+=h.y);return i};dojo.coords=function(c,d){var e=b(c),g=f(e),g=a._getMarginBox(e,g),e=a.position(e,d);g.x=e.x;g.y=e.y;return g};var t={"class":"className","for":"htmlFor",tabindex:"tabIndex",readonly:"readOnly",
colspan:"colSpan",frameborder:"frameBorder",rowspan:"rowSpan",valuetype:"valueType"},r={classname:"class",htmlfor:"for",tabindex:"tabIndex",readonly:"readOnly"},p={innerHTML:1,className:1,htmlFor:a.isIE,value:1},B=function(a,b){var c=a.getAttributeNode&&a.getAttributeNode(b);return c&&c.specified};dojo.hasAttr=function(a,c){var d=c.toLowerCase();return p[t[d]||c]||B(b(a),r[d]||c)};var s={},U=0,R=dojo._scopeName+"attrid",C={col:1,colgroup:1,table:1,tbody:1,tfoot:1,thead:1,tr:1,title:1};dojo.attr=function(c,
d,e){var c=b(c),f=arguments.length;if(f==2&&typeof d!="string"){for(var g in d)a.attr(c,g,d[g]);return c}var h=d.toLowerCase();g=t[h]||d;var o=p[g],h=r[h]||d;if(f==3){if(g=="style"&&typeof e!="string")a.style(c,e);else if(g=="innerHTML")a.isIE&&c.tagName.toLowerCase()in C?(a.empty(c),c.appendChild(a._toDom(e,c.ownerDocument))):c[g]=e;else if(a.isFunction(e)){f=a.attr(c,R);f||(f=U++,a.attr(c,R,f));s[f]||(s[f]={});if(o=s[f][g])a.disconnect(o);else try{delete c[g]}catch(i){}s[f][g]=a.connect(c,g,e)}else o||
typeof e=="boolean"?c[g]=e:c.setAttribute(h,e);return c}e=c[g];if(o&&typeof e!="undefined")return e;if(g!="href"&&(typeof e=="boolean"||a.isFunction(e)))return e;return B(c,h)?c.getAttribute(h):null};dojo.removeAttr=function(a,c){b(a).removeAttribute(r[c.toLowerCase()]||c)};dojo.getNodeProp=function(a,c){var a=b(a),d=c.toLowerCase(),e=t[d]||c;if(e in a&&e!="href")return a[e];d=r[d]||c;return B(a,d)?a.getAttribute(d):null};dojo.create=function(c,d,e,f){var g=a.doc;if(e)e=b(e),g=e.ownerDocument;typeof c==
"string"&&(c=g.createElement(c));d&&a.attr(c,d);e&&a.place(c,e,f);return c};a.empty=a.isIE?function(c){for(var c=b(c),d;d=c.lastChild;)a.destroy(d)}:function(a){b(a).innerHTML=""};var v={option:["select"],tbody:["table"],thead:["table"],tfoot:["table"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","thead","tr"],legend:["fieldset"],caption:["table"],colgroup:["table"],col:["table","colgroup"],li:["ul"]},D=/<\s*([\w\:]+)/,q={},z=0,I="__"+a._scopeName+"ToDomId",w;for(w in v)if(v.hasOwnProperty(w))n=
v[w],n.pre=w=="option"?'<select multiple="multiple">':"<"+n.join("><")+">",n.post="</"+n.reverse().join("></")+">";a._toDom=function(b,c){var c=c||a.doc,d=c[I];d||(c[I]=d=++z+"",q[d]=c.createElement("div"));b+="";var e=b.match(D),f=e?e[1].toLowerCase():"",d=q[d];if(e&&v[f]){e=v[f];d.innerHTML=e.pre+b+e.post;for(e=e.length;e;--e)d=d.firstChild}else d.innerHTML=b;if(d.childNodes.length==1)return d.removeChild(d.firstChild);for(f=c.createDocumentFragment();e=d.firstChild;)f.appendChild(e);return f};
dojo.hasClass=function(a,c){return(" "+b(a).className+" ").indexOf(" "+c+" ")>=0};var E=/\s+/,x=[""],u={},H=function(a){if(typeof a=="string"||a instanceof String)return a.indexOf(" ")<0?(x[0]=a,x):a.split(E);return a||""};dojo.addClass=function(a,c){var a=b(a),c=H(c),d=a.className,e,d=d?" "+d+" ":" ";e=d.length;for(var f=0,g=c.length,h;f<g;++f)(h=c[f])&&d.indexOf(" "+h+" ")<0&&(d+=h+" ");e<d.length&&(a.className=d.substr(1,d.length-2))};dojo.removeClass=function(c,d){var c=b(c),e;if(d!==void 0){d=
H(d);e=" "+c.className+" ";for(var f=0,g=d.length;f<g;++f)e=e.replace(" "+d[f]+" "," ");e=a.trim(e)}else e="";c.className!=e&&(c.className=e)};dojo.replaceClass=function(a,c,d){a=b(a);u.className=a.className;dojo.removeClass(u,d);dojo.addClass(u,c);if(a.className!==u.className)a.className=u.className};dojo.toggleClass=function(b,c,d){d===void 0&&(d=!a.hasClass(b,c));a[d?"addClass":"removeClass"](b,c)}})()}dojo._hasResource["dojo._base.NodeList"]||(dojo._hasResource["dojo._base.NodeList"]=!0,dojo.provide("dojo._base.NodeList"),
function(){var a=dojo,b=Array.prototype,c=b.slice,d=b.concat,e=function(b,d,e){b.sort||(b=c.call(b,0));e=e||this._NodeListCtor||a._NodeListCtor;b.constructor=e;dojo._mixin(b,e.prototype);b._NodeListCtor=e;return d?b._stash(d):b},f=function(b,d,e){d=[0].concat(c.call(d,0));e=e||a.global;return function(a){d[0]=a;return b.apply(e,d)}},g=function(a,b){return function(){this.forEach(f(a,arguments,b));return this}},h=function(a,b){return function(){return this.map(f(a,arguments,b))}},i=function(b,c,d){return function(){var e=
arguments,g=f(b,e,d);if(c.call(d||a.global,e))return this.map(g);this.forEach(g);return this}},j=function(a){return a.length==1&&typeof a[0]=="string"},k=function(a){var b=a.parentNode;b&&b.removeChild(a)};dojo.NodeList=function(){return e(Array.apply(null,arguments))};var n=a._NodeListCtor=a.NodeList,m=n.prototype;n._wrap=m._wrap=e;n._adaptAsMap=h;n._adaptAsForEach=g;n._adaptAsFilter=function(a,b){return function(){return this.filter(f(a,arguments,b))}};n._adaptWithCondition=i;a.forEach(["slice",
"splice"],function(a){var c=b[a];m[a]=function(){return this._wrap(c.apply(this,arguments),a=="slice"?this:null)}});a.forEach(["indexOf","lastIndexOf","every","some"],function(b){var d=a[b];m[b]=function(){return d.apply(a,[this].concat(c.call(arguments,0)))}});a.forEach(["attr","style"],function(b){m[b]=i(a[b],j)});a.forEach(["connect","addClass","removeClass","replaceClass","toggleClass","empty","removeAttr"],function(b){m[b]=g(a[b])});dojo.extend(dojo.NodeList,{_normalize:function(a,b){var c=a.parse===
!0?!0:!1;if(typeof a.template=="string")var d=a.templateFunc||dojo.string&&dojo.string.substitute,a=d?d(a.template,a):a;d=typeof a;d=="string"||d=="number"?(a=dojo._toDom(a,b&&b.ownerDocument),a=a.nodeType==11?dojo._toArray(a.childNodes):[a]):dojo.isArrayLike(a)?dojo.isArray(a)||(a=dojo._toArray(a)):a=[a];if(c)a._runParse=!0;return a},_cloneNode:function(a){return a.cloneNode(!0)},_place:function(a,b,c,d){if(!(b.nodeType!=1&&c=="only"))for(var e,f=a.length,g=f-1;g>=0;g--){var h=d?this._cloneNode(a[g]):
a[g];if(a._runParse&&dojo.parser&&dojo.parser.parse){e||(e=b.ownerDocument.createElement("div"));e.appendChild(h);dojo.parser.parse(e);for(h=e.firstChild;e.firstChild;)e.removeChild(e.firstChild)}g==f-1?dojo.place(h,b,c):b.parentNode.insertBefore(h,b);b=h}},_stash:function(a){this._parent=a;return this},end:function(){return this._parent?this._parent:new this._NodeListCtor},concat:function(){var b=a.isArray(this)?this:c.call(this,0),e=a.map(arguments,function(b){return b&&!a.isArray(b)&&(typeof NodeList!=
"undefined"&&b.constructor===NodeList||b.constructor===this._NodeListCtor)?c.call(b,0):b});return this._wrap(d.apply(b,e),this)},map:function(b,c){return this._wrap(a.map(this,b,c),this)},forEach:function(b,c){a.forEach(this,b,c);return this},coords:h(a.coords),position:h(a.position),place:function(b,c){var d=a.query(b)[0];return this.forEach(function(b){a.place(b,d,c)})},orphan:function(b){return(b?a._filterQueryResult(this,b):this).forEach(k)},adopt:function(b,c){return a.query(b).place(this[0],
c)._stash(this)},query:function(b){if(!b)return this;var c=this.map(function(c){return a.query(b,c).filter(function(a){return a!==void 0})});return this._wrap(d.apply([],c),this)},filter:function(b){var c=arguments,d=this,e=0;if(typeof b=="string"){d=a._filterQueryResult(this,c[0]);if(c.length==1)return d._stash(this);e=1}return this._wrap(a.filter(d,c[e],c[e+1]),this)},addContent:function(a,b){for(var a=this._normalize(a,this[0]),c=0,d;d=this[c];c++)this._place(a,d,b,c>0);return this},instantiate:function(b,
c){var d=a.isFunction(b)?b:a.getObject(b),c=c||{};return this.forEach(function(a){new d(c,a)})},at:function(){var b=new this._NodeListCtor;a.forEach(arguments,function(a){a<0&&(a=this.length+a);this[a]&&b.push(this[a])},this);return b._stash(this)}});n.events=["blur","focus","change","click","error","keydown","keypress","keyup","load","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup","submit"];a.forEach(n.events,function(a){var b="on"+a;m[b]=function(a,c){return this.connect(b,
a,c)}})}());dojo._hasResource["dojo._base.query"]||(dojo._hasResource["dojo._base.query"]=!0,function(){var a=function(a){var b=a.trim,e=a.forEach,f=a._NodeListCtor=a.NodeList,g=(a.isWebKit||a.isMozilla)&&a.doc.compatMode=="BackCompat",h=a.doc.firstChild.children?"children":"childNodes",i=!1,j=function(){return!0},k=function(a){a+=">~+".indexOf(a.slice(-1))>=0?" * ":" ";for(var c=function(c,e){return b(a.slice(c,e))},e=[],f=-1,g=-1,h=-1,o=-1,j=-1,n=-1,t=-1,B="",s="",l,p=0,m=a.length,k=null,r=null,
q=function(){if(n>=0)k.id=c(n,p).replace(/\\/g,""),n=-1;if(t>=0){var a=t==p?null:c(t,p);k[">~+".indexOf(a)<0?"tag":"oper"]=a;t=-1}j>=0&&(k.classes.push(c(j+1,p).replace(/\\/g,"")),j=-1)};B=s,s=a.charAt(p),p<m;p++)if(B!="\\")if(k||(l=p,k={query:null,pseudos:[],attrs:[],classes:[],tag:null,oper:null,id:null,getTag:function(){return i?this.otag:this.tag}},t=p),f>=0)if(s=="]"){r.attr?r.matchFor=c(h||f+1,p):r.attr=c(f+1,p);if((f=r.matchFor)&&(f.charAt(0)=='"'||f.charAt(0)=="'"))r.matchFor=f.slice(1,-1);
k.attrs.push(r);r=null;f=h=-1}else{if(s=="=")h="|~^$*".indexOf(B)>=0?B:"",r.type=h+s,r.attr=c(f+1,p-h.length),h=p+1}else if(g>=0){if(s==")"){if(o>=0)r.value=c(g+1,p);o=g=-1}}else if(s=="#")q(),n=p+1;else if(s==".")q(),j=p;else if(s==":")q(),o=p;else if(s=="[")q(),f=p,r={};else if(s=="(")o>=0&&(r={name:c(o+1,p),value:null},k.pseudos.push(r)),g=p;else if(s==" "&&B!=s){q();o>=0&&k.pseudos.push({name:c(o+1,p)});k.loops=k.pseudos.length||k.attrs.length||k.classes.length;k.oquery=k.query=c(l,p);k.otag=
k.tag=k.oper?null:k.tag||"*";if(k.tag)k.tag=k.tag.toUpperCase();if(e.length&&e[e.length-1].oper)k.infixOper=e.pop(),k.query=k.infixOper.query+" "+k.query;e.push(k);k=null}return e},n=function(a,b){if(!a)return b;if(!b)return a;return function(){return a.apply(window,arguments)&&b.apply(window,arguments)}},m=function(a,b){var c=b||[];a&&c.push(a);return c},l=function(a){return 1==a.nodeType},o=function(a,b){if(!a)return"";if(b=="class")return a.className||"";if(b=="for")return a.htmlFor||"";if(b==
"style")return a.style.cssText||"";return(i?a.getAttribute(b):a.getAttribute(b,2))||""},t={"*=":function(a,b){return function(c){return o(c,a).indexOf(b)>=0}},"^=":function(a,b){return function(c){return o(c,a).indexOf(b)==0}},"$=":function(a,b){return function(c){c=" "+o(c,a);return c.lastIndexOf(b)==c.length-b.length}},"~=":function(a,b){var c=" "+b+" ";return function(b){return(" "+o(b,a)+" ").indexOf(c)>=0}},"|=":function(a,b){var c=" "+b+"-";return function(d){d=" "+o(d,a);return d==b||d.indexOf(c)==
0}},"=":function(a,b){return function(c){return o(c,a)==b}}},r=typeof a.doc.firstChild.nextElementSibling=="undefined",p=!r?"nextElementSibling":"nextSibling",B=!r?"previousElementSibling":"previousSibling",s=r?l:j,U=function(a){for(;a=a[B];)if(s(a))return!1;return!0},R=function(a){for(;a=a[p];)if(s(a))return!1;return!0},C=function(a){var b=a.parentNode,c=0,d=b[h],e=a._i||-1,f=b._l||-1;if(!d)return-1;d=d.length;if(f==d&&e>=0&&f>=0)return e;b._l=d;e=-1;for(b=b.firstElementChild||b.firstChild;b;b=b[p])if(s(b))b._i=
++c,a===b&&(e=c);return e},v=function(a){return!(C(a)%2)},D=function(a){return C(a)%2},q={checked:function(){return function(a){return!!("checked"in a?a.checked:a.selected)}},"first-child":function(){return U},"last-child":function(){return R},"only-child":function(){return function(a){if(!U(a))return!1;if(!R(a))return!1;return!0}},empty:function(){return function(a){for(var b=a.childNodes,a=a.childNodes.length-1;a>=0;a--){var c=b[a].nodeType;if(c===1||c==3)return!1}return!0}},contains:function(a,
b){var c=b.charAt(0);if(c=='"'||c=="'")b=b.slice(1,-1);return function(a){return a.innerHTML.indexOf(b)>=0}},not:function(a,b){var c=k(b)[0],d={el:1};if(c.tag!="*")d.tag=1;if(!c.classes.length)d.classes=1;var e=u(c,d);return function(a){return!e(a)}},"nth-child":function(a,b){var c=parseInt;if(b=="odd")return D;else if(b=="even")return v;if(b.indexOf("n")!=-1){var d=b.split("n",2),e=d[0]?d[0]=="-"?-1:c(d[0]):1,f=d[1]?c(d[1]):0,g=0,h=-1;e>0?f<0?f=f%e&&e+f%e:f>0&&(f>=e&&(g=f-f%e),f%=e):e<0&&(e*=-1,
f>0&&(h=f,f%=e));if(e>0)return function(a){a=C(a);return a>=g&&(h<0||a<=h)&&a%e==f};else b=f}var i=c(b);return function(a){return C(a)==i}}},z=a.isIE<9||dojo.isIE&&dojo.isQuirks?function(a){var b=a.toLowerCase();b=="class"&&(a="className");return function(c){return i?c.getAttribute(a):c[a]||c[b]}}:function(a){return function(b){return b&&b.getAttribute&&b.hasAttribute(a)}},u=function(a,b){if(!a)return j;var b=b||{},c=null;"el"in b||(c=n(c,l));"tag"in b||a.tag!="*"&&(c=n(c,function(b){return b&&b.tagName==
a.getTag()}));"classes"in b||e(a.classes,function(a,b){var d=RegExp("(?:^|\\s)"+a+"(?:\\s|$)");c=n(c,function(a){return d.test(a.className)});c.count=b});"pseudos"in b||e(a.pseudos,function(a){var b=a.name;q[b]&&(c=n(c,q[b](b,a.value)))});"attrs"in b||e(a.attrs,function(a){var b,d=a.attr;a.type&&t[a.type]?b=t[a.type](d,a.matchFor):d.length&&(b=z(d));b&&(c=n(c,b))});"id"in b||a.id&&(c=n(c,function(b){return!!b&&b.id==a.id}));c||"default"in b||(c=j);return c},w=function(a){return function(b,c,d){for(;b=
b[p];)if(!r||l(b)){(!d||O(b,d))&&a(b)&&c.push(b);break}return c}},x=function(a){return function(b,c,d){for(b=b[p];b;){if(s(b)){if(d&&!O(b,d))break;a(b)&&c.push(b)}b=b[p]}return c}},J=function(a){a=a||j;return function(b,c,d){for(var e=0,f=b[h];b=f[e++];)s(b)&&(!d||O(b,d))&&a(b,e)&&c.push(b);return c}},H={},M=function(b){var d=H[b.query];if(d)return d;var e=b.infixOper,e=e?e.oper:"",f=u(b,{el:1}),h="*"==b.tag,i=a.doc.getElementsByClassName;if(e){i={el:1};if(h)i.tag=1;f=u(b,i);"+"==e?d=w(f):"~"==e?
d=x(f):">"==e&&(d=J(f))}else if(b.id)f=!b.loops&&h?j:u(b,{el:1,id:1}),d=function(d,e){var g=a.byId(b.id,d.ownerDocument||d);if(g&&f(g))if(9==d.nodeType)return m(g,e);else{for(var h=g.parentNode;h;){if(h==d)break;h=h.parentNode}if(h)return m(g,e)}};else if(i&&/\{\s*\[native code\]\s*\}/.test(String(i))&&b.classes.length&&!g)var f=u(b,{el:1,classes:1,id:1}),o=b.classes.join(" "),d=function(a,b,c){for(var b=m(0,b),d,e=0,g=a.getElementsByClassName(o);d=g[e++];)f(d,a)&&O(d,c)&&b.push(d);return b};else!h&&
!b.loops?d=function(a,c,d){for(var c=m(0,c),e=0,f=a.getElementsByTagName(b.getTag());a=f[e++];)O(a,d)&&c.push(a);return c}:(f=u(b,{el:1,tag:1,id:1}),d=function(a,c,d){for(var c=m(0,c),e,g=0,h=a.getElementsByTagName(b.getTag());e=h[g++];)f(e,a)&&O(e,d)&&c.push(e);return c});return H[b.query]=d},N={},G={},A=function(a){var c=k(b(a));if(c.length==1){var e=M(c[0]);return function(a){if(a=e(a,new f))a.nozip=!0;return a}}return function(a){for(var a=m(a),b,d,e=c.length,f,g,h=0;h<e;h++){g=[];b=c[h];d=a.length-
1;if(d>0)f={},g.nozip=!0;d=M(b);for(var i=0;b=a[i];i++)d(b,g,f);if(!g.length)break;a=g}return g}},K=navigator.userAgent,K=a.isWebKit&&K.indexOf("WebKit/")>0&&parseFloat(K.split("WebKit/")[1])>528,y=a.isIE?"commentStrip":"nozip",F=!!a.doc.querySelectorAll&&(!a.isSafari||a.isSafari>3.1||K),P=/n\+\d|([^ ])?([>~+])([^ =])?/g,S=function(a,b,c,d){return c?(b?b+" ":"")+c+(d?" "+d:""):a},Q=function(b,d){b=b.replace(P,S);if(F){var e=G[b];if(e&&!d)return e}if(e=N[b])return e;var e=b.charAt(0),f=-1==b.indexOf(" ");
b.indexOf("#")>=0&&f&&(d=!0);if(F&&!d&&">~+".indexOf(e)==-1&&(!a.isIE||b.indexOf(":")==-1)&&!(g&&b.indexOf(".")>=0)&&b.indexOf(":contains")==-1&&b.indexOf(":checked")==-1&&b.indexOf("|=")==-1){var h=">~+".indexOf(b.charAt(b.length-1))>=0?b+" *":b;return G[b]=function(a){try{if(!(9==a.nodeType||f))throw"";var c=a.querySelectorAll(h);c[y]=!0;return c}catch(d){return Q(b,!0)(a)}}}else{var i=b.split(/\s*,\s*/);return N[b]=i.length<2?A(b):function(a){for(var b=0,c=[],d;d=i[b++];)c=c.concat(A(d)(a));return c}}},
L=0,T=a.isIE?function(a){return i?a.getAttribute("_uid")||a.setAttribute("_uid",++L)||L:a.uniqueID}:function(a){return a._uid||(a._uid=++L)},O=function(a,b){if(!b)return 1;var c=T(a);if(!b[c])return b[c]=1;return 0},V=function(b){if(b&&b.nozip)return f._wrap?f._wrap(b):b;var d=new f;if(!b||!b.length)return d;b[0]&&d.push(b[0]);if(b.length<2)return d;L++;if(a.isIE&&i){var e=L+"";b[0].setAttribute("_zipIdx",e);for(var g=1,h;h=b[g];g++)b[g].getAttribute("_zipIdx")!=e&&d.push(h),h.setAttribute("_zipIdx",
e)}else if(a.isIE&&b.commentStrip)try{for(g=1;h=b[g];g++)l(h)&&d.push(h)}catch(o){}else{b[0]&&(b[0]._zipIdx=L);for(g=1;h=b[g];g++)b[g]._zipIdx!=L&&d.push(h),h._zipIdx=L}return d};a.query=function(b,d){f=a._NodeListCtor;if(!b)return new f;if(b.constructor==f)return b;if(typeof b!="string")return new f(b);if(typeof d=="string"&&(d=a.byId(d),!d))return new f;var d=d||a.doc,e=d.ownerDocument||d.documentElement;i=d.contentType&&d.contentType=="application/xml"||a.isOpera&&(d.doctype||e.toString()=="[object XMLDocument]")||
!!e&&(a.isIE?e.xml:d.xmlVersion||e.xmlVersion);if((e=Q(b)(d))&&e.nozip&&!f._wrap)return e;return V(e)};a.query.pseudos=q;a._filterQueryResult=function(b,d,e){for(var f=new a._NodeListCtor,g=k(d),g=g.length==1&&!/[^\w#\.]/.test(d)?u(g[0]):function(a){return dojo.query(d,e).indexOf(a)!=-1},h=0,i;i=b[h];h++)g(i)&&f.push(i);return f}},b=function(){acme={trim:function(a){for(var a=a.replace(/^\s+/,""),b=a.length-1;b>=0;b--)if(/\S/.test(a.charAt(b))){a=a.substring(0,b+1);break}return a},forEach:function(a,
b,c){if(a&&a.length)for(var d=0,e=a.length;d<e;++d)b.call(c||window,a[d],d,a)},byId:function(a,b){return typeof a=="string"?(b||document).getElementById(a):a},doc:document,NodeList:Array};var a=navigator,b=a.userAgent,a=a.appVersion,e=parseFloat(a);acme.isOpera=b.indexOf("Opera")>=0?e:void 0;acme.isKhtml=a.indexOf("Konqueror")>=0?e:void 0;acme.isWebKit=parseFloat(b.split("WebKit/")[1])||void 0;acme.isChrome=parseFloat(b.split("Chrome/")[1])||void 0;if((b=Math.max(a.indexOf("WebKit"),a.indexOf("Safari"),
0))&&!acme.isChrome)if(acme.isSafari=parseFloat(a.split("Version/")[1]),!acme.isSafari||parseFloat(a.substr(b+7))<=419.3)acme.isSafari=2;if(document.all&&!acme.isOpera)acme.isIE=parseFloat(a.split("MSIE ")[1])||void 0;Array._wrap=function(a){return a};return acme};this.dojo?(dojo.provide("dojo._base.query"),a(this.queryPortability||this.acme||dojo)):a(this.queryPortability||this.acme||b())}());dojo._hasResource["dojo._base.xhr"]||(dojo._hasResource["dojo._base.xhr"]=!0,dojo.provide("dojo._base.xhr"),
function(){var a=dojo,b=a.config;dojo.fieldToObject=function(b){var c=null;if(b=a.byId(b)){var d=b.name,e=(b.type||"").toLowerCase();if(d&&e&&!b.disabled)if(e=="radio"||e=="checkbox"){if(b.checked)c=b.value}else b.multiple?(c=[],a.query("option",b).forEach(function(a){a.selected&&c.push(a.value)})):c=b.value}return c};dojo.formToObject=function(b){var c={};a.forEach(dojo.byId(b).elements,function(b){var d=b.name,e=(b.type||"").toLowerCase();if(d&&e&&"file|submit|image|reset|button|".indexOf(e)==-1&&
!b.disabled){b=a.fieldToObject(b);if(b!==null){var f=c[d];typeof f=="string"?c[d]=[f,b]:a.isArray(f)?f.push(b):c[d]=b}if(e=="image")c[d+".x"]=c[d+".y"]=c[d].x=c[d].y=0}});return c};dojo.objectToQuery=function(b){var c=encodeURIComponent,d=[],e={},f;for(f in b){var g=b[f];if(g!=e[f]){var h=c(f)+"=";if(a.isArray(g))for(var i=0;i<g.length;i++)d.push(h+c(g[i]));else d.push(h+c(g))}}return d.join("&")};dojo.formToQuery=function(b){return a.objectToQuery(a.formToObject(b))};dojo.formToJson=function(b,c){return a.toJson(a.formToObject(b),
c)};dojo.queryToObject=function(b){var c={},b=b.split("&"),d=decodeURIComponent;a.forEach(b,function(b){if(b.length){var e=b.split("="),b=d(e.shift()),e=d(e.join("="));typeof c[b]=="string"&&(c[b]=[c[b]]);a.isArray(c[b])?c[b].push(e):c[b]=e}});return c};dojo._blockAsync=!1;var c=a._contentHandlers=dojo.contentHandlers={text:function(a){return a.responseText},json:function(b){return a.fromJson(b.responseText||null)},"json-comment-filtered":function(b){dojo.config.useCommentedJson||console.warn("Consider using the standard mimetype:application/json. json-commenting can introduce security issues. To decrease the chances of hijacking, use the standard the 'json' handler and prefix your json with: {}&&\nUse djConfig.useCommentedJson=true to turn off this message.");
var b=b.responseText,c=b.indexOf("/*"),d=b.lastIndexOf("*/");if(c==-1||d==-1)throw Error("JSON was not comment filtered");return a.fromJson(b.substring(c+2,d))},javascript:function(b){return a.eval(b.responseText)},xml:function(b){var c=b.responseXML;if(a.isIE&&(!c||!c.documentElement)){var d=function(a){return"MSXML"+a+".DOMDocument"},d=["Microsoft.XMLDOM",d(6),d(4),d(3),d(2)];a.some(d,function(a){try{var d=new ActiveXObject(a);d.async=!1;d.loadXML(b.responseText);c=d}catch(e){return!1}return!0})}return c},
"json-comment-optional":function(a){return a.responseText&&/^[^{\[]*\/\*/.test(a.responseText)?c["json-comment-filtered"](a):c.json(a)}};dojo._ioSetArgs=function(c,d,e,f){var g={args:c,url:c.url},h=null;if(c.form){var h=a.byId(c.form),i=h.getAttributeNode("action");g.url=g.url||(i?i.value:null);h=a.formToObject(h)}i=[{}];h&&i.push(h);c.content&&i.push(c.content);c.preventCache&&i.push({"dojo.preventCache":(new Date).valueOf()});g.query=a.objectToQuery(a.mixin.apply(null,i));g.handleAs=c.handleAs||
"text";var j=new a.Deferred(d);j.addCallbacks(e,function(a){return f(a,j)});var n=c.load;n&&a.isFunction(n)&&j.addCallback(function(a){return n.call(c,a,g)});var k=c.error;k&&a.isFunction(k)&&j.addErrback(function(a){return k.call(c,a,g)});var l=c.handle;l&&a.isFunction(l)&&j.addBoth(function(a){return l.call(c,a,g)});b.ioPublish&&a.publish&&g.args.ioPublish!==!1&&(j.addCallbacks(function(b){a.publish("/dojo/io/load",[j,b]);return b},function(b){a.publish("/dojo/io/error",[j,b]);return b}),j.addBoth(function(b){a.publish("/dojo/io/done",
[j,b]);return b}));j.ioArgs=g;return j};var d=function(a){a.canceled=!0;var b=a.ioArgs.xhr,c=typeof b.abort;(c=="function"||c=="object"||c=="unknown")&&b.abort();a=a.ioArgs.error;if(!a)a=Error("xhr cancelled"),a.dojoType="cancel";return a},e=function(a){a=c[a.ioArgs.handleAs](a.ioArgs.xhr);return a===void 0?null:a},f=function(a,b){b.ioArgs.args.failOk||console.error(a);return a},g=null,h=[],i=0,j=function(c){i<=0&&(i=0,b.ioPublish&&a.publish&&(!c||c&&c.ioArgs.args.ioPublish!==!1)&&a.publish("/dojo/io/stop"))},
k=function(){var b=(new Date).getTime();if(!a._blockAsync)for(var c=0,d;c<h.length&&(d=h[c]);c++){var e=d.dfd,f=function(){if(!e||e.canceled||!d.validCheck(e))h.splice(c--,1),i-=1;else if(d.ioCheck(e))h.splice(c--,1),d.resHandle(e),i-=1;else if(e.startTime&&e.startTime+(e.ioArgs.args.timeout||0)<b){h.splice(c--,1);var a=Error("timeout exceeded");a.dojoType="timeout";e.errback(a);e.cancel();i-=1}};if(dojo.config.debugAtAllCosts)f.call(this);else try{f.call(this)}catch(n){e.errback(n)}}j(e);h.length||
(clearInterval(g),g=null)};dojo._ioCancelAll=function(){try{a.forEach(h,function(a){try{a.dfd.cancel()}catch(b){}})}catch(b){}};a.isIE&&a.addOnWindowUnload(a._ioCancelAll);a._ioNotifyStart=function(c){b.ioPublish&&a.publish&&c.ioArgs.args.ioPublish!==!1&&(i||a.publish("/dojo/io/start"),i+=1,a.publish("/dojo/io/send",[c]))};a._ioWatch=function(a,b,c,d){var e=a.ioArgs.args;if(e.timeout)a.startTime=(new Date).getTime();h.push({dfd:a,validCheck:b,ioCheck:c,resHandle:d});g||(g=setInterval(k,50));e.sync&&
k()};var n=function(a){return a.ioArgs.xhr.readyState},m=function(a){return 4==a.ioArgs.xhr.readyState},l=function(b){var c=b.ioArgs.xhr;if(a._isDocumentOk(c))b.callback(b);else{var d=Error("Unable to load "+b.ioArgs.url+" status:"+c.status);d.status=c.status;d.responseText=c.responseText;b.errback(d)}};dojo._ioAddQueryToUrl=function(a){if(a.query.length)a.url+=(a.url.indexOf("?")==-1?"?":"&")+a.query,a.query=null};dojo.xhr=function(b,c,g){var h=a._ioSetArgs(c,d,e,f),i=h.ioArgs,j=i.xhr=a._xhrObj(i.args);
if(!j)return h.cancel(),h;"postData"in c?i.query=c.postData:"putData"in c?i.query=c.putData:"rawBody"in c?i.query=c.rawBody:(arguments.length>2&&!g||"POST|PUT".indexOf(b.toUpperCase())==-1)&&a._ioAddQueryToUrl(i);j.open(b,i.url,c.sync!==!0,c.user||void 0,c.password||void 0);if(c.headers)for(var k in c.headers)k.toLowerCase()==="content-type"&&!c.contentType?c.contentType=c.headers[k]:c.headers[k]&&j.setRequestHeader(k,c.headers[k]);j.setRequestHeader("Content-Type",c.contentType||"application/x-www-form-urlencoded");
(!c.headers||!("X-Requested-With"in c.headers))&&j.setRequestHeader("X-Requested-With","XMLHttpRequest");a._ioNotifyStart(h);if(dojo.config.debugAtAllCosts)j.send(i.query);else try{j.send(i.query)}catch(u){i.error=u,h.cancel()}a._ioWatch(h,n,m,l);return h};dojo.xhrGet=function(b){return a.xhr("GET",b)};dojo.rawXhrPost=dojo.xhrPost=function(b){return a.xhr("POST",b,!0)};dojo.rawXhrPut=dojo.xhrPut=function(b){return a.xhr("PUT",b,!0)};dojo.xhrDelete=function(b){return a.xhr("DELETE",b)}}());dojo._hasResource["dojo._base.fx"]||
(dojo._hasResource["dojo._base.fx"]=!0,dojo.provide("dojo._base.fx"),function(){var a=dojo,b=a._mixin;dojo._Line=function(a,b){this.start=a;this.end=b};dojo._Line.prototype.getValue=function(a){return(this.end-this.start)*a+this.start};dojo.Animation=function(c){b(this,c);if(a.isArray(this.curve))this.curve=new a._Line(this.curve[0],this.curve[1])};a._Animation=a.Animation;a.extend(dojo.Animation,{duration:350,repeat:0,rate:20,_percent:0,_startRepeatCount:0,_getStep:function(){var a=this._percent,
b=this.easing;return b?b(a):a},_fire:function(b,c){var d=c||[];if(this[b])if(a.config.debugAtAllCosts)this[b].apply(this,d);else try{this[b].apply(this,d)}catch(e){console.error("exception in animation handler for:",b),console.error(e)}return this},play:function(a,b){this._delayTimer&&this._clearTimer();if(b)this._stopTimer(),this._active=this._paused=!1,this._percent=0;else if(this._active&&!this._paused)return this;this._fire("beforeBegin",[this.node]);var c=a||this.delay,d=dojo.hitch(this,"_play",
b);if(c>0)return this._delayTimer=setTimeout(d,c),this;d();return this},_play:function(){this._delayTimer&&this._clearTimer();this._startTime=(new Date).valueOf();this._paused&&(this._startTime-=this.duration*this._percent);this._active=!0;this._paused=!1;var a=this.curve.getValue(this._getStep());if(!this._percent){if(!this._startRepeatCount)this._startRepeatCount=this.repeat;this._fire("onBegin",[a])}this._fire("onPlay",[a]);this._cycle();return this},pause:function(){this._delayTimer&&this._clearTimer();
this._stopTimer();if(!this._active)return this;this._paused=!0;this._fire("onPause",[this.curve.getValue(this._getStep())]);return this},gotoPercent:function(a,b){this._stopTimer();this._active=this._paused=!0;this._percent=a;b&&this.play();return this},stop:function(a){this._delayTimer&&this._clearTimer();if(!this._timer)return this;this._stopTimer();if(a)this._percent=1;this._fire("onStop",[this.curve.getValue(this._getStep())]);this._active=this._paused=!1;return this},status:function(){if(this._active)return this._paused?
"paused":"playing";return"stopped"},_cycle:function(){if(this._active){var a=((new Date).valueOf()-this._startTime)/this.duration;a>=1&&(a=1);this._percent=a;this.easing&&(a=this.easing(a));this._fire("onAnimate",[this.curve.getValue(a)]);if(this._percent<1)this._startTimer();else{this._active=!1;if(this.repeat>0)this.repeat--,this.play(null,!0);else if(this.repeat==-1)this.play(null,!0);else if(this._startRepeatCount)this.repeat=this._startRepeatCount,this._startRepeatCount=0;this._percent=0;this._fire("onEnd",
[this.node]);!this.repeat&&this._stopTimer()}}return this},_clearTimer:function(){clearTimeout(this._delayTimer);delete this._delayTimer}});var c=0,d=null,e={run:function(){}};a.extend(a.Animation,{_startTimer:function(){if(!this._timer)this._timer=a.connect(e,"run",this,"_cycle"),c++;d||(d=setInterval(a.hitch(e,"run"),this.rate))},_stopTimer:function(){if(this._timer)a.disconnect(this._timer),this._timer=null,c--;c<=0&&(clearInterval(d),d=null,c=0)}});var f=a.isIE?function(b){var c=b.style;if(!c.width.length&&
a.style(b,"width")=="auto")c.width="auto"}:function(){};dojo._fade=function(c){c.node=a.byId(c.node);var d=b({properties:{}},c),c=d.properties.opacity={};c.start=!("start"in d)?function(){return+a.style(d.node,"opacity")||0}:d.start;c.end=d.end;c=a.animateProperty(d);a.connect(c,"beforeBegin",a.partial(f,d.node));return c};dojo.fadeIn=function(c){return a._fade(b({end:1},c))};dojo.fadeOut=function(c){return a._fade(b({end:0},c))};dojo._defaultEasing=function(a){return 0.5+Math.sin((a+1.5)*Math.PI)/
2};var g=function(b){this._properties=b;for(var c in b){var d=b[c];if(d.start instanceof a.Color)d.tempColor=new a.Color}};g.prototype.getValue=function(b){var c={},d;for(d in this._properties){var e=this._properties[d],f=e.start;f instanceof a.Color?c[d]=a.blendColors(f,e.end,b,e.tempColor).toCss():a.isArray(f)||(c[d]=(e.end-f)*b+f+(d!="opacity"?e.units||"px":0))}return c};dojo.animateProperty=function(c){var d=c.node=a.byId(c.node);if(!c.easing)c.easing=a._defaultEasing;c=new a.Animation(c);a.connect(c,
"beforeBegin",c,function(){var c={},e;for(e in this.properties){if(e=="width"||e=="height")this.node.display="block";var f=this.properties[e];a.isFunction(f)&&(f=f(d));f=c[e]=b({},a.isObject(f)?f:{end:f});if(a.isFunction(f.start))f.start=f.start(d);if(a.isFunction(f.end))f.end=f.end(d);var h=e.toLowerCase().indexOf("color")>=0,l=function(b,c){var d={height:b.offsetHeight,width:b.offsetWidth}[c];if(d!==void 0)return d;d=a.style(b,c);return c=="opacity"?+d:h?d:parseFloat(d)};if("end"in f){if(!("start"in
f))f.start=l(d,e)}else f.end=l(d,e);h?(f.start=new a.Color(f.start),f.end=new a.Color(f.end)):f.start=e=="opacity"?+f.start:parseFloat(f.start)}this.curve=new g(c)});a.connect(c,"onAnimate",a.hitch(a,"style",c.node));return c};dojo.anim=function(b,c,d,e,f,g){return a.animateProperty({node:b,duration:d||a.Animation.prototype.duration,properties:c,easing:e,onEnd:f}).play(g||0)}}());if(!dojo._hasResource["dojo.i18n"])dojo._hasResource["dojo.i18n"]=!0,dojo.provide("dojo.i18n"),dojo.getObject("i18n",!0,
dojo),dojo.i18n.getLocalization=dojo.i18n.getLocalization||function(a,b,c){var c=dojo.i18n.normalizeLocale(c),d=c.split("-"),e=[a,"nls",b].join(".");if(e=dojo._loadedModules[e]){for(var f,g=d.length;g>0;g--){var h=d.slice(0,g).join("_");if(e[h]){f=e[h];break}}if(!f)f=e.ROOT;if(f)return a=function(){},a.prototype=f,new a}throw Error("Bundle not found: "+b+" in "+a+" , locale="+c);},dojo.i18n.normalizeLocale=function(a){a=a?a.toLowerCase():dojo.locale;a=="root"&&(a="ROOT");return a},dojo.i18n._requireLocalization=
function(a,b,c,d){var c=dojo.i18n.normalizeLocale(c),e=[a,"nls",b].join("."),f="";if(d){for(var g=d.split(","),h=0;h<g.length;h++)c.indexOf(g[h])==0&&g[h].length>f.length&&(f=g[h]);f||(f="ROOT")}var g=d?f:c,i=dojo._loadedModules[e],h=null;if(i){if(dojo.config.localizationComplete&&i._built)return;h=g.replace(/-/g,"_");h=dojo._loadedModules[e+"."+h]}if(!h){var i=dojo.provide(e),j=dojo._getModuleSymbols(a).concat("nls").join("/"),k;dojo.i18n._searchLocalePath(g,d,function(a){var c=a.replace(/-/g,"_"),
f=e+"."+c,g=!1;dojo._loadedModules[f]?g=!0:(dojo.provide(f),f=[j],a!="ROOT"&&f.push(a),f.push(b),a=f.join("/")+".js",g=dojo._loadPath(a,null,function(a){var a=a.root||a,b=function(){};b.prototype=k;i[c]=new b;for(var d in a)i[c][d]=a[d]}));g&&i[c]?k=i[c]:i[c]=k;if(d)return!0})}d&&c!=f&&(i[c.replace(/-/g,"_")]=i[f.replace(/-/g,"_")])},function(){var a=dojo.config.extraLocale;if(a){!a instanceof Array&&(a=[a]);var b=dojo.i18n._requireLocalization;dojo.i18n._requireLocalization=function(c,d,e,f){b(c,
d,e,f);if(!e)for(e=0;e<a.length;e++)b(c,d,a[e],f)}}}(),dojo.i18n._searchLocalePath=function(a,b,c){for(var a=dojo.i18n.normalizeLocale(a),d=a.split("-"),a=[],e=d.length;e>0;e--)a.push(d.slice(0,e).join("-"));a.push(!1);b&&a.reverse();for(b=a.length-1;b>=0;b--)if(c(a[b]||"ROOT"))break},dojo.i18n._preloadLocalizations=function(a,b){function c(c){c=dojo.i18n.normalizeLocale(c);dojo.i18n._searchLocalePath(c,!0,function(c){for(var d=0;d<b.length;d++)if(b[d]==c)return dojo.require(a+"_"+c),!0;return!1})}
c();for(var d=dojo.config.extraLocale||[],e=0;e<d.length;e++)c(d[e])};dojo._hasResource["dojo._base.browser"]||(dojo._hasResource["dojo._base.browser"]=!0,dojo.provide("dojo._base.browser"),dojo.forEach(dojo.config.require,function(a){dojo.require(a)}));dojo._hasResource["dojo._base"]||(dojo._hasResource["dojo._base"]=!0,dojo.provide("dojo._base"));dojo._hasResource["ws.cache"]||(dojo._hasResource["ws.cache"]=!0,dojo.provide("ws.cache"),dojo.declare("ws.cache",null,{constructor:function(a,b){this.maxSize=
a;this.discardSize=b;this.clear()},clear:function(){this.size=0;this.data={}},add:function(a,b){this.data[a]=b;this.size++},get:function(a){return this.data[a]||null},update:function(a,b,c,d){if(d)for(var e in this.data){if(!d[e]){var f=this.data[e];f&&(f[b]=c)}}else for(d=0;d<a.length;d++)(f=this.data[a[d]])&&(f[b]=c)}}));if(!dojo._hasResource["dojo.window"])dojo._hasResource["dojo.window"]=!0,dojo.provide("dojo.window"),dojo.getObject("window",!0,dojo),dojo.window.getBox=function(){var a=dojo.doc.compatMode==
"BackCompat"?dojo.body():dojo.doc.documentElement,b=dojo._docScroll();return{w:a.clientWidth,h:a.clientHeight,l:b.x,t:b.y}},dojo.window.get=function(a){if(dojo.isIE&&window!==document.parentWindow){a.parentWindow.execScript("document._parentWindow = window;","Javascript");var b=a._parentWindow;a._parentWindow=null;return b}return a.parentWindow||a.defaultView},dojo.window.scrollIntoView=function(a,b){try{var a=dojo.byId(a),c=a.ownerDocument||dojo.doc,d=c.body||dojo.body(),e=c.documentElement||d.parentNode,
f=dojo.isIE,g=dojo.isWebKit;if((!dojo.isMoz&&!f&&!g&&!dojo.isOpera||a==d||a==e)&&typeof a.scrollIntoView!="undefined")a.scrollIntoView(!1);else{var h=c.compatMode=="BackCompat",c=h?d:e,g=g?d:c,i=c.clientWidth,j=c.clientHeight,k=!dojo._isBodyLtr(),n=b||dojo.position(a),m=a.parentNode,c=function(a){return f<=6||f&&h?!1:dojo.style(a,"position").toLowerCase()=="fixed"};if(!c(a))for(;m;){m==d&&(m=g);var l=dojo.position(m),o=c(m);if(m==g){l.w=i;l.h=j;g==e&&f&&k&&(l.x+=g.offsetWidth-l.w);if(l.x<0||!f)l.x=
0;if(l.y<0||!f)l.y=0}else{var t=dojo._getPadBorderExtents(m);l.w-=t.w;l.h-=t.h;l.x+=t.l;l.y+=t.t}if(m!=g){var r=m.clientWidth,p=l.w-r;if(r>0&&p>0)l.w=r,f&&k&&(l.x+=p);r=m.clientHeight;p=l.h-r;if(r>0&&p>0)l.h=r}if(o){if(l.y<0)l.h+=l.y,l.y=0;if(l.x<0)l.w+=l.x,l.x=0;if(l.y+l.h>j)l.h=j-l.y;if(l.x+l.w>i)l.w=i-l.x}var B=n.x-l.x,s=n.y-Math.max(l.y,0),u=B+n.w-l.w,x=s+n.h-l.h;if(u*B>0){var C=Math[B<0?"max":"min"](B,u);n.x+=m.scrollLeft;m.scrollLeft+=f>=8&&!h&&k?-C:C;n.x-=m.scrollLeft}x*s>0&&(n.y+=m.scrollTop,
m.scrollTop+=Math[s<0?"max":"min"](s,x),n.y-=m.scrollTop);m=m!=g&&!o&&m.parentNode}}}catch(v){console.error("scrollIntoView: "+v),a.scrollIntoView(!1)}};if(!dojo._hasResource["dijit._base.window"])dojo._hasResource["dijit._base.window"]=!0,dojo.provide("dijit._base.window"),dijit.getDocumentWindow=function(a){return dojo.window.get(a)};if(!dojo._hasResource["dojo.regexp"])dojo._hasResource["dojo.regexp"]=!0,dojo.provide("dojo.regexp"),dojo.getObject("regexp",!0,dojo),dojo.regexp.escapeString=function(a,
b){return a.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,function(a){if(b&&b.indexOf(a)!=-1)return a;return"\\"+a})},dojo.regexp.buildGroupRE=function(a,b,c){if(!(a instanceof Array))return b(a);for(var d=[],e=0;e<a.length;e++)d.push(b(a[e]));return dojo.regexp.group(d.join("|"),c)},dojo.regexp.group=function(a,b){return"("+(b?"?:":"")+a+")"};if(!dojo._hasResource["dojo.cookie"])dojo._hasResource["dojo.cookie"]=!0,dojo.provide("dojo.cookie"),dojo.cookie=function(a,b,c){var d=document.cookie;if(arguments.length==
1){var e=d.match(RegExp("(?:^|; )"+dojo.regexp.escapeString(a)+"=([^;]*)"));return e?decodeURIComponent(e[1]):void 0}else{c=c||{};d=c.expires;if(typeof d=="number"){var f=new Date;f.setTime(f.getTime()+d*864E5);d=c.expires=f}if(d&&d.toUTCString)c.expires=d.toUTCString();b=encodeURIComponent(b);d=a+"="+b;for(e in c)d+="; "+e,f=c[e],f!==!0&&(d+="="+f);document.cookie=d}},dojo.cookie.isSupported=function(){if(!("cookieEnabled"in navigator))this("__djCookieTest__","CookiesAllowed"),navigator.cookieEnabled=
this("__djCookieTest__")=="CookiesAllowed",navigator.cookieEnabled&&this("__djCookieTest__","",{expires:-1});return navigator.cookieEnabled};if(!dojo._hasResource["dojo.io.iframe"])dojo._hasResource["dojo.io.iframe"]=!0,dojo.provide("dojo.io.iframe"),dojo.getObject("io",!0,dojo),dojo.io.iframe={create:function(a,b,c){if(window[a])return window[a];if(window.frames[a])return window.frames[a];var d=null;c||(dojo.config.useXDomain&&!dojo.config.dojoBlankHtmlUrl&&console.warn("dojo.io.iframe.create: When using cross-domain Dojo builds, please save dojo/resources/blank.html to your domain and set djConfig.dojoBlankHtmlUrl to the path on your domain to blank.html"),
c=dojo.config.dojoBlankHtmlUrl||dojo.moduleUrl("dojo","resources/blank.html"));d=dojo.place('<iframe id="'+a+'" name="'+a+'" src="'+c+'" onload="'+b+'" style="position: absolute; left: 1px; top: 1px; height: 1px; width: 1px; visibility: hidden">',dojo.body());return window[a]=d},setSrc:function(a,b,c){try{if(c){var d;(d=dojo.isIE||dojo.isWebKit?a.contentWindow.document:a.contentWindow)?d.location.replace(b):a.location=b}else dojo.isWebKit?a.location=b:frames[a.name].location=b}catch(e){}},doc:function(a){return a.contentDocument||
a.name&&a.document&&dojo.doc.getElementsByTagName("iframe")[a.name].contentWindow&&dojo.doc.getElementsByTagName("iframe")[a.name].contentWindow.document||a.name&&dojo.doc.frames[a.name]&&dojo.doc.frames[a.name].document||null},send:function(a){if(!this._frame)this._frame=this.create(this._iframeName,dojo._scopeName+".io.iframe._iframeOnload();");a=dojo._ioSetArgs(a,function(a){a.canceled=!0;a.ioArgs._callNext()},function(a){var c=null;try{var d=a.ioArgs,e=dojo.io.iframe,f=e.doc(e._frame),g=d.handleAs,
c=f;if(g!="html")if(g=="xml"){if(dojo.isIE<9||dojo.isIE&&dojo.isQuirks){dojo.query("a",e._frame.contentWindow.document.documentElement).orphan();var h=e._frame.contentWindow.document.documentElement.innerText,h=h.replace(/>\s+</g,"><"),h=dojo.trim(h),c=dojo._contentHandlers.xml({responseText:h})}}else c=f.getElementsByTagName("textarea")[0].value,g=="json"?c=dojo.fromJson(c):g=="javascript"&&(c=dojo.eval(c))}catch(i){c=i}finally{d._callNext()}return c},function(a,c){c.ioArgs._hasError=!0;c.ioArgs._callNext();
return a});a.ioArgs._callNext=function(){if(!this._calledNext)this._calledNext=!0,dojo.io.iframe._currentDfd=null,dojo.io.iframe._fireNextRequest()};this._dfdQueue.push(a);this._fireNextRequest();dojo._ioWatch(a,function(a){return!a.ioArgs._hasError},function(a){return!!a.ioArgs._finished},function(a){a.ioArgs._finished?a.callback(a):a.errback(Error("Invalid dojo.io.iframe request state"))});return a},_currentDfd:null,_dfdQueue:[],_iframeName:dojo._scopeName+"IoIframe",_fireNextRequest:function(){try{if(!(this._currentDfd||
this._dfdQueue.length==0)){do var a=this._currentDfd=this._dfdQueue.shift();while(a&&a.canceled&&this._dfdQueue.length);if(!a||a.canceled)this._currentDfd=null;else{var b=a.ioArgs,c=b.args;b._contentToClean=[];var d=dojo.byId(c.form),e=c.content||{};if(d){if(e){var f=function(a,c){dojo.create("input",{type:"hidden",name:a,value:c},d);b._contentToClean.push(a)},g;for(g in e){var h=e[g];if(dojo.isArray(h)&&h.length>1){var i;for(i=0;i<h.length;i++)f(g,h[i])}else d[g]?d[g].value=h:f(g,h)}}var j=d.getAttributeNode("action"),
k=d.getAttributeNode("method"),n=d.getAttributeNode("target");if(c.url)b._originalAction=j?j.value:null,j?j.value=c.url:d.setAttribute("action",c.url);if(!k||!k.value)k?k.value=c.method?c.method:"post":d.setAttribute("method",c.method?c.method:"post");b._originalTarget=n?n.value:null;n?n.value=this._iframeName:d.setAttribute("target",this._iframeName);d.target=this._iframeName;dojo._ioNotifyStart(a);d.submit()}else f=c.url+(c.url.indexOf("?")>-1?"&":"?")+b.query,dojo._ioNotifyStart(a),this.setSrc(this._frame,
f,!0)}}}catch(m){a.errback(m)}},_iframeOnload:function(){var a=this._currentDfd;if(a){var a=a.ioArgs,b=dojo.byId(a.args.form);if(b){for(var c=a._contentToClean,d=0;d<c.length;d++)for(var e=c[d],f=0;f<b.childNodes.length;f++){var g=b.childNodes[f];if(g.name==e){dojo.destroy(g);break}}a._originalAction&&b.setAttribute("action",a._originalAction);if(a._originalTarget)b.setAttribute("target",a._originalTarget),b.target=a._originalTarget}a._finished=!0}else this._fireNextRequest()}};if(!dojo._hasResource["ws.io"])dojo._hasResource["ws.io"]=
!0,dojo.provide("ws.io"),ws.io={inflightPrevPaneReq:[],rpcHelper:function(a,b){dojo.isArray(a)||(a=[a]);for(var c=0;c<a.length;c++){var d=!0;try{if(a[c].formNode&&typeof a[c].formNode!="undefined"&&ws.io.formHasFile(a[c].formNode)&&dojo.window.get(a[c].formNode.ownerDocument)!=window)dojo.window.get(a[c].formNode.ownerDocument).ws.io.rpc(a[c]);else if(d=!1,ws.io.rpcRequests.push(a[c]),a[c].isPreviewPane){for(var e=0;e<ws.io.inflightPrevPaneReq.length;e++)try{ws.io.inflightPrevPaneReq[e].cancel()}catch(f){}ws.io.inflightPrevPaneReq=
[]}}catch(g){d&&ws.io.rpcRequests.push(a[c])}}setTimeout(dojo.hitch(ws.io,"rpcIssueRequests",b),0)},rpc:function(a){return ws.io.rpcHelper(a,!1)},rpcAnonymous:function(a){return ws.io.rpcHelper(a,!0)},canConsolidate:function(a,b){var c=a.content,d=b.content;return c.messageAction==d.messageAction&&c.folder==d.folder&&c.destFolder==d.destFolder&&c.isSpam==d.isSpam&&c.checkUndo==d.checkUndo&&c.screenName==d.screenName?!0:!1},addToArray:function(a,b){for(var c=0;c<b.length;c++)a.push(b[c]);return a},
addToHashtable:function(a,b){for(var c in b)a[c]==null&&(a[c]=[]),a[c]=this.addToArray(a[c],b[c]);return a},reportRpcError:function(a,b){ws.io.rpc({action:"ReportRpcError",content:{error:a,rpc:b}})},getL7Id:function(){var a="0",b=dojo.cookie("L7Id");b!=null&&(a=b);return a},getUserUid:function(){var a="",b=ws.io.getObjectCookie("Auth");if(b!=null&&b.hasOwnProperty("uid")&&b.uid.length>0)a=b.uid;return a},trackdl:function(a,b){ws.reporting&&ws.reporting.DL&&ws.reporting.DL.append&&ws.reporting.DL.append(a,
b)},rpcIssueRequests:function(a){if(ws.io.rpcRequests&&ws.io.rpcRequests.length!=0){for(var b=[],c=[],d=0;d<ws.io.rpcRequests.length;d++)ws.io.rpcRequests[d].async?c.push(ws.io.rpcRequests[d]):b.push(ws.io.rpcRequests[d]);ws.io.rpcRequests=[];b.length>0&&ws.io.doRpcIssueRequests(b,a,!1);c.length>0&&ws.io.doRpcIssueRequests(c,a,!0)}},doRpcIssueRequests:function(a,b,c){for(var d=ws.io.getUserUid(),e=[],f={},g=null,h=null,i=!0,j=0,j=0;j<a.length;j++)switch(a[j].action){case "GetMessageList":a[j].canConsolidate?
(g&&g.load&&g.load(),g=a[j]):e.push(a[j]);break;case "MessageAction":a[j].content.messageAction=="delete"?i?(h=a[j],f=this.addToHashtable(f,h.content.uids),i=!1):this.canConsolidate(h,a[j])?f=this.addToHashtable(f,a[j].content.uids):e.push(a[j]):e.push(a[j]);break;default:e.push(a[j])}if(h!=null)h.content.uids=f,e.push(h);g!=null&&e.push(g);if(e.length!=0){for(var k=[],a=null,f=!0,g=[],h=[],n=i=0,j=0;j<e.length;j++){if(!e[j].content)e[j].content={};e[j].content.action=e[j].action;n=e[j].content.timeout;
g.push(e[j].action);(e[j].action=="SendMessage"||e[j].action=="SaveMessage")&&e[j].mk&&h.push(e[j].mk);try{for(var m in e[j].content)(typeof e[j].content[m]=="undefined"||e[j].content[m]==null)&&delete e[j].content[m]}catch(l){}k.push(e[j].content);if(e[j].formNode)a=e[j].formNode;e[j].automatic||(f=!1);n&&n>i&&(i=n)}j=null;try{j=dojo.toJson(k)}catch(o){}if(typeof j=="undefined"||j==null)if(window.ws_ErrLgr&&ws_ErrLgr.logError(ws_ErrLgr.cat.AjaxErr,"null or undefined request param from dojo.toJson (requestContents type): "+
typeof k+", file:io.js"),window.JSON&&window.JSON.stringify){j=null;try{j=JSON.stringify(k)}catch(t){}(typeof j=="undefined"||j==null)&&window.ws_ErrLgr&&ws_ErrLgr.logError(ws_ErrLgr.cat.AjaxErr,"null or undefined request param from JSON.stringify, file:io.js")}m=a&&ws.io.formHasFile(a);var b=b?"RPCAnonymous.aspx":c?"ARPC.aspx":"RPC.aspx",k=m?dojo.hitch(dojo.io.iframe,"send"):dojo.hitch(dojo,"xhrPost"),n=m?31E4:18E4,r=window.console&&window.console.firebug;if(ws_ErrLgr&&ws_ErrLgr.config.AllEnabled&&
ws_ErrLgr.config.WinOnErrEnabled){var p;p=g.length==1?g[0]:g.length+":"+g.join("-").substr(0,30);ws_ErrLgr.addRPCtrace(p)}c=k({url:(c?Config.BaseARpcPagesURL:Config.BaseRpcPagesURL)+b+"?user="+d+"&transport="+(m?"iframe":"xmlhttp")+"&r="+Math.random()+"&a="+g.join("-")+(h.length>0?"&m="+h.join("-"):"")+(r?"&firebug=true":"")+"&l="+ws.io.getL7Id(),method:"POST",handleAs:"json",timeout:i>n?i:n,content:{requests:j,automatic:f},form:a,load:function(a){for(var b=0;b<e.length;b++){var c=!1;if(a&&typeof a!=
"xml"&&a[b])if(a[b].isSuccess){if(e[b].load)try{(!e[b].isPreviewPane||e[b].isPreviewPane&&typeof e[b].load=="function")&&e[b].load(a[b])}catch(d){window.ws_ErrLgr&&ws_ErrLgr.logError(ws_ErrLgr.cat.AjaxErr,"Exception:"+d+": in RPC(AJAX) LOAD func(success), action: "+e[b].action||"null, file:io.js")}}else if(a[b].redirectUrl){top.location=a[b].redirectUrl;break}else if(a[b].fatalError){top.location=a[b].errorUrl;break}else if(a[b].needAuthentication){ws.lang.ensureLayersLoaded(function(){ws.widget.Dialogs.ok(a[b].msg,
function(){if(window.gIsAPopupInvocation&&!window.isWindowStandAlone){if(e[b]&&e[b].error&&e[b].action)try{a&&a[b]&&e[b].error(a[b].error?a[b].error:null,!1,"ajax: auth-err-popup")}catch(c){window.ws_ErrLgr&&ws_ErrLgr.logError(ws_ErrLgr.cat.AjaxErr,"Exception in RPC(AJAX) LOAD func(Error handler for no auth), action: "+e[b].action+", file:io.js")}}else top.location=a[b].loginUrl})});break}else if(a[b].isSessionExpired){dojo.publish("WSSessionExpired",[a[b].msg]);break}else c=!0;else c=!0;if(c&&e[b]&&
e[b].error&&e[b].action)try{a&&a[b]?(e[b].error(a[b].error?a[b].error:null,!1,a[b].errCode?a[b].errCode:null),e[b].action!="ReportRpcError"&&a[b].isSuccess&&setTimeout(dojo.hitch(ws.io,"reportRpcError",a[b].error,e[b].action),500)):(e[b].error(null,!0,"ajax: no-data-param",null),window.ws_ErrLgr&&ws_ErrLgr.logError(ws_ErrLgr.cat.AjaxErr,"RPC(AJAX) LOAD func(no data), action: "+e[b].action+", file:io.js"))}catch(f){window.ws_ErrLgr&&ws_ErrLgr.logError(ws_ErrLgr.cat.AjaxErr,"Exception in RPC(AJAX) LOAD func(isError), action: "+
e[b].action+", file:io.js")}}},error:function(a){if(a&&a.dojoType&&a.dojoType=="cancel")for(a=0;a<e.length;a++){if(e[a].cancel){e[a].cancel();try{ws.reporting.DL.removeEvent(e[a].content.uid)}catch(b){}}}else{var c=a&&a.name?a.name+" - ":"";c+=a&&a.message?a.message:"";for(a=0;a<e.length;a++)if(e[a].error)try{e[a].error(Config.Strings.GenericError,!0,"ajax: "+c,null),window.ws_ErrLgr&&ws_ErrLgr.logError(ws_ErrLgr.cat.AjaxErr,"ERROR func(timeout/io err) RPC(AJAX) for action: "+e[a].action+" file:io.js",
c)}catch(d){window.ws_ErrLgr&&ws_ErrLgr.logError(ws_ErrLgr.cat.AjaxErr,"Exception in ERROR func RPC(AJAX) file:io.js",c)}}}});d=!0;for(j=0;j<e.length;j++)if(!e[j].isPreviewPane){d=!1;break}d&&ws.io.inflightPrevPaneReq.push(c)}},rpcRequests:[],formHasFile:function(a){for(var a=a.getElementsByTagName("input"),b=0;b<a.length;b++)if(a[b].getAttribute("type")=="file"&&a[b].value)return!0;return!1},getObjectCookie:function(a){return this._getObjectCookie(a,":")},_getObjectCookie:function(a,b){var c=null,
d=dojo.cookie(a);if(d)for(var c={},d=d.split("&"),e=0;e<d.length;e++){var f=d[e].split(b);if(f.length>1){var g=f[1];isNaN(g)&&(g=unescape(f[1]));c[unescape(f[0])]=g}}return c},_setObjectCookie:function(a,b,c,d,e){var f="",g;for(g in a)f+=(f.length>0?"&":"")+g+"="+a[g];a={};if(c)a.domain=c;if(d)a.path=d;if(e)a.expires=e;dojo.cookie(b,"",a);dojo.cookie(b,f,a)},openWindow:function(a,b,c,d){typeof c=="undefined"&&(c="status=yes,resizable=yes,menubar=yes,scrollbars=yes,location=yes,toolbar=yes");var e=
window.open(a,b,c),b=!1;if(a.indexOf("http")==0&&a.indexOf("http://"+document.domain)!=0)b=e!=null;else try{b=!0}catch(f){}if(!b)return ws.lang.ensureLayersLoaded(function(){ws.widget.Dialogs.ok(Config.Strings.PopupBlocked)}),null;d||(ws.io._childWindows.push(e),dojo.addOnWindowUnload(function(){try{e.onMainWindowClosed()}catch(a){}}));ws.io.openingWindow=!0;setTimeout(function(){ws.io.openingWindow=!1},1E3);return e},closeWindow:function(){if(_ws_isOpenerWS()&&opener.ws&&opener.ws.io&&opener.ws.io._childWindows&&
opener.ws.io._childWindows.length)for(var a=opener.ws.io._childWindows,b=0;b<a.length;b++)if(a[b]==window){a.splice(b,1);break}ws.io.closeWindowInProgress=!0;dojo.isIE?window.location.href=Config.EmptyFileURL+"/../closewindow.htm":window.close()},_childWindows:[],_notifyChildWindowsOfClose:function(){dojo.forEach(ws.io._childWindows,function(a){try{a.onMainWindowClosed()}catch(b){}})},getQueryParameter:function(a,b,c){b=b||null;c=c||document.location.search;a=c.match(RegExp(a+"=([^&]*)"));a!=null&&
(b=a[1])&&(b=decodeURIComponent(b.replace(/\+/g," ")));return b},decodeURIComponentAndEscapeDQuote:function(a){a=decodeURIComponent(a.replace(/\+/g," "));a.indexOf('"')!=-1&&(a=a.replace(/\"/g,'\\"'),a=a.replace(/\\\\\"/g,'\\"'));return a},getJsonFromQueryParams:function(a){var b=null,a=a||document.location.search;if(!a)return null;for(var a=a.replace(/^\?/,"").split("&"),c=0;c<a.length;c++){var d=a[c].split("=");if(d.length==2){b!=null?b+=", ":b="";var e=this.decodeURIComponentAndEscapeDQuote(d[0]),
d=this.decodeURIComponentAndEscapeDQuote(d[1]);b+='"'+e+'":"'+d+'"'}}if(b!=null)return eval("("+("{"+b+"}")+")");return null}};dojo._hasResource["dojo.NodeList-manipulate"]||(dojo._hasResource["dojo.NodeList-manipulate"]=!0,dojo.provide("dojo.NodeList-manipulate"),function(){function a(b){for(var c="",b=b.childNodes,f=0,g;g=b[f];f++)g.nodeType!=8&&(c+=g.nodeType==1?a(g):g.nodeValue);return c}function b(a){for(;a.childNodes[0]&&a.childNodes[0].nodeType==1;)a=a.childNodes[0];return a}function c(a,b){typeof a==
"string"?(a=dojo._toDom(a,b&&b.ownerDocument),a.nodeType==11&&(a=a.childNodes[0])):a.nodeType==1&&a.parentNode&&(a=a.cloneNode(!1));return a}dojo.extend(dojo.NodeList,{_placeMultiple:function(a,b){for(var c=typeof a=="string"||a.nodeType?dojo.query(a):a,g=[],h=0;h<c.length;h++)for(var i=c[h],j=this.length,k=j-1,n;n=this[k];k--)h>0&&(n=this._cloneNode(n),g.unshift(n)),k==j-1?dojo.place(n,i,b):i.parentNode.insertBefore(n,i),i=n;g.length&&(g.unshift(0),g.unshift(this.length-1),Array.prototype.splice.apply(this,
g));return this},innerHTML:function(a){return arguments.length?this.addContent(a,"only"):this[0].innerHTML},text:function(b){if(arguments.length){for(var c=0,f;f=this[c];c++)f.nodeType==1&&(dojo.empty(f),f.appendChild(f.ownerDocument.createTextNode(b)));return this}else{for(var g="",c=0;f=this[c];c++)g+=a(f);return g}},val:function(a){if(arguments.length){for(var b=dojo.isArray(a),c=0,g;g=this[c];c++){var h=g.nodeName.toUpperCase(),i=g.type,j=b?a[c]:a;if(h=="SELECT"){h=g.options;for(i=0;i<h.length;i++){var k=
h[i];k.selected=g.multiple?dojo.indexOf(a,k.value)!=-1:k.value==j}}else i=="checkbox"||i=="radio"?g.checked=g.value==j:g.value=j}return this}else if((g=this[0])&&g.nodeType==1){a=g.value||"";if(g.nodeName.toUpperCase()=="SELECT"&&g.multiple){a=[];h=g.options;for(i=0;i<h.length;i++)k=h[i],k.selected&&a.push(k.value);a.length||(a=null)}return a}},append:function(a){return this.addContent(a,"last")},appendTo:function(a){return this._placeMultiple(a,"last")},prepend:function(a){return this.addContent(a,
"first")},prependTo:function(a){return this._placeMultiple(a,"first")},after:function(a){return this.addContent(a,"after")},insertAfter:function(a){return this._placeMultiple(a,"after")},before:function(a){return this.addContent(a,"before")},insertBefore:function(a){return this._placeMultiple(a,"before")},remove:dojo.NodeList.prototype.orphan,wrap:function(a){if(this[0])for(var a=c(a,this[0]),e=0,f;f=this[e];e++){var g=this._cloneNode(a);f.parentNode&&f.parentNode.replaceChild(g,f);b(g).appendChild(f)}return this},
wrapAll:function(a){if(this[0]){a=c(a,this[0]);this[0].parentNode.replaceChild(a,this[0]);for(var a=b(a),e=0,f;f=this[e];e++)a.appendChild(f)}return this},wrapInner:function(a){if(this[0])for(var a=c(a,this[0]),b=0;b<this.length;b++){var f=this._cloneNode(a);this._wrap(dojo._toArray(this[b].childNodes),null,this._NodeListCtor).wrapAll(f)}return this},replaceWith:function(a){for(var a=this._normalize(a,this[0]),b=0,c;c=this[b];b++)this._place(a,c,"before",b>0),c.parentNode.removeChild(c);return this},
replaceAll:function(a){for(var a=dojo.query(a),b=this._normalize(this,this[0]),c=0,g;g=a[c];c++)this._place(b,g,"before",c>0),g.parentNode.removeChild(g);return this},clone:function(){for(var a=[],b=0;b<this.length;b++)a.push(this._cloneNode(this[b]));return this._wrap(a,this,this._NodeListCtor)}});if(!dojo.NodeList.prototype.html)dojo.NodeList.prototype.html=dojo.NodeList.prototype.innerHTML}());if(!dojo._hasResource["ws.lang"])dojo._hasResource["ws.lang"]=!0,dojo.provide("ws.lang"),ws.lang={shallowCopy:function(a,
b){var c,d;if(a===null)return null;if(ws.lang.isArray(a)){d=[];for(c=0;c<a.length;c++){var e=a[c];typeof e=="undefined"&&(e=null);d[c]=b?ws.lang.shallowCopy(e,b):e}}else if(dojo.isObject(a))for(c in d={},a)typeof d[c]=="undefined"&&(e=a[c],typeof e=="undefined"&&(e=null),d[c]=b?ws.lang.shallowCopy(e,b):e);else d=a;return d},setTimeout:function(a,b){var c=window,d=2;dojo.isFunction(a)||(c=a,a=b,b=arguments[2],d++);dojo.isString(a)&&(a=c[a]);for(var e=[];d<arguments.length;d++)e.push(arguments[d]);
return window.setTimeout(function(){a.apply(c,e)},b)},undefinedOrNull:function(a){if(typeof a=="undefined")return!0;if(a==null)return!0;return!1},trackdl:function(a,b){ws.reporting&&ws.reporting.DL&&ws.reporting.DL.append&&ws.reporting.DL.append(a,b)},isArray:function(a){return a.push&&a.splice&&a.join},isEmptyObject:function(a){for(var b in a)return!1;return!0},getPropCount:function(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b},difference:function(a,b){for(var c=[],d=0;d<a.length;d++)dojo.indexOf(b,
a[d])==-1&&c.push(a[d]);return c},intersection:function(a,b){return dojo.filter(a,function(a){return dojo.indexOf(b,a)!=-1})},findByProp:function(a,b,c){for(var d=0;d<a.length;d++)if(a[d][b]==c)return d;return-1},defer:function(a,b,c,d){this._deferTimeouts[d]&&clearTimeout(this._deferTimeouts[d]);this._deferTimeouts[d]=setTimeout(dojo.hitch(a,b),c)},_deferTimeouts:{},ensureLayersLoadedExtra:function(a,b){if(!window.layersToLoad)window.layersToLoad=["MessageList","dojo3"];if(b&&b.layers)window.layersToLoad=
window.layersToLoad.concat(b.layers);this.ensureLayersLoaded(a)},ensureLayersLoaded:function(a){a&&this.layersLoadedCallbacks.push(a);if(!this.loadingLayers&&ws.WebSuite.deferComplete){this.loadingLayers=!0;if(!window.layersToLoad)window.layersToLoad=["MessageList","dojo3"];if(a=window.layersToLoad.shift())dojo.require("ws.layers."+a),dojo.addOnLoad(dojo.hitch(this,function(){this.loadingLayers=!1;this.ensureLayersLoaded()}));else{this.loadingLayers=!1;a=this.layersLoadedCallbacks;this.layersLoadedCallbacks=
[];for(var b=0;b<a.length;b++)dojo.addOnLoad(a[b])}}},ensureLayersLoadedSoon:function(a){setTimeout(dojo.hitch(this,function(){setTimeout(dojo.hitch(this,"ensureLayersLoaded",a),1E3)}),0)},layersLoadedCallbacks:[],decode:function(a){if(!a)return a;for(var b="",c=0,d=c1=c2=0;c<a.length;)d=a.charCodeAt(c),d<128?(b+=String.fromCharCode(d),c++):d>191&&d<224?(c2=a.charCodeAt(c+1),b+=String.fromCharCode((d&31)<<6|c2&63),c+=2):(c2=a.charCodeAt(c+1),c3=a.charCodeAt(c+2),b+=String.fromCharCode((d&15)<<12|
(c2&63)<<6|c3&63),c+=3);return b},isEmptyArray:function(a){return a&&a.length>0?!1:!0},encode:function(a){for(var a=a.replace(/\r\n/g,"\n"),b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);d<128?b+=String.fromCharCode(d):(d>127&&d<2048?b+=String.fromCharCode(d>>6|192):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128)),b+=String.fromCharCode(d&63|128))}return b},randomArray:function(a){return a.sort(function(){return Math.round(Math.random())-0.5})}};dojo._hasResource["ws.CachedList"]||
(dojo._hasResource["ws.CachedList"]=!0,dojo.provide("ws.CachedList"),dojo.declare("ScreenNameData",null,{constructor:function(a,b,c){this.screenName=a;this.folderName=b;this.MessageCount=c}}),dojo.declare("ws.CachedList",null,{constructor:function(a,b,c){this.screenNames="";this.CacheSize=a?a:Config.ClientSideMaxCache;this.FetchSize=b?b:Config.ClientSideMaxMessageFetch;this.Cache=new ws.cache(this.CacheSize,Config.ClientSideCacheDiscard);this.seenMessages=[];this.isInbox=c;this.TopContactsFirst=!1;
this.Clear()},deferredIndexUpdate:!1,pendingRowUpdates:[],Clear:function(a){a=a||{};a.keepCache||this.Cache.clear();this.Index={};if(!a.keepSort)this.CurrentIndex="received",this.SortDirection="descending";this.IndexDirection=this.SortDirection;if(!a.keepSearch)this.SubSearch=this.SearchIn=this.SearchString=null;this.data=this.foldersCanMoveTo=null;this.requestsInProgress=[];this.indexRequestsInProgress=[];this.seenMessages=[];this.rowCount=0;this.indexLoaded=!1;this.errorState=a.errorState||!1;this.netErrorState=
a.netErrorState||!1;this.errCode=a.errCode||null;this.errorObj=a.errorObj||null;this.deferredIndexUpdate=!1;this.pendingRowUpdates=[];this.Cleared()},Cleared:function(){},FoldersChanged:function(){},IndexUpdated:function(){},RowsUpdated:function(){},LinkedScreenNameDataUpdated:function(){},IsLoading:function(){return!this.indexLoaded},tracklm:function(a){ws.bootstrap&&ws.bootstrap.add&&ws.bootstrap.add("load_mail",a)},trackdl:function(a,b){ws.reporting&&ws.reporting.DL&&ws.reporting.DL.append&&ws.reporting.DL.append(a,
b)},trackall:function(a,b){ws.bootstrap&&ws.bootstrap.add&&ws.bootstrap.add("load_mail",a);ws.reporting&&ws.reporting.DL&&ws.reporting.DL.append&&ws.reporting.DL.append(a,b)},SetFolder:function(a,b,c,d,e,f,g){this.trackall("-CL.SFa");this.folder==a&&this.indexLoaded&&!this.SearchString&&!this.SearchIn&&!b?(this.RefetchIndex({doImport:g}),this.trackall("-CL.SFb")):(this.Clear({keepSort:!0}),this.folder=a,this.screenName=d?d:ws.UserContext.ActiveScreenName,this.SearchString=b,this.SearchIn=c,this.GetData({row:0,
count:this.FetchSize,reqInfo:e,canConsolidate:!f,doImport:g}),this.trackall("-CL.SFz"))},SetSort:function(a,b,c){this.CurrentIndex==a&&this.IndexDirection==b&&!c&&!this.TopContactsFirst?this.IndexUpdated():(this.Clear({keepSearch:!0}),this.SortDirection=b,this.CurrentIndex=a,this.IndexDirection=b,this.GetData({row:0,count:this.FetchSize,canConsolidate:!1,reqIndex:!0}))},SetSearch:function(a,b,c){if(!(a==this.SearchString&&b==this.SearchIn&&!c))this.Clear({keepSort:!0}),this.SearchString=a,this.SearchIn=
b,this.SubSearch=c,a=!1,Config.UseOMS&&Config.CrossFolderSearch&&(a=!0),this.GetData({returnfoldername:a,row:0,count:this.FetchSize,subSearch:c||""})},RefetchIndex:function(a){this.GetData({row:0,count:this.FetchSize,reqIndex:!0,automatic:a&&a.automatic,doImport:a&&a.doImport})},RefetchInfo:function(){this.GetData({automatic:!0,reqIndex:!1,reqRows:!1,reqInfo:!0})},GetUID:function(a){if(this.Cache==null)return null;var b=this.Index[this.CurrentIndex];if(b==null)return null;a=parseInt(a);if(a>=this.rowCount||
a<0)return null;return b.getRow(a)},GetAvailableRowsForUIDs:function(a){if(!a||this.Cache==null)return[];var b=this.Index[this.CurrentIndex];if(b==null)return[];return b.getRowsForUids(a)},GetAllUIDs:function(){var a=this.Index[this.CurrentIndex];if(!a)return null;return a.baseSegment},GetRow:function(a){a=parseInt(a);isNaN(a)&&(a=0);var b=this.Index[this.CurrentIndex];if(this.Cache==null||b==null||a<0||a>=this.rowCount)return null;b=b.getRow(a);if(b!=null){var c=this.Cache.get(b);if(c!=null)return c;
else if(this.IsRequestInProgress(a)!=-1)return null}var c=a-Config.ClientSideBackFetch,d=this.FetchSize,c=c<0?0:c;if(b!=null)return this.GetData({row:c,count:d}),this.Cache.get(b);else{if(this.IsRequestInProgress(a,!0)!=-1)return null;a-=Config.ClientSideBackFetch;this.GetData({row:c,count:d,reqIndex:!0,indexStart:a<0?0:a,indexMax:Config.ClientSideMaxMessageFetch});return null}},UpdateCache:function(a,b,c,d){this.Cache.update(a,b,c,d)},DeleteFromIndex:function(a){dojo.isArray(a)||(a=[a]);for(var b in this.Index)this.Index[b].deleteUids(a);
this.rowCount-=a.length},DeleteAllFromIndex:function(){for(var a in this.Index)this.Index[a].deleteAllUids();this.rowCount=0},GetRowCount:function(){return this.rowCount==null||this.rowCount<0?0:this.rowCount},AddSeenMessage:function(a){a&&dojo.indexOf(this.seenMessages,a)==-1&&this.seenMessages.push(a)},RemoveSeenMessages:function(a){this.seenMessages=ws.lang.difference(this.seenMessages,a)},ClearSeenMessages:function(){this.seenMessages=[]},DeleteSeenMessage:function(a){if(a)for(var b=0;b<a.length;b++){var c=
dojo.indexOf(this.seenMessages,a[b]);c!=-1&&this.seenMessages.splice(c,1)}},IsUidExist:function(a){for(var b in this.Index)if(this.Index[b].isUidExist(a))return!0;return!1},GetData:function(a){this.trackall("-CL.GDa");if(ws.lang.undefinedOrNull(this.folder))this.trackall("-CL.GDb");else{var b=this.CurrentIndex,c="reqIndex"in a?a.reqIndex:this.Index[b]==null,d="reqRows"in a?a.reqRows:!0,e="reqInfo"in a?a.reqInfo:this.isInbox,f="row"in a?a.row:0,g="count"in a?a.count:this.FetchSize,h="indexStart"in
a?a.indexStart:0,i="indexMax"in a?a.indexMax:Config.ClientSideMaxMessageFetch,j="automatic"in a?a.automatic:!1,k="canConsolidate"in a?a.canConsolidate:!0,n="tcs"in a?a.tcs:this.TopContactsFirst,m="returnfoldername"in a?a.returnfoldername:!1,a="doImport"in a?a.doImport:!1,l=Math.random();d&&this.AddRequestInProgress(f,g,l);c&&this.AddRequestInProgress(h,i,l,!0);this.trackall("-CL.GDc");ws.io.rpc({action:"GetMessageList",automatic:j,canConsolidate:k,content:{folder:this.folder,start:f,count:g,indexStart:h,
indexMax:i,index:c,info:e,rows:d,sort:b,tcs:n,sortDir:this.IndexDirection,search:this.SearchString,searchIn:this.SearchIn,subSearch:this.SubSearch||"",seen:this.seenMessages,screenName:this.screenName,returnfoldername:m,"import":a},load:dojo.hitch(this,"ProcessResponse",l),error:dojo.hitch(this,function(a,b,c){this.trackall("-CL.GDd");this.Clear({errorState:!0,errorObj:a,netErrorState:b,errCode:c||a})})});this.trackall("-CL.GDz")}},IsRequestInProgress:function(a,b){for(var c=b?this.indexRequestsInProgress:
this.requestsInProgress,d=0;d<c.length;d++){var e=c[d];if(e.start<=a&&e.end>=a)return d}return-1},AddRequestInProgress:function(a,b,c,d){(d?this.indexRequestsInProgress:this.requestsInProgress).push({start:a,end:a+b-1,tag:c})},EndRequestInProgress:function(a,b){for(var c=b?this.indexRequestsInProgress:this.requestsInProgress,d=0;d<c.length;d++)c[d].tag==a&&c.splice(d,1)},newMailReceived:function(){},ProcessResponse:function(a,b){this.trackall("-CL.PRa");if(b){this.trackall("-CL.PRb");this.Cache.size>
this.Cache.maxSize&&this.Cache.clear();var c=this.CurrentIndex;this.data=b;var d=[],e=[];if(b.fcsupport)ws.CachedList.prototype.fastCountSupport=b.fcsupport;if(b.foldersCanMoveTo)this.foldersCanMoveTo=b.foldersCanMoveTo;b.folders&&this.FoldersChanged(b.folders);if(b.index){if(this.rowCount!=b.totalItems)this.Index={},this.rowCount=b.totalItems;c in this.Index||(this.Index[c]=new ws.CachedList.index);this.Index[c].setData(b.index,b.indexStart);this.indexLoaded=!0}if(b.rows){for(var f=this.Index[this.CurrentIndex],
g=0;g<b.rows.length;g++)b.rows[g]&&(e=b.rows[g][0],c=b.rows[g],this.Cache.add(e,c),d.push(e));e=f.getRowsForUids(d)}d=this.requestsInProgress.length>1;if(!d&&!this.deferredIndexUpdate&&!b.index)this.RowsUpdated(this.pendingRowUpdates),this.RowsUpdated(e);else if(!this.deferredIndexUpdate&&!b.index)this.pendingRowUpdates=this.pendingRowUpdates.concat(e);e=!1;b.index?d?this.deferredIndexUpdate=!0:e=!0:this.deferredIndexUpdate&&!d&&(e=!0);if(e)this.deferredIndexUpdate=!1,this.pendingRowUpdates=[],this.IndexUpdated();
b.hasNewMsg&&this.newMailReceived()}this.EndRequestInProgress(a);this.EndRequestInProgress(a,!0);if(ws.WebSuite&&ws.WebSuite.isRecordTimingData)ws.WebSuite.messageListTimerEnd=new Date;this.trackall("-CL.PRz");return null}}),dojo.declare("ws.CachedList.index",null,{constructor:function(){this.baseSegment=[]},getRow:function(a){return a<this.baseSegment.length?this.baseSegment[a]:null},setData:function(a,b){if(b==0)this.baseSegment=a;else for(var c=b,d=0;d<a.length;c++,d++)this.baseSegment[c]=a[d]},
getRowsForUids:function(a){var b=[],c={};dojo.forEach(this.baseSegment,function(a,b){a&&(c[a]=b)});for(var d=0;d<a.length;d++){var e=c[a[d]];e!=null&&b.push(e)}return b},deleteUids:function(a){for(var b=0;b<a.length;b++){var c=dojo.indexOf(this.baseSegment,a[b]);c!=-1&&this.baseSegment.splice(c,1)}},deleteAllUids:function(){this.baseSegment=[]},isUidExist:function(a){if(dojo.indexOf(this.baseSegment,a)!=-1)return!0;return!1}}));if(!dojo._hasResource["ws.UserContext"])dojo._hasResource["ws.UserContext"]=
!0,dojo.provide("ws.UserContext"),ws.UserContext={isLoaded:!1,init:function(){if(!this.isLoaded&&window.Settings)this.populate(window.Settings),this.isLoaded=!0},populate:function(a){this.UserAddress=a.ActiveUserEmailAddress||"";this.ActiveScreenName=a.ActiveUserScreenName||"";this.UserUID=a.UserUID||"";this.UserName=a.UserName||"";this.UserScreenName=a.UserScreenName||"";this.ParentalControls=a.ParentalControls||"N";this.BID=a.BID||"";this.Brandi=a.Brandi||"";this.AOLCreateDate=a.AOLCreateDate||
"";this.PriceIndex=a.PriceIndex||"";this.ClientVersion=a.ClientVersion||"";this.ConnectionType=a.ConnectionType||"";this.MasterAccountHash=a.MasterAccountHash||"";this.SubAccountHash=a.SubAccountHash||"";this.ScreenNameHash=a.ScreenNameHash||"";this.OmnitureCampaign=a.OmnitureCampaign||"";this.MailboxType=a.MailboxType||"";this.Age=a.Age||"";this.Zip=a.Zip||"";this.UserGender=a.UserGender||"";this.UserFirstName=a.UserFirstName||"";this.UserLastName=a.UserLastName||"";this.Locale=a.Locale||"";this.SessionId=
a.SessionID||""}},ws.UserContext.init();if(!dojo._hasResource["ws.mail.MailModel"])dojo._hasResource["ws.mail.MailModel"]=!0,dojo.provide("ws.mail.MailModel"),dojo.provide("ws.mail.folderName"),dojo.declare("ws.mail.MailModel",null,{inboxStateToken:"-1",nCheckNewMessageCount:0,columns:{UID:0,FromToAddress:1,Description:2,Subject:3,Received:4,Size:5,Attachment:6,Seen:8,Read:9,Draft:11,Answered:12,Flag:13,Official:14,Certified:15,Voicemail:16,TopContactMsg:19,Folder:20,Fragment:21,CID:22,Account:23},
sortIndices:{FromToAddress:"fromToName",Subject:"subject",Attachment:"attachments",Received:"received",Flag:"flagged",Size:"size",Folder:"folder",Account:"account"},sort:function(a,b){if(a in this.sortIndices){if((a=="Flag"||a=="Attachment")&&this.sortIndices[a]!=this.activeCachedList.CurrentIndex)b="descending";a=="Flag"?(this.activeCachedList.SetSort(this.sortIndices[a],b,this.flagsDirty),this.flagsDirty=!1):this.activeCachedList.SetSort(this.sortIndices[a],b);dojo.publish("wsapi/postEvent",["msgSort",
{column:a,dir:b}])}},constructor:function(a){this.checkNewMessagesTimer=null;ws.bootstrap.reset("load_mail");this.tracklm("MM.Ca");this.getInfo();if(a)this.standAloneMailModel=!0;else{this.standAloneMailModel=!1;this.inboxCachedList=new ws.CachedList(Config.ClientSideMaxCache,Config.ClientSideMaxMessageFetch,!0);this.otherCachedList=new ws.CachedList(Config.ClientSideMaxCache,Config.ClientSideMaxMessageFetch,!1);this.activeCachedList=this.inboxCachedList;for(var a=[this.inboxCachedList,this.otherCachedList],
b=0;b<a.length;b++){var c=a[b];dojo.connect(c,"FoldersChanged",this,"_folderListChanged");dojo.connect(c,"Cleared",dojo.hitch(this,"cachedListUpdated",c));dojo.connect(c,"IndexUpdated",dojo.hitch(this,"cachedListUpdated",c));dojo.connect(c,"RowsUpdated",dojo.hitch(this,"changeRows",c))}this.folders=[];this.linkedSNData=[];this.selectedUids={};this.exclUids={};this.filter="all";this.sSubSearch=null;this.identity="default";this.allSelected=this.fetchingNewMail=!1;this.fetchIndexCB=null;this.messageCache=
new ws.cache(10,1);this.setFolder(this.getInboxFolderName(),null,null,null,null,"descending",!0);dojo.subscribe("SettingsChanged/Compose",this,"composeSettingsChanged");dojo.subscribe("WSSessionExpired",this,"onSessionExpired");if(Settings.AutoRefresh)this.checkNewMessagesTimer=setInterval(dojo.hitch(this,"checkNewMessages"),Config.StandardMessagePolling*1E3)}this.sendAddresses=[[ws.UserContext.UserAddress,ws.UserContext.UserAddress]];this._messagesInFlight={};this.tracklm("-MM.Cz")},cachedListUpdated:function(a){if(this.fetchIndexCB)this.fetchIndexCB(),
this.fetchIndexCB=null;else if(a==this.activeCachedList&&(this.modelUpdated(),Config.EnableClientSideMessagePrefetch&&ws.lang.setTimeout(this,"prefetchUnreadMessages",3E3)),this.fetchingNewMail)this.fetchingNewMail=!1,this.newMailReceived();a&&a.errorState&&!ws.bootstrap.lmsent&&!ws.bootstrap.sending&&(this.tracklm("-MM._CLUb"),a=new Date-window._g_ws_loginStartTime,a={opResult:"fail",errType:"api",errCode:this.getErrCode(),sessionID:Settings.SessionID,opTime:a},ws.bootstrap.sendLoadMailReport(a))},
modelUpdated:function(){},changeRow:function(){},onSelectionChange:function(){},newMailReceived:function(){},changeRows:function(a,b){if(a==this.activeCachedList)if(b)for(var c=0;c<b.length;c++)this.changeRow(b[c]);else this.modelUpdated()},isLoading:function(){return this.activeCachedList.IsLoading()&&!this.activeCachedList.errorState},isErrorState:function(){return this.activeCachedList.errorState},isNetErrorState:function(){return this.activeCachedList.netErrorState},getErrorObj:function(){return this.activeCachedList.errorObj},
getErrCode:function(){return this.activeCachedList.errCode},setFolder:function(a,b,c,d,e,f,g,h){this.screenName=ws.UserContext.ActiveScreenName;this.trackall("-MM.SFa");d=a!=this.currentFolder;this.currentFolder=a;this.currentUid=null;this.selectedUids={};this.exclUids={};this.filter="all";this.sSubSearch=null;this.allSelected=!1;this.activeCachedList=a==this.getInboxFolderName()?this.inboxCachedList:this.otherCachedList;this.inboxCachedList.ClearSeenMessages();this.screenName!=ws.UserContext.ActiveScreenName&&
this.activeCachedList.Clear();if(!ws.lang.undefinedOrNull(e)&&!ws.lang.undefinedOrNull(f))this.activeCachedList.Clear(),this.activeCachedList.CurrentIndex=e,this.activeCachedList.SortDirection=f,this.activeCachedList.IndexDirection=f;ws.lang.undefinedOrNull(a);this.activeCachedList.SetFolder(a,b,c,this.screenName,d,g,h);dojo.publish("wsapi/postEvent",["folderView",{folder:a}]);this.trackall("-MM.SFz")},saveDisplayName:function(a,b){if(this.isPrimaryAddrs(a))Settings.FromDisplayName=b,ws.settings.saveSoon({FromDisplayName:b}),
this.updatePrimaryIdentityWithFromDisplayName();else{for(var c=this.getIdentities(),d=null,e=0;e<c.length;e++)a.indexOf(c[e][1])!=-1&&(d=c[e]);d&&(d[2]=b,ws.settings.saveSoon({IdentityDisplayName:d}))}},updatePrimaryIdentityWithFromDisplayName:function(){var a=this.getIdentities();if(a.length)a[0][2]=Settings.FromDisplayName;dojo.publish("friendlyNameUpdated")},isPrimaryAddrs:function(a){for(var b=this.sendAddresses,c=0;c<b.length;c++)if(a.indexOf(b[c][1])!=-1)return b[c][2];return!1},getIdentities:function(){return this.identities||
[]},getIdentityDN:function(a){var b=this.identities;if(b)for(var c=0;c<b.length;c++)if(b[c][1]==a)return b[c][0];return a},getInboxFolderName:function(){return Settings.HasAggregatedAccount?"AllInboxes":!Settings.ViewNewOld?"Inbox":"NewMail"},search:function(a,b){this.trackdl("-MM.Sa","search_mail");this.searchInProgress=a?!0:!1;var c=this.currentFolder;if(Config.UseOMS&&Config.CrossFolderSearch){if(a)ws.WebSuite.currentFolder=this.currentFolder;c=this.getInboxFolderName();this.trackdl("-MM.Sb","search_mail")}b=
b||"alltext";b=="alltext"&&!this.allowAllTextSearch()&&(b="from|subject");this.filter="all";this.setFolder(c,a,b,null,null,"descending",!1);this.trackdl("-MM.Sz","search_mail")},subSearch:function(a){this.searchInProgress=!0;var b=this.activeCachedList.SearchIn,c=this.activeCachedList.SearchString;this.sSubSearch=a;this.selectedUids={};this.exclUids={};this.allSelected=!1;this.currentUid=null;this.activeCachedList.SetSearch(c,b,a)},getSearchString:function(){return this.filter=="all"&&this.activeCachedList&&
this.activeCachedList.SearchString||null},getSearchIn:function(){return this.activeCachedList?this.activeCachedList.SearchIn||null:null},allowAllTextSearch:function(){return Config.ImapSearchEnabled&&(Config.AllowSearchAllTextTrash||this.getCurrentFolder()&&this.getCurrentFolder().type!="Deleted")},setFilter:function(a,b,c){c={all:{searchIn:"subject",search:""},unread:{searchIn:"seen",search:"false"},read:{searchIn:"seen",search:"true"},flagged:{searchIn:"flagged",search:"true"},unflagged:{searchIn:"flagged",
search:"false"},answered:{searchIn:"answered",search:"true"},unanswered:{searchIn:"answered",search:"false"},attachments:{searchIn:"attachments",search:"true"},noattachments:{searchIn:"attachments",search:"false"},tag:{searchIn:"tag",search:c}};this.filter=a;this.identity=b;a=c[a];this.selectedUids={};this.exclUids={};this.allSelected=!1;this.currentUid=null;this.activeCachedList.SetSearch(a.search,a.searchIn)},setArchiveFilter:function(a){a={searchIn:"before",search:a};this.activeCachedList.SetSearch(a.search,
a.searchIn)},sendMessage:function(a){ws.io.rpc({action:"SendMessage",content:a.content,mk:a.mk,formNode:a.formNode,load:dojo.hitch(this,function(b){this.standAloneMailModel||this.refetchFolderIndex(Config.SentItemsFolderName);a.content.AnswerUID&&this.changeMessagesLocal(a.content.AnswerFolder,[a.content.AnswerUID],this.columns.Answered,!0);a.content.DraftMsgFolder&&a.content.DraftMsgUID&&this.removeMessagesLocal(a.content.DraftMsgFolder,[a.content.DraftMsgUID]);a.load&&a.load(b)}),error:a.error})},
preUpdateExistingDraft:function(){},saveMessage:function(a){ws.io.rpc({action:"SaveMessage",content:a.content,mk:a.mk,formNode:a.formNode,load:dojo.hitch(this,function(b){this.standAloneMailModel||this.refetchFolderIndex(Config.DraftsFolderName);if(a.content.DraftMsgFolder&&a.content.DraftMsgUID){if(!this.standAloneMailModel){this.preUpdateExistingDraft(a.content.DraftMsgUID,b.savedMsgUID);var c=this.getFolderCount(Config.DraftsFolderName);this.removeMessagesLocal(a.content.DraftMsgFolder,[a.content.DraftMsgUID]);
var d=this.getFolderCount(Config.DraftsFolderName);c!=d&&this.updateFolderCount(Config.DraftsFolderName,1,!0)}}else this.standAloneMailModel||this.updateFolderCount(Config.DraftsFolderName,1,!0);a.load&&a.load(b)}),error:a.error})},inboxTypeUpdated:function(){},folderListChanged:function(){if(Settings.ViewNewOld){if(this.currentFolder=="Inbox")this.currentFolder=this.getInboxFolderName(),this.inboxTypeUpdated()}else if(this.currentFolder=="NewMail"||this.currentFolder=="OldMail")this.currentFolder=
this.getInboxFolderName(),this.inboxTypeUpdated()},_folderListChanged:function(a){this.trackall("-MM._FLCa");this.folders=[];var b,c;for(c=0;c<a.length;c++)b=new ws.mail.folder(a[c]),this.folders.push(b);if(!ws.bootstrap.lmsent&&!ws.bootstrap.sending){this.trackall("-MM._FLCb");var a=!1,d=this.getInboxFolderName();for(c=0;c<this.folders.length;c++)if(b=this.folders[c],d==b.name){a=!0;break}b=new Date-window._g_ws_loginStartTime;b=a?{opResult:"success",opTime:b}:{opResult:"fail",errType:"api",errCode:this.getErrCode(),
sessionID:Settings.SessionID,opTime:b};ws.bootstrap.sendLoadMailReport(b)}else this.trackall("-MM._FLCc");this.trackall("-MM._FLCf");this.folderListChanged();this.trackall("-MM._FLCz")},getFolderByName:function(a){if(!a)return null;var b;for(b=0;b<this.folders.length;b++)if(this.folders[b].name==a)return this.folders[b];if(a.toLowerCase()=="new mail")a="NewMail";else if(a.toLowerCase()=="old mail")a="OldMail";else return null;for(b=0;b<this.folders.length;b++)if(this.folders[b].name==a)return this.folders[b];
return null},getCurrentFolder:function(){return this.getFolderByName(this.currentFolder)},isInboxNewOld:function(a){a=this.getFolderByName(a||this.currentFolder).type;return a=="Inbox"||a=="NewMail"||a=="OldMail"},getFolderByType:function(a){for(var b=0;b<this.folders.length;b++)if(this.folders[b].type==a)return this.folders[b];return null},createFolder:function(a){var b=Config.NewFolderPrefix+a.newName;if(ws.mail.folderName.validate(a.newName,b,null,this.folders,a.dialogOkCB))a.newName=b,this.folderAction("create",
a)},deleteFolder:function(a){if(a.name==this.currentFolder)a.doNotUpdateFolderList=!0,a.switchToFolder=this.getInboxFolderName();this.folderAction("delete",a)},emptyFolder:function(a){var b=a.load;a.load=dojo.hitch(this,function(c){if(a.name==this.currentFolder)this.activeCachedList.rowCount=0,this.modelUpdated();b&&b(c)});this.folderAction("empty",a)},renameFolder:function(a){var b=Config.NewFolderPrefix+a.newName;if(Config.EnableIMAPFolderHierarchy){var c=this.getFolderByName(a.name);c.depth>1&&
(b=c.parentName+a.newName)}var c=a.name,d=c.lastIndexOf(Config.FolderNameSeparator)+1;d>0&&(c=c.substring(d));d==0&&(c=c.substring(Config.NewFolderPrefix.length));if(ws.mail.folderName.validate(a.newName,b,c,this.folders)){a.newName=b;if(a.name==this.currentFolder||Config.EnableIMAPFolderHierarchy)a.switchToFolder=a.newName;this.folderAction("rename",a)}},getFolderInfo:function(a){this.folderAction("getInfo",a)},folderAction:function(a,b){ws.io.rpc({action:"FolderAction",content:{folderAction:a,folder:b.name,
newName:b.newName,fetchUIDs:b.fetchUIDs?b.fetchUIDs:!1},load:dojo.hitch(this,function(c){if(b.name==this.currentFolder&&a=="rename")this.getCurrentFolder().name=this.currentFolder=b.switchToFolder=c.iName;b.doNotUpdateFolderList||this.activeCachedList.RefetchInfo();b.switchToFolder&&this.setFolder(b.switchToFolder);b.load&&b.load(c)}),error:b.error})},getRowCount:function(){return this.activeCachedList.GetRowCount()},getDatum:function(a,b){if(this.activeCachedList.GetRowCount()==0)return null;var c=
this.activeCachedList.GetRow(a);if(c==null)return null;return c[b]},getUidForRow:function(a){return this.activeCachedList.GetUID(a)},getRowData:function(a){if(this.activeCachedList.GetRowCount()==0)return null;a=this.activeCachedList.GetRow(a);if(a==null)return null;return a},getUidData:function(a){if(!a||this.activeCachedList.GetRowCount()==0)return null;return this.activeCachedList.Cache.get(a)},getOpSize:function(a){var b=0,c=!1;if(this.isAllSelected())b=this.getRowCount()-ws.lang.getPropCount(this.exclUids),
ws.lang.isEmptyObject(this.exclUids)||(c=!0);else if(a)b=a.length;return{opSize:b,havexuids:c}},getTypeName:function(a){return a[this.columns.Seen]&&Config.EnableMsgStatusColumn&&this.getFolderByName(this.currentFolder).type!="OldMail"&&Settings.ViewNewOld?"SEEN":a[this.columns.Official]?"OFFICIAL":a[this.columns.Certified]?"CERTIFIED":a[this.columns.Voicemail]?"VOICEMAIL":a[this.columns.Answered]?"ANSWERED":"NONE"},getBaseSubject:function(a){var b=a,a=a.replace(/^([\(\[\{\<\-\s]*(re|fwd|fw|antwort|aw|wg|wtr|trans\. )[:\)\]\}\>\-\s][\s]*)+/i,
"");b!=a&&b.indexOf("[")==0&&(a=a.replace(/\]$/,""));return a},checkNewMessages:function(){this.nCheckNewMessageCount++;if(ws.WebSuite.isRecordTimingData&&this.nCheckNewMessageCount==2){ws.WebSuite.isRecordTimingData=!1;var a=0;ws.WebSuite.messageListTimerEnd!=0&&ws.WebSuite.messageListTimerStart!=0&&ws.WebSuite.messageListTimerEnd>ws.WebSuite.messageListTimerStart&&(a=ws.WebSuite.messageListTimerEnd-ws.WebSuite.messageListTimerStart);var b=0;ws.WebSuite.messageReadTimerEnd!=0&&ws.WebSuite.messageReadTimerStart!=
0&&ws.WebSuite.messageReadTimerEnd>ws.WebSuite.messageReadTimerStart&&(b=ws.WebSuite.messageReadTimerEnd-ws.WebSuite.messageReadTimerStart);var c=0;ws.WebSuite.todayPageLoaded!=0&&window._g_ws_loginStartTime!=0&&ws.WebSuite.todayPageLoaded>window._g_ws_loginStartTime&&(c=ws.WebSuite.todayPageLoaded-window._g_ws_loginStartTime);ws.WebSuite.userAgent=navigator.userAgent;if(!Number(ws.WebSuite.messageSize))ws.WebSuite.messageSize=0;var d=0;if(ws.WebSuite.todayPageUnloaded==0)ws.WebSuite.todayPageUnloaded=
new Date;c>0&&(d=ws.WebSuite.todayPageUnloaded-ws.WebSuite.todayPageLoaded);var e=0;window._g_ws_loginStartTime!=0&&ws.WebSuite.deferCompletedTime!=0&&(e=ws.WebSuite.deferCompletedTime-window._g_ws_loginStartTime);Number(c)||(c=0);Number(a)||(a=0);Number(b)||(b=0);Number(d)||(d=0);Number(e)||(e=0);ws.io.rpc({action:"PS",automatic:!0,content:{b:ws.WebSuite.userAgent,lt:c,mlt:a,mrt:b,ms:ws.WebSuite.messageSize,pbt:ws.WebSuite.pluginBarRenderTime,tt:d,dct:e},load:dojo.hitch(this,function(){}),error:dojo.hitch(this,
function(){})})}ws.io.rpc({action:"CheckNewMessages",automatic:!0,content:{stateToken:this.inboxStateToken},load:dojo.hitch(this,function(a){if(a.stateToken)this.inboxStateToken=a.stateToken;switch(a.stateChange){case this.stateChangeEnum.SomethingChangedAndNewMail:this.fetchingNewMail=!0;case this.stateChangeEnum.SomethingChanged:this.inboxCachedList.RefetchIndex({automatic:!0});break;case this.stateChangeEnum.SomethingChangedOtherMbox:case this.stateChangeEnum.SomethingChangedInboxOtherMbox:var b=
!1;if(a.folderchanged)for(var a=a.folderchanged,c=0;c<a.length;c++)if(a[c]==this.otherCachedList.folder&&a[c]==this.currentFolder){this.otherCachedList.RefetchIndex({automatic:!0});b=!0;break}b||this.inboxCachedList.RefetchIndex({automatic:!0})}}),error:dojo.hitch(this,function(){})});Config&&Config.EnableClientSideHiddenPrefBuffer&&!(this.nCheckNewMessageCount%Config.SavePrefBuffEveryNTimesChkNewMsg)&&ws.settings&&ws.settings.savePending&&ws.settings.savePending()},stateChangeEnum:{NothingChanged:1,
SomethingChanged:2,SomethingChangedAndNewMail:3,NewMail:4,SomethingChangedOtherMbox:5,SomethingChangedInboxOtherMbox:6},onSessionExpired:function(){this.checkNewMessagesTimer!=null&&clearInterval(this.checkNewMessagesTimer)},refetchFolderIndex:function(a){a==this.getInboxFolderName()?this.inboxCachedList.RefetchIndex():a==this.otherCachedList.folder&&this.otherCachedList.RefetchIndex()},resetCachedLists:function(a){this.standAloneMailModel||(this.inboxCachedList.Clear({keepSort:!0}),this.otherCachedList.Clear({keepSort:!0}),
a?this.activeCachedList.GetData({reqRows:!0,tcs:!0}):this.activeCachedList.GetData({reqRows:!0}))},fetchIndexForSel:function(a,b,c){a+b<this.activeCachedList.FetchSize?c():(this.activeCachedList.GetData({reqRows:!1,reqInfo:!1,reqIndex:!0,indexStart:a,indexMax:b}),this.fetchIndexCB=c)},groupByTopContacts:function(a){this.inboxCachedList.TopContactsFirst=a?a:!1;this.otherCachedList.TopContactsFirst=a?a:!1;this.resetCachedLists(a)},checkMessageReadState:function(a,b){var c=this.getCachedListForFolder(b.folder),
c=(c=c&&c.Cache.get(b.uid))&&!(c[this.columns.Read]&&c[this.columns.Seen]);a&&c?this.changeMessagesReadState({uids:[b.uid],read:!0,xaolRead:!0,preserveInList:!0}):(Settings.HasAggregatedAccount||this.changeMessagesReadStateLocal(!0,null,b.folder,[b.uid]),this.changeMessagesSeenStateLocal(!0,null,b.folder,[b.uid]));c&&this.updateAggCounts(b.folder,[b.uid],this.columns.Seen,!0)},tracklm:function(a){ws.bootstrap&&ws.bootstrap.add&&ws.bootstrap.add("load_mail",a)},trackdl:function(a,b){ws.reporting&&
ws.reporting.DL&&ws.reporting.DL.append&&ws.reporting.DL.append(a,b)},trackall:function(a){ws.bootstrap&&ws.bootstrap.add&&ws.bootstrap.add("load_mail",a);ws.reporting&&ws.reporting.DL&&ws.reporting.DL.append&&ws.reporting.DL.append(a)},getMessage:function(a){var b=a.uid;this.trackdl("-MM.GMa",b);var c=a.folder+a.uid,d=this.messageCache.get(c),e=this.getFolderByName(a.folder),f=dojo.mixin({},a);if(!a.peek)e&&(e.type=="NewMail"&&this.inboxCachedList.AddSeenMessage(a.uid),e.type!="Drafts"&&setTimeout(dojo.hitch(this,
"checkMessageReadState",d,f),0)),this.cacheSuccess=d?"hit":"miss";if(d){a.load&&a.load(d);if(ws.WebSuite.isRecordTimingData)ws.WebSuite.messageSize=d.body.length,ws.WebSuite.messageReadTimerEnd=new Date;this.trackdl("-MM.GMb",b)}else{d=a.folder;e&&e.type=="AllInboxes"&&(d=this.getUidData(a.uid),e=this.getIdentities(),d=d[this.columns.Account],d=d==0?"Inbox":e[d][1]);var g=this._messagesInFlight[c],e=!!g;g||(g=this._messagesInFlight[c]=[]);g.push({load:f.load,error:f.error});if(e)this.trackdl("-MM.GMc",
b);else{this.trackdl("-MM.GMd",b);e={action:"GetMessage",content:{folder:d,uid:a.uid,peek:a.peek},load:dojo.hitch(this,function(a){if(g&&g.length)for(var b=0;b<g.length;b++)try{var d=g[b];d.load&&d.load(a)}catch(e){}delete this._messagesInFlight[c];if(ws.WebSuite.isRecordTimingData)ws.WebSuite.messageSize=a.body.length,ws.WebSuite.messageReadTimerEnd=new Date;this.messageCache.add(f.folder+f.uid,a);this.trackdl("-MM.GMe",f.uid)}),error:dojo.hitch(this,function(a,b,d){if(g&&g.length)for(var e=0;e<
g.length;e++)try{var n=g[e];n.error&&n.error(a,b,d)}catch(m){}delete this._messagesInFlight[c];this.trackdl("-MM.GMf",f.uid)}),cancel:dojo.hitch(this,function(){this.trackdl("-MM.GMh",f.uid);delete this._messagesInFlight[c]})};if(a.isPreviewPane)e.isPreviewPane=a.isPreviewPane;(typeof e.content.uid=="undefined"||e.content.uid==null)&&window.ws_ErrLgr&&ws_ErrLgr.logError(ws_ErrLgr.cat.ProgErr,"GetMessage RPC has null or undefined uid param: file:MailModel.js");this.trackdl("-MM.GMg",b);ws.io.rpc(e);
this.trackdl("-MM.GMz",b)}}},prefetchAdjacentMessages:function(a){Config.EnableClientSideMessagePrefetch&&(a=this.activeCachedList.GetAvailableRowsForUIDs([a])[0],typeof a!="undefined"&&(this._prefetchRow(a+1),this._prefetchRow(a-1)))},prefetchUnreadMessages:function(){if(Config.EnableClientSideMessagePrefetch)for(var a=Math.min(this.getRowCount(),30),b=0,c=0;c<a&&b<4;c++)this.getDatum(c,this.columns.Read)||(this._prefetchRow(c),b++)},_prefetchRow:function(a){var b=this.activeCachedList.GetUID(a);
b&&(a=this.getDatum(a,this.columns.Size))&&a<1E5&&this.getMessage({folder:this.currentFolder,uid:b,peek:!0})},getMessageStatus:function(a){ws.io.rpc({action:"GetMessageStatus",content:{screenName:this.screenName,folder:a.folder,uids:a.uids},load:a.load,error:a.error})},getAdjacentMessageUid:function(a,b){var c=this.activeCachedList.GetAvailableRowsForUIDs([a]);if(c.length<1)return null;return this.activeCachedList.GetUID(c[0]+b)},makeUidList:function(a,b){var c={};if(a)for(var d=0;d<a.length;d++){var e=
b,f=this.getUidData(a[d]);f&&(f[this.columns.Folder]?e=f[this.columns.Folder]:e=="AllInboxes"&&(e=this.getIdentities(),f=f[this.columns.Account],e=f==0?"Inbox":e[f][1]));c[e]==null&&(c[e]=[]);c[e].push(a[d])}return c},messageAction:function(a){if(typeof a.folder=="undefined")a.folder=this.currentFolder;if(typeof a.checkUndo=="undefined")a.checkUndo=!1;if(typeof a.isUndoAction=="undefined")a.isUndoAction=!1;var b=this.getSearchString()!=null;if(!a.hasOwnProperty("isAllSel")&&ws.lang.isEmptyArray(a.uids))a.isAllSel=
b?!1:this.isAllSelected();a.xuids=this.getSelectedXUids();var c={},d={};a.isUndoAction?c=a.uids:a.isAllSel?d=this.makeUidList(a.xuids,a.folder):c=this.makeUidList(a.uids,a.folder);ws.io.rpc({action:"MessageAction",content:{messageAction:a.action,folder:a.folder,uids:c,xuids:d,destFolder:a.destFolder,isSpam:a.isSpam,checkUndo:a.checkUndo,screenName:this.screenName,reason:a.reason,isAllSelected:a.isAllSel,isUndoAction:a.isUndoAction,isSearchAction:b},load:dojo.hitch(this,function(b){this.deselectAll(!0);
Config.UseOMS&&this.activeCachedList.SearchString&&this.inboxCachedList.RefetchIndex();a.load&&a.load(b)}),error:a.error})},flagMessages:function(a){a.action=a.flag?"flagged":"unflagged";this.messageAction(a);this.changeMessagesLocal(a.folder,a.uids,this.columns.Flag,a.flag);var b=a.folder||this.currentFolder;this.messageCache.update(dojo.map(a.uids,function(a){return b+a}),"isFlagged",a.flag);this.flagsDirty=!0;a.fromDisplayMessage||dojo.publish("MessageList/flagMessage",[a.folder,a.uids,a.flag])},
changeMessagesReadState:function(a){a.action=a.xaolRead?"read":a.read?"seen":"unseen";this.messageAction(a);this.updateAggCounts(a.folder,a.uids,this.columns.Seen,a.action=="seen");this.allSelected&&this.fetchNewMsgCount();var b=this.getCurrentFolder().type;a.read&&!a.preserveInList&&Config.EnableMoveForMarkSeen&&b=="NewMail"?(this.removeMessagesLocal(a.folder,a.uids),this.updateFolderCount("OldMail",a.uids.length,!0),this.updateUnseenCount("OldMail",a.uids,!0,!0)):!a.read&&!a.preserveInList&&(Config.EnableMoveForMarkUnseen||
Settings.ViewNewOld)&&b=="OldMail"?(this.removeMessagesLocal(a.folder,a.uids,this.allSelected),this.updateFolderCount("NewMail",a.uids.length,!0),this.updateUnseenCount("NewMail",a.uids,!0,!0),this.refetchFolderIndex("NewMail")):(a.xaolRead&&!Settings.HasAggregatedAccount&&this.changeMessagesReadStateLocal(!0,a.msgInfos,a.folder,a.uids),this.changeMessagesSeenStateLocal(a.read,a.msgInfos,a.folder,a.uids))},canChangeMessageReadState:function(a){return Config.EnableMarkOutsideInbox||this.isInboxNewOld(a)},
deleteMessages:function(a){a.action="delete";this.messageAction(a);this.removeMessagesLocal(a.folder,a.uids,a.isAllSel);a.skipRefetchCounts||this.fetchNewMsgCount();if(this.isInboxNewOld(this.activeCachedList.folder)&&this.otherCachedList.folder==Config.DeletedItemsFolderName)this.otherCachedList.Clear(),this.otherCachedList.folder="undefined";a.folder!=Config.DeletedItemsFolderName&&this.refetchFolderIndex(Config.DeletedItemsFolderName)},restoreMessages:function(a){a.action="restore";this.messageAction(a);
this.removeMessagesLocal(a.folder,a.uids);this.fetchNewMsgCount()},moveMessages:function(a){a.action="move";this.messageAction(a);this.removeMessagesLocal(a.folder,a.uids,a.isAllSel);a.skipRefetchCounts||this.fetchNewMsgCount();(!Config.UseOMS||!Config.CrossFolderSearch||!this.getSearchString()||a.isUndoAction)&&this.refetchFolderIndex(a.destFolder)},undoMoveMessages:function(a,b,c){var d=null;if(b==Config.DeletedItemsFolderName){var e=0,f;for(f in a)a.hasOwnProperty(f)&&(e+=a[f].length);d=e==1?Config.Strings.MessageRestored:
ws.string.substituteParams(Config.Strings.MessagesRestored,e)}this.moveMessages({uids:a,folder:b,destFolder:c?c:this.currentFolder,checkUndo:!1,isUndoAction:!0,load:function(){d&&dojo.publish("WSFeedbackStart",[d,!0])},error:function(a){window.ws_ErrLgr&&!a&&ws_ErrLgr.logError(ws_ErrLgr.cat.UserVisErr,"OkCancelDialog.alert shown - Error Handler for moveMessages-undoMoveMessages file:MailModel.js");ws.widget.OkCancelDialog.alert(a||Config.Strings.MoveMessageError)}})},undoRestoreMessages:function(a){this.restoreMessages({uids:a,
folder:Config.DeletedItemsFolderName,checkUndo:!1,isUndoAction:!0,load:dojo.hitch(this,function(){this.refetchFolderIndex(this.currentFolder);var b=a.length==1?Config.Strings.MessageRestored:ws.string.substituteParams(Config.Strings.MessagesRestored,a.length);dojo.publish("WSFeedbackStart",[b,!0])}),error:function(a){window.ws_ErrLgr&&!a&&ws_ErrLgr.logError(ws_ErrLgr.cat.UserVisErr,"Dialogs.ok shown - Error Handler for model.restoreMessages-restoreMessages file:MessageListView.js");ws.widget.Dialogs.ok(a||
Config.Strings.ErrorRestoring)}})},undoReportSpamMessages:function(a){this.reportSpamMessages({uids:a,folder:Config.SpamFolderName,destFolder:this.currentFolder,checkUndo:!1,isUndoAction:!0,load:function(){},error:function(a){window.ws_ErrLgr&&!a&&ws_ErrLgr.logError(ws_ErrLgr.cat.UserVisErr,"OkCancelDialog.alert shown - Error Handler for reportSpamMessages-undoReportSpamMessages file:MailModel.js");ws.widget.OkCancelDialog.alert(a||Config.Strings.ReportSpamError)}})},fetchNewMsgCount:function(){this.activeCachedList.fastCountSupport&&
this.activeCachedList.RefetchInfo()},getFoldersCanMoveTo:function(){return this.activeCachedList.foldersCanMoveTo||[]},getFoldersCanMoveToFromInbox:function(){return this.inboxCachedList.foldersCanMoveTo||[]},reportSpamMessages:function(a){a.action="reportSpam";this.messageAction(a);this.removeMessagesLocal(a.folder,a.uids,a.isAllSel);a.skipRefetchCounts||this.fetchNewMsgCount();if(this.isInboxNewOld(this.activeCachedList.folder)&&this.otherCachedList.folder==Config.SpamFolderName)this.otherCachedList.Clear(),
this.otherCachedList.folder="undefined";dojo.publish("wsapi/postEvent",["markSpam",{msgId:a.uids,folder:a.folder}]);this.refetchFolderIndex(a.isSpam?Config.SpamFolderName:this.getInboxFolderName())},forwardMessages:function(a){a.action="forward";var b=function(){};this.messageAction(a);if(!a.load)a.load=b;if(!a.error)a.error=b},composeSettingsChanged:function(){this.messageCache.clear()},getSignature:function(a){var b="";if(Settings.SignatureEnabled){b=Settings.Signature;if(b.search(/<[^>]*>/gi)==
-1){if(dojo.isWebKit||dojo.isFF)b=b.replace(/\r/g,"");b=b.replace(/\n/g,"<br/>")}Settings.AddPresenceSignature&&this.signatureAimPresence&&a&&(b=ws.string.substituteParams(this.signatureAimPresence,b))}return b},getAcctType:function(a){if(a)for(var b=this.getIdentities(),c=0;c<b.length;c++)if(a.toLowerCase()==b[c][1])return b[c][3];return"aol"},getInfo:function(){this.tracklm("-MM.GIa");ws.io.rpc({action:"GetMailInfo",load:dojo.hitch(this,function(a){this.tracklm("-MM.GIb");this.sendAddresses=a.sendAddresses;
this.signatureAimPresence=a.signatureAimPresence;window.Settings.MailStorageQuota=a.storageQuota;window.Settings.MailStorageUsed=a.storageUsed;window.Settings.HasUnlimitedMailStorage=a.hasUnlimitedStorage;if(a.identities)this.identities=a.identities;this.infoUpdated();try{if(a.sendAddresses[0][1]){var b=dojo.byId("aoluid");b||(b=dojo.create("div",{id:"aoluid",style:{display:"none"}},dojo.body()));b.innerHTML=a.sendAddresses[0][1]}}catch(c){}}),error:function(a){this.tracklm("-MM.GIc");window.ws_ErrLgr&&
!a&&ws_ErrLgr.logError(ws_ErrLgr.cat.ProgErr,"Error Handler for GetMailInfo-getInfo file:MailModel.js")}});this.tracklm("-MM.GIz")},infoUpdated:function(){},isCurrentRow:function(a){return(a=this.activeCachedList.GetUID(a))&&a==this.currentUid},getCurrentRow:function(){var a=this.activeCachedList.GetAvailableRowsForUIDs([this.currentUid]);return a.length==1?a[0]:-1},setCurrentRow:function(a){this.setCurrentUid(this.activeCachedList.GetUID(a))},setCurrentUid:function(a){var b=this.activeCachedList.GetAvailableRowsForUIDs([a,
this.currentUid]);this.currentUid=a;for(a=0;a<b.length;a++)this.changeRow(b[a])},toggleSelectRow:function(a,b){var c=this.activeCachedList.GetUID(a);if(c!=null){var d=typeof b=="undefined"?!this.isSelected(c):b;this.allSelected?d?delete this.exclUids[c]:this.exclUids[c]=!0:d?this.selectedUids[c]=!0:delete this.selectedUids[c];if(this.activeCachedList.SearchString==null)if(this.getRowCount()==ws.lang.getPropCount(this.selectedUids))this.allSelected=!0,this.selectedUids={};else if(this.allSelected&&
this.getRowCount()==ws.lang.getPropCount(this.exclUids))this.allSelected=!1,this.exclUids={};this.changeRow(a);this.onSelectionChange()}},selectRange:function(a,b,c,d){var e=1+b-a;e==this.getRowCount()?(this.selectAll(),d&&d()):this.fetchIndexForSel(a,e,dojo.hitch(this,function(){for(var e=a;e<=b;e++)this.toggleSelectRow(e,c);d&&d()}))},selectAll:function(){if(this.activeCachedList.SearchString!=null)if(this.getRowCount()>this.activeCachedList.FetchSize)this.fetchIndexForSel(0,this.getRowCount(),
dojo.hitch(this,function(){for(var a,c=0;c<this.getRowCount();c++)(a=this.activeCachedList.GetUID(c))&&(this.selectedUids[a]=!0);this.modelUpdated()}));else for(var a=0;a<this.getRowCount();a++)this.toggleSelectRow(a,"ON");else this.allSelected=!0,this.currentUid=null,this.selectedUids={},this.exclUids={},this.modelUpdated()},deselectAll:function(a){var b=this.allSelected;this.allSelected=!1;if(!a)this.currentUid=null;a=this.getSelectedUids();this.selectedUids={};this.exclUids={};if(b||a.length>10)this.modelUpdated();
else{b=this.activeCachedList.GetAvailableRowsForUIDs(a);for(a=0;a<b.length;a++)this.changeRow(b[a]);this.onSelectionChange()}},isAllInViewSelected:function(){return this.activeCachedList.SearchString!=null?this.getRowCount()==ws.lang.getPropCount(this.selectedUids):this.isAllSelReal()},isAllSelected:function(){return this.allSelected},isAnySelected:function(){return!ws.lang.isEmptyObject(this.selectedUids)||this.allSelected},isAllSelReal:function(){return this.allSelected&&ws.lang.isEmptyObject(this.exclUids)},
isSelected:function(a){return this.allSelected?!(a in this.exclUids):a in this.selectedUids},getSelectedUids:function(){var a=[],b;for(b in this.selectedUids)a.push(b);return a},getSelectedXUids:function(){var a=[],b;for(b in this.exclUids)a.push(b);return a},changeMessagesLocal:function(a,b,c,d){var e=this.getCachedListForFolder(a);if(e){var f=this.allSelected&&ws.lang.isEmptyArray(b)?this.exclUids:null;e.UpdateCache(b,c,d,f);if(f)this.modelUpdated();else{var g=e.GetAvailableRowsForUIDs(b);this.changeRows(e,
g)}a=this.getFolderByName(a);Settings.HasAggregatedAccount&&a&&(a.type=="Aggregated"||a.type=="Inbox")&&this.getCachedListForFolder("AllInboxes").UpdateCache(b,c,d,f)}},updateAggCounts:function(a,b,c,d){var e=this.getFolderByName(a);if(e&&e.type=="AllInboxes"&&c==this.columns.Seen)if(this.allSelected)this.fetchNewMsgCount();else{var a=this.getAggFolderCounts(this.getCachedListForFolder(a).GetAvailableRowsForUIDs(b)),f;for(f in a)(b=this.getFolderByName(f))&&(b.unseenCount+=(d?-1:1)*a[f]);this.folderListChanged()}},
getAggFolderCounts:function(a){for(var b,c={},d=0;d<a.length;d++)if(b=this.activeCachedList.GetRow(a[d]))b=b[this.columns.Account],b=b==0?"Inbox":this.identities[b][1],c[b]?c[b]++:c[b]=1;return c},changeMessagesReadStateLocal:function(a,b,c,d){this._changeMessagesReadStateLocal(a,b,c,d);Settings.ViewNewOld||this._changeMessagesSeenStateLocal(a,b,c,d)},changeMessagesSeenStateLocal:function(a,b,c,d){this._changeMessagesSeenStateLocal(a,b,c,d);Settings.ViewNewOld||this._changeMessagesReadStateLocal(a,
b,c,d)},_changeMessagesReadStateLocal:function(a,b,c,d){this.changeMessagesLocal(c,d,this.columns.Read,a);b&&dojo.forEach(b,function(b){b.isRead=a})},_changeMessagesSeenStateLocal:function(a,b,c,d){this.updateUnseenCount(c,d,!a);this.changeMessagesLocal(c,d,this.columns.Seen,a);b&&dojo.forEach(b,function(b){b.isSeen=a})},checkMessageLocal:function(a,b){var c=this.getCachedListForFolder(a);if(!c)return!1;return c.IsUidExist(b)},removeMessagesLocal:function(a,b,c){var d=this.getCachedListForFolder(a);
if(d){if(c){d.Clear({keepSort:!0});this.setFolder(a,null,null,null,null,"descending",!0);if(c=this.getFolderByName(a))c.count=0,c.unseenCount=0;this.folderListChanged();d.DeleteAllFromIndex();d.ClearSeenMessages()}else this.updateUnseenCount(a,b,!1),this.updateFolderCount(a,b.length,!1),d.DeleteFromIndex(b),d.RemoveSeenMessages(b);if(typeof a=="undefined"||a==this.currentFolder)this.currentUid&&dojo.indexOf(b,this.currentUid)!=-1&&this.setCurrentUid(null),dojo.forEach(b,function(a){a in this.selectedUids&&
delete this.selectedUids[a]},this),this.modelUpdated();this.getFolderByName(a).type=="NewMail"&&this.inboxCachedList.DeleteSeenMessage(b)}},updateFolderCount:function(a,b,c){Config.ShowFolderMessageCount&&(a=this.getFolderByName(a),c?a.count+=b:a.count-=b,this.folderListChanged())},getFolderCount:function(a){if(!Config.ShowFolderMessageCount)return-1;return this.getFolderByName(a).count},updateUnseenCount:function(a,b,c,d){var a=a||this.currentFolder,e=this.getFolderByName(a);if(e)if(typeof b=="number")c?
e.unseenCount+=b:e.unseenCount-=b;else{var f=this.getFolderByName(a),g=null;if(Settings.HasAggregatedAccount&&f&&(f.type=="Aggregated"||f.type=="Inbox"))g=this.getFolderByName("AllInboxes");var h=this.getCachedListForFolder(a);if(!h)return;if(h.fastCountSupport&&b&&b.length>h.FetchSize)this.fetchNewMsgCount();else{var a=h.GetAvailableRowsForUIDs(b),i=this.columns.Seen;dojo.forEach(a,function(a){if(a=h.GetRow(a))c&&a[i]?(e.unseenCount++,d&&(a[i]=!1),g&&g.unseenCount++):!c&&!a[i]&&(e.unseenCount--,
d&&(a[i]=!0),g&&g.unseenCount--)})}}this.folderListChanged()},getCachedListForFolder:function(a){return typeof a=="undefined"||this.getSearchString()?this.activeCachedList:a==this.getInboxFolderName()?this.inboxCachedList:a==this.currentFolder?this.otherCachedList:null},getSubSearchStr:function(){var a=this.getSearchString(),b=this.getSearchIn(),c=this.getCurrentFolder()||{},d=Math.max(this.getRowCount(),0),e=this.sSubSearch.charAt(0),f="",g=this.sSubSearch.substr(2),h=this.activeCachedList.data.searchCounts;
if(e=="f"&&(c=this.getFolderByName(g))&&c.displayName)g=c.displayName;if(e=="d"){if(g=="Inbox")g=ws.UserContext.UserAddress;g=this.getIdentityDN(g)}if(e=="s"&&h)for(var i=0;i<h.senders.length;i++)if(h.senders[i].n==g){g=h.senders[i].fn;break}g.length>22&&(g=g.substr(0,22)+"&hellip;");a.length>22&&(a=ws.string.escapeXml(a.substr(0,22))+"&hellip;");switch(b){case null:case "alltext":f=d==0?e=="s"?Config.Strings.DSHAll0fr:e=="m"?Config.Strings.DSHAll0snt:e=="a"?Config.Strings.DSHAll0att:Config.Strings.DSHAll0:
d==1?e=="s"?Config.Strings.DSHAll1fr:e=="m"?Config.Strings.DSHAll1snt:e=="a"?Config.Strings.DSHAll1att:Config.Strings.DSHAll1:e=="s"?Config.Strings.DSHAllNfr:e=="m"?Config.Strings.DSHAllNsnt:e=="a"?Config.Strings.DSHAllNatt:Config.Strings.DSHAllN;break;case "subject":f=d==0?e=="s"?Config.Strings.DSHSub0fr:e=="m"?Config.Strings.DSHSub0snt:e=="a"?Config.Strings.DSHSub0att:Config.Strings.DSHSub0:d==1?e=="s"?Config.Strings.DSHSub1fr:e=="m"?Config.Strings.DSHSub1snt:e=="a"?Config.Strings.DSHSub1att:Config.Strings.DSHSub1:
e=="s"?Config.Strings.DSHSubNfr:e=="m"?Config.Strings.DSHSubNsnt:e=="a"?Config.Strings.DSHSubNatt:Config.Strings.DSHSubN;break;case "fromto":f=c!=null&&(c.type=="Sent"||c.type=="Drafts"||c.type=="AutoSavedSent")?d==0?e=="s"?Config.Strings.DSHRcp0fr:e=="m"?Config.Strings.DSHRcp0snt:e=="a"?Config.Strings.DSHRcp0att:Config.Strings.DSHRcp0:d==1?e=="s"?Config.Strings.DSHRcp1fr:e=="m"?Config.Strings.DSHRcp1snt:e=="a"?Config.Strings.DSHRcp1att:Config.Strings.DSHRcp1:e=="s"?Config.Strings.DSHRcpNfr:e=="m"?
Config.Strings.DSHRcpNsnt:e=="a"?Config.Strings.DSHRcpNatt:Config.Strings.DSHRcpN:d==0?e=="s"?Config.Strings.DSHSnd0fr:e=="m"?Config.Strings.DSHSnd0snt:e=="a"?Config.Strings.DSHSnd0att:Config.Strings.DSHSnd0:d==1?e=="s"?Config.Strings.DSHSnd1fr:e=="m"?Config.Strings.DSHSnd1snt:e=="a"?Config.Strings.DSHSnd1att:Config.Strings.DSHSnd1:e=="s"?Config.Strings.DSHSndNfr:e=="m"?Config.Strings.DSHSndNsnt:e=="a"?Config.Strings.DSHSndNatt:Config.Strings.DSHSndN}return ws.string.substituteParams(f,"&ldquo;"+
a+"&rdquo;",g,d>500?"500+":d)},getNoFolderStr:function(){if(this.sSubSearch)return this.getSubSearchStr();var a="",b=this.getSearchString(),c=this.getSearchIn(),d=this.getCurrentFolder()||{},e=Math.max(this.getRowCount(),0);b.length>22&&(b=ws.string.escapeXml(b.substr(0,22))+"&hellip;");switch(c){case null:case "alltext":a=e==0?Config.Strings.DSHNoFolderAll0:e==1?Config.Strings.DSHNoFolderAll1:Config.Strings.DSHNoFolderAllN;break;case "subject":a=e==0?Config.Strings.DSHNoFolderSub0:e==1?Config.Strings.DSHNoFolderSub1:
Config.Strings.DSHNoFolderSubN;break;case "fromto":a=d!=null&&(d.type=="Sent"||d.type=="Drafts"||d.type=="AutoSavedSent")?e==0?Config.Strings.DSHNoFolderRcp0:e==1?Config.Strings.DSHNoFolderRcp1:Config.Strings.DSHNoFolderRcpN:e==0?Config.Strings.DSHNoFolderSnd0:e==1?Config.Strings.DSHNoFolderSnd1:Config.Strings.DSHNoFolderSndN}return ws.string.substituteParams(a,"&ldquo;"+b+"&rdquo;",e>500?"500+":e)},getDisplayableSearchHeaderStr:function(a){if(a)return this.getNoFolderStr();var a="",b=this.getSearchString(),
c=this.getSearchIn(),d=this.getCurrentFolder()||{},e=Math.max(this.getRowCount(),0),f=Config.Strings.Mail;if(d&&d.displayName)f=d.displayName;f.length>22&&(f=f.substr(0,22)+"&hellip;");b.length>22&&(b=ws.string.escapeXml(b.substr(0,22))+"&hellip;");switch(c){case null:case "alltext":a=e==0?Config.Strings.DSHAll0:e==1?Config.Strings.DSHAll1:Config.Strings.DSHAllN;break;case "subject":a=e==0?Config.Strings.DSHSub0:e==1?Config.Strings.DSHSub1:Config.Strings.DSHSubN;break;case "fromto":a=d!=null&&(d.type==
"Sent"||d.type=="Drafts"||d.type=="AutoSavedSent")?e==0?Config.Strings.DSHRcp0:e==1?Config.Strings.DSHRcp1:Config.Strings.DSHRcpN:e==0?Config.Strings.DSHSnd0:e==1?Config.Strings.DSHSnd1:Config.Strings.DSHSndN}return ws.string.substituteParams(a,"&ldquo;"+b+"&rdquo;",f,e>500?"500+":e)},deleteAttachments:function(a){var b={load:function(){},error:function(a){window.ws_ErrLgr&&!a&&ws_ErrLgr.logError(ws_ErrLgr.cat.ProgErr,"Error Handler for DeleteAttachment-deleteAttachments file:MailModel.js")}};ws.io.rpc({action:"DeleteAttachment",
automatic:!1,content:{PreloadAttachmentIDs:a},load:dojo.hitch(b,"load"),error:dojo.hitch(b,"error")})}}),dojo.declare("ws.mail.folder",null,{constructor:function(a){this.name=a[0];this.displayName=a[1];this.parentName=a[2];this.depth=a[3];this.permanent=a[4];this.unseenCount=a[6];this.count=a[7];this.type=a[8];this.canMoveTo=a[9];this.account=a[11];this.status=a[12];this.name==Config.IMFolderName?(this.displayName=Config.Strings.Folder_SavedIMs,this.isIMFolder=!0):this.isIMFolder=!1}}),ws.mail.folderName=
{MaxLength:32,DisallowedCharsList:["\\",":","*","?",'"',"<",">","|","%"],DisallowedStartCharsList:[" ","%","#"],DisallowedCharsMap:{},DisallowedStartCharsMap:{},DisallowedCharsString:"",DisallowedStartCharsString:"",init:function(){var a,b;this.getDisallowedHierarchyDelimiter()&&this.DisallowedCharsList.push(this.getDisallowedHierarchyDelimiter());for(a=0;a<this.DisallowedCharsList.length;a++)b=this.DisallowedCharsList[a],this.DisallowedCharsString+=b+" ",this.DisallowedCharsMap[b]=!0;if(this.DisallowedCharsString.length>
0)this.DisallowedCharsString=this.DisallowedCharsString.substring(0,this.DisallowedCharsString.length-1);for(a=0;a<this.DisallowedStartCharsList.length;a++)b=this.DisallowedStartCharsList[a],this.DisallowedStartCharsString+=b==" "?Config.Strings.Space:b+" ",this.DisallowedStartCharsMap[b]=!0;if(this.DisallowedStartCharsString.length>0)this.DisallowedStartCharsString=this.DisallowedStartCharsString.substring(0,this.DisallowedStartCharsString.length-1)},getDisallowedHierarchyDelimiter:function(){return Config.ImapStoreAllowHierarchicalFolderCreation?
"":"/"},validate:function(a,b,c,d,e){var f=c!=null;if(!a||!b)return ws.widget.Dialogs.ok(Config.Strings.FolderWarningEmpty,e),!1;if(a.length>this.MaxLength)return ws.widget.Dialogs.ok(ws.string.substituteParams(Config.Strings.FolderWarningTooLong,this.MaxLength),e),!1;for(var g=0;g<a.length;g++)if(this.DisallowedCharsMap[a.charAt(g)])return ws.widget.Dialogs.ok(Config.Strings.FolderWarningLetters+"<br>"+this.DisallowedCharsString,e),!1;if(this.DisallowedStartCharsMap[a.charAt(0)])return ws.widget.Dialogs.ok(Config.Strings.FolderWarningStart+
"<br>"+this.DisallowedStartCharsString,e),!1;if(f&&a==c)return ws.widget.Dialogs.ok(Config.Strings.FolderWarningUnchanged,e),!1;if(f&&a.toLowerCase()==c.toLowerCase())return!0;longNameLower=b.toLowerCase();for(g=0;g<d.length;g++)if(d[g]!=null&&d[g].name.toLowerCase()==longNameLower)return a=ws.string.substituteParams(Config.Strings.FolderWarningDuplicate,'"'+a+'"'),ws.widget.Dialogs.ok(a,e),!1;return!0}};if(!dojo._hasResource["ws.string"])dojo._hasResource["ws.string"]=!0,dojo.provide("ws.string"),
ws.string={substituteParams:function(a,b){var c=typeof b=="object"?b:dojo._toArray(arguments,1);if(a==null)return"";return a.replace(/\%?\{(\w+)\}/g,function(a,b){if(typeof c[b]!="undefined"&&c[b]!=null)return c[b];throw Error("Substitution not found: "+b);})},escapeXml:function(a){return a.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;").replace(/'/gm,"&#39;")},unescapeXml:function(a){a=a.replace(/&#38;|&amp;/g,"&");a=a.replace(/&#60;|&lt;/g,"<");a=a.replace(/&#62;|&gt;/g,
">");a=a.replace(/&#34;|&quot;/g,'"');return a=a.replace(/&#39;|&apos;/g,"'")},decodeHTML:function(a){var b=document.createElement("textarea");b.innerHTML=a.replace(/</g,"&lt;").replace(/>/g,"&gt;");return b.value},escapeJs:function(a){return a.replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;").replace(/'/gm,"&#39;")},summary:function(a,b){if(!b||a.length<=b)return a;return a.substring(0,b-3).replace(/\.+$/,"")+"..."},textOverflow:function(){var a="textContent"in document.body?"textContent":
"innerText",b=String.fromCharCode(8230);return function(c){dojo.query(c).forEach(function(c){var e=c[a],f=e.length;for(f==0||e.charCodeAt(f-1)!=8230?c.origText=e:e=c[a]=c.origText;e&&c.scrollWidth>c.offsetWidth;)e=e.substring(0,e.length-1),c[a]=e+b})}},alphabet:"abcdefghijklmnopqrstuvwxyz",markupSearchString:function(a,b){if(a&&b&&(a=ws.string.escapeXml(a),b=ws.string.escapeXml(b),b.toLowerCase().indexOf(a.toLowerCase())!=-1)){for(var c=b,d=c.toLowerCase(),e=a.length,f=a.toLowerCase(),g=[],h=d.indexOf(f);h!=
-1;)g.push(c.substr(0,h)),g.push("<span class='searchTerm'>",c.substr(h,e),"</span>"),c=c.substr(h+e),d=d.substr(h+e),h=d.indexOf(f);g.push(c);b=g.join("")}return b}};if(!dojo._hasResource["ws.reporting"])dojo._hasResource["ws.reporting"]=!0,dojo.provide("ws.reporting"),ws.reporting={skipBeaconReporting:!1,opinionFeedbackUrl:null,report:function(a,b,c,d){if(this.skipBeaconReporting)this.skipBeaconReporting=!1;else{var e=!1;try{_ws_isOpenerWS()&&opener.ws&&opener.ws.reporting?opener.ws.reporting.report(a,
b,c,d):e=!0}catch(f){e=!0}e&&(ws.reporting._comscore.report(a,b),ws.reporting._omniture.report(a,b,c,d),ws.reporting._generic.report(a,b),ws.reporting._akamaiedge.report(a,b));ws.reporting.lastPageName=a}},reportAction:function(a){var b=!1;try{_ws_isOpenerWS()&&opener.ws&&opener.ws.reporting?opener.ws.reporting.reportAction(a):b=!0}catch(c){b=!0}b&&ws.reporting._omniture.reportAction(a)},makeFeedbackUrl:function(a){var b=a;a.indexOf("{0}")>0?b=ws.string.substituteParams(a,Config.FeedbackProdctSid):
(b+=b.indexOf("?")>0?"&":"?",b+="sid="+Config.FeedbackProdctSid);var a="",c=window.location.href;c+=c.indexOf("?")<0?"?g="+Settings.UserName:"&g="+Settings.UserName;a+="&referer="+encodeURIComponent(c);Config.EnableOmnitureReporting&&(a+="&ch="+Config.ReportingChannel);this.opinionFeedbackUrl=b+a},getFeedbackUrl:function(){return this.opinionFeedbackUrl},openOnlineOpinion:function(){var a=(screen.height-485)/2-100,b=(screen.width-740)/2;window.open(this.opinionFeedbackUrl,"feedback","width=740,height=485,screenX="+
b+",screenY="+a+",top="+a+",left="+b+",resizable=yes,copyhistory=yes,scrollbars=no");return!1}},ws.reporting._omniture={pageReportDone:!1,pendingReportActions:[],report:function(a,b,c,d){Config.EnableOmnitureReporting&&setTimeout(dojo.hitch(this,"doReport",a,b,c,d),100)},reportAction:function(a){Config.EnableOmnitureReporting&&Config.EnableCustomLinkTracking&&setTimeout(dojo.hitch(this,"doReportAction",a),100)},doReport:function(a,b,c,d){try{if(this.iframe){var e=this.getProps(a,b,d),f=this.iframe.contentWindow,
g=f.s_265||f.s;if(f.s_265&&(Config.OmnitureJsUrl.indexOf("OmniUniH.js")>0||Config.OmnitureJsUrl.indexOf("OmniUniHInt.js")>0))g.mmxgo=!0,g.mmxcustom=ws.reporting._comscore.getBeaconURL(a,!1),g.mmxtitle=a;dojo.mixin(g,e,c||{});g.t();this.pageReportDone=!0;if(dojo.isMoz&&!this.fixedThrobber)setTimeout(function(){ws.reporting._omniture.iframe.contentWindow.stop()},5E3),this.fixedThrobber=!0}else this.initialize(a,b)}catch(h){}},doReportAction:function(a,b){if(this.omnitureScriptLoaded()&&this.pageReportDone){if(this.pendingReportActions){for(var c=
0;c<this.pendingReportActions.length;c++)setTimeout(dojo.hitch(this,"__doReportAction",this.pendingReportActions[c]),300);this.pendingReportActions=null}b!==!0&&this.__doReportAction(a)}else b!==!0&&this.pendingReportActions.push(a),setTimeout(dojo.hitch(this,"doReportAction",null,!0),1E3)},__doReportAction:function(a){if(!this.accountForCustomLink)this.accountForCustomLink=Config.ReportingCustomLinkAccount?Config.ReportingCustomLinkAccount:Config.ReportMailSuiteOnlyInCustomLink?this.getAccount().split(",")[0]:
this.getAccount();var b=this.iframe.contentWindow,c=b.s_265||b.s,b=b.s_gi(this.accountForCustomLink,0,1);c.linkTrackVars="None";c.linkTrackEvents="None";c.tl(dojo.body(),"o",a);if(!c.pageName)c.pageName=Config.ReportingPrefix+" : Initial View";b.sa(this.accountForCustomLink)},getAccount:function(){return Config.ClientReportingAccount&&navigator.userAgent.indexOf("AOL")!=-1?Config.ClientReportingAccount:Config.ReportingAccount},getClientType:function(){return navigator.userAgent.indexOf("AOL")!=-1?
"client":"portal"},getProps:function(a,b,c){a={pfxID:Config.ReportingPrefix,pageName:Config.ReportingPrefix+" : "+a,channel:Config.ReportingChannel,prop1:Config.ReportingPrefix+" : "+Config.ReportingDepartment,prop2:Config.ReportingPrefix+" : "+b,prop8:ws.UserContext.ConnectionType,prop10:ws.UserContext.ClientVersion,prop12:ws.reporting._comscore.getBeaconURL(a,!1),prop13:"authenticated",prop16:"",prop19:ws.UserContext.SessionId};c&&(a.pageName+=" - "+c);if(Config.ReportLocale)a["prop"+Config.ReportLocale]=
Config.PageLocale;if(Config.ReportAccountCreateTime)a["prop"+Config.ReportAccountCreateTime]=ws.UserContext.AOLCreateDate;if(Config.ReportScreenName)a["prop"+Config.ReportScreenName]=ws.UserContext.ScreenNameHash;Config.ReportUIVariant&&(a["prop"+Config.ReportUIVariant]=Config.ReportUIVariantValue||Config.UIVariant);Config.ReportClientType&&(a["prop"+Config.ReportClientType]=this.getClientType());if(Config.ReportBrandi)a["prop"+Config.ReportBrandi]=ws.UserContext.Brandi;if(Config.ReportHatChannel)a.hatChannel=
Config.ReportHatChannel;if(ws.UserContext.OmnitureCampaign&&Config.ReportCampaign&&!this.reportedCampaign){c=ws.UserContext.OmnitureCampaign.split("=");if(c[0]=="ncid")a.campaign=a.eVar18=a.eVar19=c[1];else if(c[0]=="icid")a.eVar16=c[1];this.reportedCampaign=!0}else a.campaign=a.eVar16=a.eVar18=a.eVar19=null;Config.ReportWSAuthUIUserGroup&&(a["eVar"+Config.ReportWSAuthUIUserGroup]=Config.ReportingPrefix+": SNS_Adtest | "+Settings.WsAuthUserGroup);return a},initialize:function(a,b){this.initialPageName=
a;this.initialTabName=b;this.iframe=dojo.io.iframe.create("wsReporting","ws.reporting._omniture.onIframeLoaded();",Config.EmptyFileURL)},onIframeLoaded:function(){if(!this.iframeWritten){this.iframeWritten=!0;var a=dojo.io.iframe.doc(this.iframe),b=ws.string.substituteParams("<script>var s_account = '{account}';<\/script><img name='{imgid}' id='{imgid}' src='{spacer}'><script src='{scripturl}'><\/script>",{account:this.getAccount(),imgid:"s_i_"+this.getAccount().split(",")[0],spacer:Config.SpacerImageURL,
scripturl:Config.OmnitureJsUrl});a.write(b);a.close();this.watchForScriptLoaded()}},watchForScriptLoaded:function(){this.omnitureScriptLoaded()?this.report(this.initialPageName,this.initialTabName):setTimeout(dojo.hitch(this,"watchForScriptLoaded"),100)},omnitureScriptLoaded:function(){if(this.iframe){var a=this.iframe.contentWindow;return a.s_dc||a.s_265||a.s}else return!1}},ws.reporting._comscore={report:function(a){Config.EnableComscoreReporting&&setTimeout(dojo.hitch(this,"doReport",a),100)},
doReport:function(a){if(!this.img)this.img=dojo.create("img",{width:1,height:1},dojo.body());this.img.src=this.getBeaconURL(a,!0)},getBeaconURL:function(a,b){var c=a.replace(/\W/g,""),c=Config.BaseBeaconURL+"Beacon"+c+".htm";b&&(c+="?rnd="+Math.random());return c}},ws.reporting._generic={report:function(a,b){Config.GenericBeaconURL&&setTimeout(dojo.hitch(this,"doReport",a,b),100)},doReport:function(a,b){var c=Config.GenericBeaconURL.split(",");if(!this.img)this.img=[];for(var d=0;d<c.length;d++){this.img[d]||
(this.img[d]=dojo.create("img",{width:1,height:1},dojo.body()));var e=ws.string.substituteParams(c[d],{referrer:encodeURIComponent(document.referrer),random:Math.round(Math.random()*1E5),wunderloopArea:this.getWunderloopArea(a,b)});setTimeout(dojo.hitch(this,function(a,b){if(!this.wunderLoopKeywordRequestSent&&b==c.length-1)this.wunderLoopKeywordRequestSent=!0,this.img[b].onload=function(){if(Config.WunderloopKeywordURL){var a="",a=Config.WunderloopKeywordURL;a+="?random="+Math.random()*1E5;dojo.create("script",
{type:"text/javascript",src:a},dojo.body())}};this.img[b].src=a},e,d),d*100)}},getWunderloopArea:function(a,b){if(a.indexOf("Read Message")!=-1)return"read";if(a.indexOf("Compose Message")!=-1)return"write";if(a.indexOf("Send Confirmation")!=-1)return"sent";if(b=="Init"||b=="Today")return"today";if(b=="Addresses")return"contacts";if(b=="Calendar")return"calendar";return"inbox"},getWunderLoopKeyword:function(){return window.aoleuAdKeywords}},ws.reporting._akamaiedge={beaconFired:!1,report:function(a,
b){if(Config.AkamaiEdgeBeaconURL&&!this.beaconFired)setTimeout(dojo.hitch(this,"doReport",a,b),100),setTimeout(dojo.hitch(this,"doReport",a,b),Config.AkamaiEdgeBeaconURL_interval+100),this.beaconFired=!0},doReport:function(){if(!this.img)this.img=dojo.create("img",{width:1,height:1},dojo.body());this.img.src=ws.string.substituteParams(Config.AkamaiEdgeBeaconURL,{random:Math.random()})}},ws.reporting.DL={fields:{reqID:"",requestID:"",sessionID:"",SN:"",opName:"",opTime:"",opResult:"",opData:"",op1:"",
errType:"",errCode:"",connSpeed:"",comSpeed:"",msgCount:"",msgSize:"",startTime:""},timeoutTable:null,reqCounts:{load_mail:0,read_mail:0,read_mail_att:0,send_mail:0,send_mail_att:0,list_folder:0,search_mail:0},dlcookies:{cons:"",coms:""},lookupTable:{},speedChecked:!1,MIN_THRESHOLD_MILLIS:1E3,MAX_LEN:512,_computerSpeed:0,_connectionSpeed:0,_imgList:[{name:"speeddetect4k.jpg",size:4},{name:"speeddetect32k.jpg",size:32},{name:"speeddetect252k.jpg",size:252}],_hashIt:function(a){var b,c,d,e,f;c=a?a.length:
0;b=0;d=c;for(e=c^255;b<c;b++)f=e>>>27,e=e<<5^d>>>27,d=d<<5^f^a.charCodeAt(b);return(e>>>1)*2+(e&1)+":"+((d>>>1)*2+(d&1))},_getDigest:function(){var a=new Date,b=a.toString(),c=0;do b+=this._digest=this._hashIt(b),c++;while(new Date-a<500);return c},_checkConnectionSpeed:function(a){var b=this,c=b._img=new Image;c.onload=function(){var c=(new Date).getTime()-b._imagedownloadBegin;c<1E3&&a<b._imgList.length-1?setTimeout(function(){b._checkConnectionSpeed(a+1)},500):(c>0?(c>1E3&&(c-=100),b._connectionSpeed=
(b._imgList[a].size*1E4/(c*1024)).toFixed(3)):b._connectionSpeed=0,b._connectionSpeed!=0&&b._setSpeedInCookie(b._connectionSpeed,b._computerSpeed))};b._imagedownloadBegin=(new Date).getTime();c.src=Config.SpeedDetectURL+b._imgList[a].name},measureConnectionAndMachineSpeed:function(){var a=this;setTimeout(function(){a._computerSpeed=a._getDigest();a._checkConnectionSpeed(0)},1E3)},isEnabled:function(){if(Config&&Config.DataLayerBeaconURL&&Settings&&Settings.UserHash>=Config.DLReportingThreshold)return!0;
return!1},initFields:function(a){for(var b in this.fields)a[b]=this.fields[b];if(Settings)a.SN=Settings.UserScreenName||"",a.sessionID=Settings.SessionID||"";this._connectionSpeed==0&&this._getSpeedFromCookie();if(Config.SpeedTimingEnabled&&!this.speedChecked&&this._connectionSpeed==0)this.speedChecked=!0,b=Config.SpeedTimingDelayMillis||3E4,setTimeout(dojo.hitch(this,"measureConnectionAndMachineSpeed"),b);a.comSpeed=this._computerSpeed||"";a.connSpeed=this._connectionSpeed||""},setData:function(a,
b){if(!this.isEnabled())return"error:disabled";var c=this.lookupTable[a];if(!c)return"error:no id "+a;for(var d in b)if(this.fields[d]!=null&&this.fields[d]!=void 0)c[d]=b[d];else return"error:invalid field "+d;return"success"},_setSpeedInCookie:function(a,b){if(this._connectionSpeed!=0)this.dlcookies.cons=a,this.dlcookies.coms=b,ws.io._setObjectCookie(this.dlcookies,"DataLayer",null,"/",Config.DLCookieLifeInDays)},_getSpeedFromCookie:function(){if(this._connectionSpeed==0){var a=ws.io._getObjectCookie("DataLayer",
"=");if(a)this.dlcookies=a,this._connectionSpeed=this.dlcookies.cons||0,this._computerSpeed=this.dlcookies.coms||0}},_getTimeout:function(a){if(!this.timeoutTable)this.timeoutTable={load_mail:Config.DLTimeoutLoadMail.split(","),read_mail:Config.DLTimeoutReadMail.split(","),read_mail_att:Config.DLTimeoutReadMailAtt.split(","),send_mail:Config.DLTimeoutSendMail.split(","),send_mail_att:Config.DLTimeoutSendMailAtt.split(","),list_folder:Config.DLTimeoutListFolder.split(","),search_mail:Config.DLTimeoutSearchMail.split(",")};
if(a=this.timeoutTable[a]){var b=this._connectionSpeed,c=0;b>0.128&&b<=1?c=1:b>1&&(c=2);return a[c]?a[c]:Config.DLTimeoutMillis}return Config.DLTimeoutMillis},startEvent:function(a,b,c,d){if(!this.isEnabled())return null;var b=b||a,e=this.lookupTable[b];e?"timerID"in e&&clearTimeout(e.timerID):e={};var f=this._getTimeout(a);this.initFields(e);e.reqID=b;e.opName=encodeURIComponent(a);e.startTime=new Date;this.lookupTable[b]=e;if(c!=null&&this.setData(b,c)!="success")return null;d!=null&&(f=d);if(f>
0){if(f<this.MIN_THRESHOLD_MILLIS)f=this.MIN_THRESHOLD_MILLIS;e.timerID=setTimeout(dojo.hitch(this,"endEvent",b,null,!0),f)}return b},endEvent:function(a,b,c){if(!this.isEnabled())return"error:disabled";if(a==null)return"null reqID";var d=this.lookupTable[a];if(d){"timerID"in d&&(clearTimeout(d.timerID),delete d.timerID);b!=null&&this.setData(a,b);if(c)d.opResult="timeout",d.opTime=this._getTimeout(d.opName);else{if(d.opTime=="")d.opTime=new Date-d.startTime;b=d.opName;if(d.opTime<Config.DLSendDiagThresholdMillis)d.opData=
b=="read_mail"||b=="read_mail_att"||b=="list_folder"?d.reqID:"";else if(b=="load_mail")d.opData=ws.bootstrap.lmdata}d.requestID=this.reqCounts[d.opName]++;b="";for(key in d)key!="reqID"&&key!="startTime"&&(b+="&"+key+"="+encodeURIComponent(d[key]));if(d.opName=="load_mail")try{var e=dojo.window.getBox();b+="&bsize="+e.w+"x"+e.h;b+="&ssize="+screen.width+"x"+screen.height}catch(f){}this.report(d,b);delete this.lookupTable[a]}else return"error:failed to get id "+a;return"success"},append:function(a,
b){if(!(b==null||b==""||b=="load_mail")){var c=this.lookupTable[b];if(c){var d=(new Date).getTime()-c.startTime.getTime();c.opData.length<this.MAX_LEN&&(c.opData+=a+d,c.opData.length>this.MAX_LEN&&(c.opData+=".."))}}},hasEvent:function(a){var b=this.lookupTable[a];return b&&b.reqID==a},removeEvent:function(a){var b=this.lookupTable[a];b&&("timerID"in b&&(clearTimeout(b.timerID),delete b.timerID),delete this.lookupTable[a])},createAndSendEvent:function(a,b,c){if(!this.isEnabled())return"error:disabled";
return(a=this.startEvent(a,b,c,0))?this.endEvent(a):"error:startEvent failed"},report:function(a,b){this.isEnabled()&&setTimeout(dojo.hitch(this,"doReport",b),dojo.isFF&&a.opName=="load_mail"?300:100)},doReport:function(a){if(!this.img)this.img=dojo.create("img",{width:1,height:1},dojo.body());var b=(new Date).getTime();this.img.src=ws.string.substituteParams(Config.DataLayerBeaconURL,{time:b,host:window.location.hostname,appver:Config.ReportingDepartment,custom:a})}};if(!dojo._hasResource["ws.browser"])dojo._hasResource["ws.browser"]=
!0,dojo.provide("ws.browser"),ws.browser={addOnBeforeUnload:function(a,b){if(!ws.browser._onBeforeUnloadAttached)ws.browser._onBeforeUnloadAttached=!0,ws.browser._oldOnBeforeUnloadHandler=window.onbeforeunload||function(){},ws.browser._onBeforeUnloadHandlers=[],window.onbeforeunload=ws.browser._onBeforeUnload;var c=arguments.length==1?a:dojo.hitch(a,b);ws.browser._onBeforeUnloadHandlers.push(c)},_onBeforeUnload:function(){ws.browser._oldOnBeforeUnloadHandler();window.onbeforeunload=null;setTimeout(function(){window.onbeforeunload=
ws.browser._onBeforeUnload},0);if(!ws.io.closeWindowInProgress)for(var a=0;a<ws.browser._onBeforeUnloadHandlers.length;a++){var b=ws.browser._onBeforeUnloadHandlers[a]();if(b)return b}},addDocumentOnClick:function(a,b){if(this._getDocClickHandlerObj())return dojo.connect(this._getDocClickHandlerObj(),"onclick",a,b)},_getDocClickHandlerObj:function(){if(!this._docClickHandlerInited){this._docClickHandlerInited=!0;for(var a=[document,document.body,document.documentElement],b=function(){},c=0;c<a.length;c++)try{var d=
dojo.connect(a[c],"onclick",b);dojo.disconnect(d);this._docClickHandlerObj=a[c];break}catch(e){}}return this._docClickHandlerObj},ns7:navigator.userAgent.indexOf("Netscape/7")!=-1,ns8:navigator.userAgent.indexOf("Netscape/8")!=-1,win98:navigator.userAgent.indexOf("Windows 98")!=-1||navigator.userAgent.indexOf("Win98")!=-1,win2k:navigator.userAgent.indexOf("Windows NT 5.0")!=-1,win:navigator.appVersion.indexOf("Windows")!=-1,ipad:navigator.appVersion.indexOf("iPad")!=-1,isWindowFocused:!0,_trackWindowFocus:function(){dojo.isIE?
(dojo.connect(dojo.body(),"onfocusin",this,"_onfocus"),dojo.connect(dojo.body(),"onfocusout",this,"_onblur")):(dojo.connect(window,"onfocus",this,"_onfocus"),dojo.connect(window,"onblur",this,"_onblur"))},_onfocus:function(){this.isWindowFocused=!0;this._clearFlashingWindowTitle()},_onblur:function(){this.isWindowFocused=!1},focus:function(a){this.isWindowFocused&&setTimeout(function(){try{a.focus()}catch(b){}},0)},setWindowTitle:function(a){if(document.title!=this._flashingTitle)document.title=a;
this._normalTitle=a},setFlashingWindowTitle:function(a){if(!this.isWindowFocused)this._clearFlashingWindowTitle(),this._flashingTitle=a,this._alternateWindowTitle()},_flashingTitle:null,_normalTitle:document.title,_alternateWindowTitle:function(){document.title=document.title==this._normalTitle?this._flashingTitle:this._normalTitle;this._flashTitleTimeout=window.setTimeout(dojo.hitch(this,"_alternateWindowTitle"),2E3)},_clearFlashingWindowTitle:function(){this._flashingTitle=null;document.title=this._normalTitle;
this._flashTitleTimeout&&window.clearTimeout(this._flashTitleTimeout)},registerMailToHandler:function(){dojo.isFF>=3&&window.navigator.registerProtocolHandler("mailto",Config.MailToAppUrl+"?to=%s",Config.Strings.FullProductName)}},dojo.addOnLoad(ws.browser,"_trackWindowFocus");if(!dojo._hasResource["ws.settings"])dojo._hasResource["ws.settings"]=!0,dojo.provide("ws.settings"),ws.settings={load:function(a){var b=a.scope||"core";ws.WebSuite.isSettingLoaded(b)&&!a.forceReload||Settings.WSSConnectError?
a.load&&a.load():ws.io.rpc({action:"GetSettings",content:{scope:b},load:function(c){dojo.mixin(window.Settings,c.settings);ws.WebSuite.settingsLoaded[b]=!0;a.load&&a.load()},error:function(b){a.error&&a.error(b)}})},saveSoon:function(a){this.save(a)},saveNow:function(a){this.save(a)},save:function(a,b){if(Settings.WSSConnectError)b&&b.load&&b.load();else{dojo.mixin(this._pendingSaveContent,a);var c={action:"HiddenSettings",content:this._pendingSaveContent};dojo.mixin(c,b);ws.io.rpc(c);this._pendingSaveContent=
{}}},savePending:function(){if(this._pendingSaveContent){var a=!0,b;for(b in this._pendingSaveContent){a=!1;break}!1==a&&this.save()}},allowPopups:function(){return!(dojo.isIE&&ws.browser.win98)},_pendingSaveContent:{}};if(!dojo._hasResource["ws.themes.ThemeConfig"])dojo._hasResource["ws.themes.ThemeConfig"]=!0,dojo.provide("ws.themes.ThemeConfig"),ws.themes.ThemeConfig=window._ws_theme={prefs:null,initialThemeLoaded:!1,themeData:null,currentThemeId:null,currentThemeData:null,active:{},randomThemeList:null,
randomThemeEnabled:!1,restoreToThemeId:null,forceOrOptoutThemeId:null,optOut:!1,optinThemeId:null,themeChangeCallbacks:{},needsHideLoadingCurtain:!1,init:function(){if(Config.EnableThemes){window.g_ThemeAtom_WS=dojo.hitch(this,this._g_ThemeAtom_WS);this.prefs=null;if(typeof Settings.ThemePrefs=="string"){if(Settings.ThemePrefs)this.prefs=dojo.fromJson(Settings.ThemePrefs)}else this.prefs=Settings.ThemePrefs;if(!this.prefs)this.prefs={SelectedTheme:"theme-"+Config.ThemeDefault,restoreToTheme:Config.ThemeDefault,
randomThemeEnabled:!1};this.currentThemeId=this.prefs.SelectedTheme.substr(6);this.restoreToThemeId=this.prefs.restoreToTheme;this.randomThemeEnabled=this.prefs.randomThemeEnabled?!0:!1;if(this.currentThemeId=="")this.currentThemeId=Config.ThemeDefault;this.currentThemeId=this.currentThemeId.toUpperCase();this.map={Hdr_grtingText:["Header","grtingTxt"],Hdr_link:["Header","lnk"],Gen_base:["GeneralApp","base"],Gen_dark:["GeneralApp","dark"],Gen_medium:["GeneralApp","medium"],Gen_light:["GeneralApp",
"light"]};this.parseThemeData();if(Config.AllowRandomThemes&&this.randomThemeEnabled)try{this.currentThemeId=_ws_isOpenerWS()&&opener._ws_theme&&typeof opener._ws_theme.currentThemeId!="undefined"?opener._ws_theme.currentThemeId:this.getRandomTheme()}catch(a){}this.wasTakeover=!1;var b=this.prefs.optOutForcedThemeId?this.prefs.optOutForcedThemeId:"";if(Settings.EnablePromoThemes&&this.forceOrOptoutThemeId&&this.forceOrOptoutThemeId!=b)this.currentThemeId=this.forceOrOptoutThemeId,this.wasTakeover=
!0;this.currentThemeId==Config.ThemeDefault?this.startUpThemeLoaded():this.loadTheme(this.currentThemeId,dojo.hitch(this,this.startUpThemeLoaded),dojo.hitch(this,function(){this.currentThemeId=Config.ThemeDefault;this.startUpThemeLoaded();this.hideLoadingCurtain()}))}},hideLoadingCurtain:function(){!Config.EnableThemes||this.initialThemeLoaded?ws.WebSuite.hideLoadingCurtain():this.needsHideLoadingCurtain=!0},startUpThemeLoaded:function(){if(this.themeData[this.currentThemeId])this.currentThemeData=
this.themeData[this.currentThemeId];if(this.needsHideLoadingCurtain)ws.WebSuite.hideLoadingCurtain(),this.needsHideLoadingCurtain=!1;this.initialThemeLoaded=!0;if(this.todayPageCallbackFunc)this.todayPageCallbackFunc(),this.todayPageCallbackFunc=null;this.themePicker&&!this.startUpThemeChangeDone&&this.themePicker.startUpThemeLoaded()},getThemeColor:function(a,b){if(!this.themeData)return null;var c=null;if(this.themeData[this.currentThemeId])this.currentThemeData=this.themeData[this.currentThemeId];
var d=this.currentThemeData.styleInfo;this.themePicker&&this.themePicker.isHighContrastTheme&&(d={Header:{grtingTxt:"#000",lnk:"#000"},GeneralApp:{base:"#46B9E9",dark:"#077BA6",medium:"#6ACAF2",light:"#D6F2FE"}});this.map&&this.currentThemeData&&d&&(c=this.map[a],c=d[c[0]][c[1]]);b&&c&&c.substr(0,1)=="#"&&(c=c.substr(1));return c},getThemeColorQueryString:function(a,b,c){var d=null;if(!Config.EnableThemes)return null;var e=null,f=null,g=null,h=null,i=null,j=null;a&&this.themePicker&&this.themePicker.isHighContrastTheme?
(e="85D1F1",g=f="ffffff",h="000000",i="28aee6",j="000000"):(e=this.getThemeColor("Gen_medium",!0),f=this.getThemeColor("Gen_medium",!0),g=this.getThemeColor("Gen_base",!0),h=this.getThemeColor("Gen_dark",!0),i=this.getThemeColor("Gen_base",!0),j=this.themePicker&&this.themePicker.isHighContrastTheme?"000000":"ffffff");f&&g&&h&&i&&(d=b&&e?"lightest="+e:"",d+="lightest="+e+"&midlightlight="+f+"&midlight="+g+"&darkest="+h+"&link="+i,c&&j&&(d+="&text="+j));return d},getRandomTheme:function(){return this.randomThemeList[Math.floor(Math.random()*
this.randomThemeList.length)]},parseThemeData:function(){this.forceOrOptoutThemeId=null;this.optOut=!1;this.optinThemeId=null;this.themeData=ws.lang.shallowCopy(Config.WebSuiteThemes);var a=[];typeof Subset_Themes!="undefined"&&(a=ws.lang.shallowCopy(Subset_Themes.IDList));var b=[];this.active={};this.active[Config.ThemeDefault]=!0;for(var c=0;c<a.length;c++){var d=a[c];if(Subset_Themes[d]){var e=Subset_Themes[d];if(e.PromoAttribute){var f=e.PromoAttribute;if(this.forceOrOptoutThemeId==null&&this.isThemeInDateRange(f,
"force")&&this.isTargetUserMatch(e))this.forceOrOptoutThemeId=d,this.active[d]=!0;else if(this.forceOrOptoutThemeId==null&&this.isThemeInDateRange(f,"optout")&&this.isTargetUserMatch(e))this.forceOrOptoutThemeId=d,this.optOut=!0,this.active[d]=!0;else if(this.optinThemeId==null&&this.isThemeInDateRange(f,"optin")&&this.isTargetUserMatch(e))this.optinThemeId=d,this.active[d]=!0;this.isThemeInDateRange(f,"gallery")&&(this.active[d]=!0)}else this.active[d]=!0,b.push(d)}else this.active[d]=!0,b.push(d)}a=
ws.lang.shallowCopy(Config.WebSuiteThemes.IDList).splice(0,1);this.randomThemeList=ws.lang.shallowCopy(a.concat(b));b=dojo.indexOf(this.randomThemeList,"HIGHCONTRAST");b!=-1&&this.randomThemeList.splice(b,1)},unspecified:function(a){return typeof a=="undefined"||a==null||a==""?!0:!1},isActive:function(a){return a&&this.active&&this.active[a]?!0:!1},isTargetUserMatch:function(a){function b(a){var b=!1;e.gender&&(dojo.isString(e.gender)&&e.gender.length?e.gender.substr(0,1).toLowerCase()==a.substr(0,
1).toLowerCase()&&(b=!0):window.ws_ErrLgr&&ws_ErrLgr.logError(ws_ErrLgr.cat.ProgErr,"themeConfig.js error: targeted theme has invalid MatchAtribute.gender  file:ThemeConfig.js"));return b}function c(a){var b=!1;e.age&&(dojo.isArray(e.age)&&e.age.length==2?a>=e.age[0]&&(b=!0,e.age[1]>=e.age[0]&&a>e.age[1]&&(b=!1)):window.ws_ErrLgr&&ws_ErrLgr.logError(ws_ErrLgr.cat.ProgErr,"themeConfig.js error: targeted theme has invalid MatchAtribute.age  file:ThemeConfig.js"));return b}function d(a){var b=!1;e.zip&&
(dojo.isArray(e.zip)&&e.zip.length?dojo.indexOf(e.zip,a)!=-1&&(b=!0):window.ws_ErrLgr&&ws_ErrLgr.logError(ws_ErrLgr.cat.ProgErr,"themeConfig.js error: targeted theme has invalid MatchAtribute.zip  file:ThemeConfig.js"));return b}if(!a||!a.MatchAtribute)return!0;var e=a.MatchAtribute,a=!1,f=ws.UserContext.UserGender;f&&dojo.isString(f)&&f.length&&(a=b(f));var f=!1,g=ws.UserContext.Age;g&&typeof g=="number"&&(f=c(g));var g=!1,h=ws.UserContext.Zip;h&&dojo.isString(h)&&h.length&&(g=d(h));h="false";if(e.match&&
dojo.isString(e.match)&&e.match.length)try{h=ws.string.substituteParams(e.match,{gender:a,age:f,zip:g})}catch(i){window.ws_ErrLgr&&ws_ErrLgr.logError(ws_ErrLgr.cat.ProgErr,"themeConfig.js error: targeted theme has MatchAtribute.match with unknown token, valid are: %{age}, %{gender} or %{zip} file:ThemeConfig.js")}a=!1;try{a=eval(h)}catch(j){window.ws_ErrLgr&&ws_ErrLgr.logError(ws_ErrLgr.cat.ProgErr,"themeConfig.js error: targeted theme has invalid MatchAtribute.match  file:ThemeConfig.js")}return a},
isThemeInDateRange:function(a,b,c){var d=a[b+"Start"],e=a[b+"End"];if(this.unspecified(d)&&this.unspecified(e))return!1;a=new Date;b=!0;!c&&!this.unspecified(d)&&(c=dojo.date.stamp.fromISOString(d))&&a<c&&(b=!1);c=!0;this.unspecified(e)||(d=dojo.date.stamp.fromISOString(e))&&a>d&&(c=!1);if(b&&c)return!0;return!1},getExternalThemeResourcePath:function(a){var b="",b="";if(a.version&&a.version.length>0)b=a.version;return b=Config.ThemeConfigResourcePath+b+"/"+a.id.toLowerCase()},loadTheme:function(a,
b,c){if(b){var d=a;if(!this.isActive(d))this.currentThemeId=d=this.prefs.restoreToThemeId&&this.prefs.restoreToThemeId&&!this.isActive(this.prefs.restoreToThemeId)?this.prefs.restoreToThemeId:Config.ThemeDefault;this.themeData[a]||d==Config.ThemeDefault?b(d):(this.themeChangeCallbacks[d]||(this.themeChangeCallbacks[d]=[]),this.themeChangeCallbacks[d].push(b),_ws.loadScript({src:Config.ThemeConfigURL+d.toLowerCase()+".js",load:dojo.hitch(this,function(){if(dojo.isIE<=8&&this.needsHideLoadingCurtain)ws.WebSuite.hideLoadingCurtain(),
this.needsHideLoadingCurtain=!1}),error:dojo.hitch(this,this.themeLoadError,d,c)}))}},themeLoadError:function(a,b){b&&b();window.ws_ErrLgr&&ws_ErrLgr.logError(ws_ErrLgr.cat.ExternalErr," file:ThemeConfig.js - themeConfig error: Unable to load theme",a)},_g_ThemeAtom_WS:function(a){if(a&&a.id){var b=a.id;a.resourcePath=this.getExternalThemeResourcePath(a);this.themeData[b]=a;if(this.themeChangeCallbacks[b])for(a=this.themeChangeCallbacks[b];a.length;)a.shift()()}else this.themeLoadError("No theme param")},
reset:function(){this.prefs.SelectedTheme="";this.prefs.restoreToTheme="";this.prefs.optOutForcedThemeId="";ws.settings.saveNow({ThemePrefs:this.prefs});ws.settings.saveNow({LastSeenPromoTipBubble:""});Settings.ThemePrefs=this.prefs;Settings.LastSeenPromoTipBubble=""},disp:function(){alert(typeof Settings.ThemePrefs=="string"?"LastSeenPromoTipBubble: "+Settings.LastSeenPromoTipBubble+" "+Settings.ThemePrefs:"LastSeenPromoTipBubble: "+Settings.LastSeenPromoTipBubble+" SelectedTheme: "+Settings.ThemePrefs.SelectedTheme+
" restoreToTheme: "+Settings.ThemePrefs.restoreToTheme+" optOutForcedThemeId: "+Settings.ThemePrefs.optOutForcedThemeId)}};if(!dojo._hasResource["ws.bootstrap"]){dojo._hasResource["ws.bootstrap"]=!0;dojo.provide("ws.bootstrap");if(dojo.isFF<3&&typeof console=="undefined")u={},u.log=u.warn=u.debug=u.error=function(){},window.console=u;ws.bootstrap={connectionSpeed:0,defaultDLTimeout:6E4,MAX_LEN:512,lmdata:"",lmtime:0,timerID:null,lmsent:!1,retries:0,sending:!1,init:function(){window._g_ws_loginStartTime=
new Date;try{this.defaultDLTimeout=DL_defaultTimeout}catch(a){this.defaultDLTimeout=6E4}_ws.updateProgress(85);this.timerID&&clearTimeout(this.timerID);var b=this.getTimeout();this.timerID=setTimeout(function(){if(ws&&ws.reporting&&ws.reporting.DL&&ws.reporting.DL.createAndSendEvent&&!ws.bootstrap.lmsent)ws.bootstrap.lmsent=!0,ws.reporting.DL.createAndSendEvent("load_mail","load_mail",{opResult:"timeout",opTime:b,opData:ws.bootstrap.lmdata})},b);this.theMailModel=new ws.mail.MailModel;dojo.require("ws.layers.dojo2");
_ws.updateProgress(110);_wsDojoAddOnLoadRetry(function(){_ws.updateProgress(125);ws.themes.ThemeConfig.init();ws.mail.folderName.init();ws.WebSuite.initialize()},"ws.WebSuite.initialize")},sendLoadMailReport:function(a){var b="";if(!this.lmsent)this.cancelTimer(),this.sending=!0,ws&&ws.reporting&&ws.reporting.DL&&ws.reporting.DL.createAndSendEvent?(this.lmsent=!0,b=ws.reporting.DL.createAndSendEvent("load_mail","load_mail",a)):this.retries<10?(this.retries++,setTimeout(function(){ws.bootstrap.sendLoadMailReport(a)},
5E3),b="retry"):(this.sending=!1,b="abort");return b},cancelTimer:function(){if(this.timerID)clearTimeout(this.timerID),this.timerID=null},reset:function(a){if(a=="load_mail")this.lmtime=(new Date).getTime(),this.lmdata=""},add:function(a,b){var c=(new Date).getTime();a=="load_mail"&&this.lmdata.length<this.MAX_LEN&&(this.lmdata+=b+(c-this.lmtime),this.lmdata.length>this.MAX_LEN&&(this.lmdata+=".."))},getTimeout:function(){var a="60000,50000,40000";try{a=DL_loadMailTimeout}catch(b){a="60000,50000,40000"}var c=
this.getConnSpeedFromCookie(),a=a.split(","),d=0;c>0.128&&c<=1?d=1:c>1&&(d=2);return a[d]?a[d]:this.defaultDLTimeout},getConnSpeedFromCookie:function(){if(this.connectionSpeed!=0)return this.connectionSpeed;var a=ws.io._getObjectCookie("DataLayer","=");if(a)this.connectionSpeed=a.cons||0;return this.connectionSpeed},doToday:function(){if(Config.EnableTodayCurtain&&Settings.ShowTodayAtSignIn&&!ws.bootstrap.isAddCommandParams()&&!ws.io.getQueryParameter("app")&&!ws.io.getQueryParameter("a")){if(dojo.isIE!=
6&&dojo.isFF!=2){var a=dojo.byId("todayIframe");a.style.display="";a.src=Config.WelcomePageURL;var b=dojo.doc.documentElement;dojo.style(a,{width:b.clientWidth-195+"px",height:b.clientHeight-221+"px"})}}else Config.EnableTodayCurtain||dojo.destroy(dojo.byId("todayIframeCntr"))},parseAppQueryCmd:function(){var a=ws.io._getObjectCookie(Config.WSGadgetCookieName,"="),b={at:["tid",null,"promoteTheme"],as:["sid",null,"promoteStationery","slabel",null],ap:["pid",null,"promotePlugin","plabel",null]},c=ws.io.getQueryParameter("cmd");
c||(c="");for(var d=c.split(","),e=d.length-1;e>=0;e--){var f=!1;if(c=d[e]){var g=ws.io.getQueryParameter(b[c][0]);if(g!=null&&(b[c][1]=g,f=!0,c=="as"||c=="ap"))(g=ws.io.getQueryParameter(b[c][3]))&&(b[c][4]=g)}f||d.splice(e,1)}if(a)for(c in b)if(a[b[c][0]]&&!b[c][1]&&(b[c][1]=a[b[c][0]],d[d.length]=c),a[b[c][0]]="",c=="as"||c=="ap")a[b[c][3]]&&!b[c][4]&&(b[c][4]=a[b[c][3]]),a[b[c][3]]="";return{cookie:a,cmds:d,cmdMap:b}},isAddCommandParams:function(){var a=ws.bootstrap.parseAppQueryCmd();return a.cmds&&
a.cmds.length>0?!0:!1}}}dojo.config.afterOnLoad&&dojo.isBrowser&&window.setTimeout(dojo._loadInit,0)})();
